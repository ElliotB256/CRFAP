(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     63481,       1487]
NotebookOptionsPosition[     61042,       1405]
NotebookOutlinePosition[     61389,       1420]
CellTagsIndexPosition[     61346,       1417]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Omega]rdef", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\[Omega]r", " ", "\[Rule]", " ", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"g", "/", 
         RowBox[{"(", 
          RowBox[{"4", " ", "R"}], ")"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"mF", " ", "hbar", " ", "\[CapitalOmega]"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "M", " ", "g", " ", "R"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         SuperscriptBox["\[Epsilon]", "2"]}], "]"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]zdef", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\[Omega]z", " ", "\[Rule]", " ", 
     RowBox[{"2", " ", "gF", " ", "uB", " ", 
      RowBox[{"Bgrad", " ", "/", "hbar"}], " ", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"mF", " ", "hbar"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"M", " ", "\[CapitalOmega]"}], ")"}]}], "]"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", " ", "-", " ", 
         SuperscriptBox["\[Epsilon]", "2"]}], ")"}], 
       RowBox[{"3", "/", "4"}]]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rdef", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"R", " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Omega]", " ", "hbar"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", "gF", " ", "uB", " ", "Bgrad"}], ")"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]def", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\[Epsilon]", " ", "\[Rule]", " ", 
     RowBox[{"M", " ", 
      RowBox[{"g", " ", "/", " ", 
       RowBox[{"(", 
        RowBox[{"2", " ", "mF", " ", "gF", " ", "uB", " ", "Bgrad"}], 
        ")"}]}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"constants", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"hbar", " ", "\[Rule]", "  ", 
      RowBox[{"1.0546", " ", 
       SuperscriptBox["10", 
        RowBox[{"-", "34"}]]}]}], ",", " ", 
     RowBox[{"uB", " ", "\[Rule]", " ", 
      RowBox[{"9.274", " ", 
       SuperscriptBox["10", 
        RowBox[{"-", "24"}]]}]}], ",", " ", 
     RowBox[{"g", "\[Rule]", " ", "9.81"}], ",", " ", 
     RowBox[{"M", " ", "\[Rule]", " ", 
      RowBox[{"87", " ", "1.661", " ", 
       SuperscriptBox["10", 
        RowBox[{"-", "27"}]]}]}], " ", ",", " ", 
     RowBox[{"gF", "\[Rule]", " ", 
      RowBox[{"1", "/", "2"}]}], ",", " ", 
     RowBox[{"bohrRad", " ", "\[Rule]", " ", 
      RowBox[{"5.30", " ", 
       SuperscriptBox["10", 
        RowBox[{"-", "11"}]]}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"setup", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Bgrad", " ", "\[Rule]", " ", 
      RowBox[{"50", " ", "0.01", " ", "1.17"}]}], ",", " ", 
     RowBox[{"\[Omega]", "\[Rule]", " ", 
      RowBox[{"2", " ", "\[Pi]", " ", "3", " ", 
       SuperscriptBox["10", "6"]}]}], " ", ",", " ", 
     RowBox[{"mF", " ", "\[Rule]", " ", "1"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.704428310926947*^9, 3.7044285552456493`*^9}, {
  3.704428595929717*^9, 3.704428829932975*^9}, {3.7044309566682425`*^9, 
  3.704430963947693*^9}, {3.7044309947677813`*^9, 3.7044311040673923`*^9}, {
  3.7044311430690513`*^9, 3.7044311922071843`*^9}, {3.7044312877864127`*^9, 
  3.7044313076851473`*^9}, {3.710772160229133*^9, 3.7107721684209523`*^9}, {
  3.7107725280289097`*^9, 3.7107725581669235`*^9}, {3.7107728647235756`*^9, 
  3.710772874531556*^9}, {3.716528514331977*^9, 3.7165285249260364`*^9}, {
  3.716528615882131*^9, 3.7165286221617594`*^9}}],

Cell["\<\
Get RF dressing amplitude from measured trap frequencies. (in kHz)\
\>", "Text",
 CellChangeTimes->{{3.704428310926947*^9, 3.7044285552456493`*^9}, {
  3.704428595929717*^9, 3.704428862941874*^9}, {3.7044293662092896`*^9, 
  3.7044293717099266`*^9}, {3.7044326709106426`*^9, 3.704432673998952*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Does", " ", "not", " ", "yet", " ", "agree", " ", "with", " ", "matlab", 
    " ", "calcs"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"f", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[CapitalOmega]", " ", "/.", 
         RowBox[{"NSolve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"\[Omega]r", " ", "/.", "\[Omega]rdef"}], " ", "/.", 
                 " ", "\[Epsilon]def"}], " ", "/.", " ", "Rdef"}], " ", "/.", 
               " ", "constants"}], " ", "/.", " ", "setup"}], ")"}], " ", 
            "\[Equal]", 
            RowBox[{"2", " ", "\[Pi]", " ", "13"}]}], ",", " ", 
           "\[CapitalOmega]"}], "]"}]}], ")"}], "/", "2"}], "/", "\[Pi]"}], 
     "/", 
     SuperscriptBox["10", "3"]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Agrees", " ", "with", " ", "Matlab", " ", "calcs"}], " ", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{"f", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[CapitalOmega]", " ", "/.", 
         RowBox[{"NSolve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"\[Omega]z", " ", "/.", "\[Omega]zdef"}], " ", "/.", 
                 " ", "\[Epsilon]def"}], " ", "/.", "Rdef"}], "/.", " ", 
               "constants"}], " ", "/.", "setup"}], ")"}], " ", "\[Equal]", 
            RowBox[{"2", " ", "\[Pi]", " ", "560"}]}], ",", " ", 
           "\[CapitalOmega]"}], "]"}]}], ")"}], "/", "2"}], "/", "\[Pi]"}], 
     "/", 
     SuperscriptBox["10", "3"]}]}]}]}]], "Input",
 CellChangeTimes->{{3.704428310926947*^9, 3.7044285552456493`*^9}, {
  3.704428595929717*^9, 3.70442883485927*^9}, {3.7044288704734297`*^9, 
  3.704429005307043*^9}, {3.7044293310316625`*^9, 3.704429340501923*^9}, {
  3.704431111471841*^9, 3.7044311266727405`*^9}, {3.704431207164483*^9, 
  3.7044312383632884`*^9}, {3.7044325744800005`*^9, 3.7044325786224146`*^9}, {
  3.7044326486894207`*^9, 3.7044326643279843`*^9}, {3.7044328262761774`*^9, 
  3.7044328410436544`*^9}, {3.704432876814231*^9, 3.7044328837479243`*^9}, {
  3.7044330531198597`*^9, 3.7044330888074284`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", "51.21286951185702`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.704428699743477*^9, {3.7044287340165887`*^9, 3.704428807321327*^9}, {
   3.704428872821679*^9, 3.7044288767215586`*^9}, {3.7044289177081895`*^9, 
   3.704428958788289*^9}, 3.7044290057718554`*^9, {3.7044291177213883`*^9, 
   3.704429127421183*^9}, 3.704429244070202*^9, 3.7044293420795336`*^9, 
   3.704430838819748*^9, 3.704430901545081*^9, {3.704430960677271*^9, 
   3.704430966371709*^9}, 3.7044311321477766`*^9, {3.7044311972696176`*^9, 
   3.704431246426942*^9}, 3.7044313103255644`*^9, 3.7044325863181844`*^9, {
   3.704432664702022*^9, 3.704432678532405*^9}, 3.704432884776027*^9, {
   3.704433054370985*^9, 3.704433089007448*^9}, 3.704435219199423*^9, 
   3.704435552666766*^9, {3.7107725323043375`*^9, 3.7107725601641226`*^9}, {
   3.71077286756586*^9, 3.7107728771828213`*^9}, 3.711379441289385*^9, 
   3.716552737650303*^9, 3.716553909851156*^9}],

Cell[BoxData[
 RowBox[{"{", "22.329774125412744`", "}"}]], "Output",
 CellChangeTimes->{
  3.704428699743477*^9, {3.7044287340165887`*^9, 3.704428807321327*^9}, {
   3.704428872821679*^9, 3.7044288767215586`*^9}, {3.7044289177081895`*^9, 
   3.704428958788289*^9}, 3.7044290057718554`*^9, {3.7044291177213883`*^9, 
   3.704429127421183*^9}, 3.704429244070202*^9, 3.7044293420795336`*^9, 
   3.704430838819748*^9, 3.704430901545081*^9, {3.704430960677271*^9, 
   3.704430966371709*^9}, 3.7044311321477766`*^9, {3.7044311972696176`*^9, 
   3.704431246426942*^9}, 3.7044313103255644`*^9, 3.7044325863181844`*^9, {
   3.704432664702022*^9, 3.704432678532405*^9}, 3.704432884776027*^9, {
   3.704433054370985*^9, 3.704433089007448*^9}, 3.704435219199423*^9, 
   3.704435552666766*^9, {3.7107725323043375`*^9, 3.7107725601641226`*^9}, {
   3.71077286756586*^9, 3.7107728771828213`*^9}, 3.711379441289385*^9, 
   3.716552737650303*^9, 3.7165539098641577`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"175", "*", "0.9", "*", "2"}]], "Input",
 CellChangeTimes->{{3.7044326247350254`*^9, 3.7044326264231944`*^9}, {
  3.704435224940997*^9, 3.7044352424777503`*^9}}],

Cell[BoxData["315.`"], "Output",
 CellChangeTimes->{
  3.7044326270522575`*^9, {3.7044352273762403`*^9, 3.704435248557358*^9}, 
   3.704435554455945*^9, {3.71077253233134*^9, 3.710772560206127*^9}, {
   3.710772867579861*^9, 3.710772877209824*^9}, 3.7113794413206377`*^9}]
}, Open  ]],

Cell["What is the radial trap frequency for this value of \[CapitalOmega]?", \
"Text",
 CellChangeTimes->{{3.7044344415666676`*^9, 3.7044344885673666`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"f", "=."}], "\[IndentingNewLine]", 
 RowBox[{"OmegaZ", " ", "=", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Omega]z", "/.", "\[Omega]zdef"}], " ", "/.", " ", 
        RowBox[{"\[CapitalOmega]", " ", "\[Rule]", " ", 
         RowBox[{"2", " ", "\[Pi]", " ", "f", " ", 
          SuperscriptBox["10", "3"]}]}]}], " ", "/.", " ", "Rdef"}], " ", "/.",
       " ", "\[Epsilon]def"}], " ", "/.", " ", "constants"}], " ", "/.", " ", 
    "setup"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"OmegaZ", "/", " ", 
    RowBox[{"(", 
     RowBox[{"2", " ", "\[Pi]"}], ")"}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"f", ",", " ", "150", ",", " ", "500"}], "}"}], ",", " ", 
   RowBox[{
   "PlotLabel", "\[Rule]", " ", 
    "\"\<Axial trap frequency vs. Rabi frequency\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"fr", " ", "=", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Omega]r", "/", " ", 
          RowBox[{"(", 
           RowBox[{"2", " ", "\[Pi]"}], ")"}]}], "/.", "\[Omega]rdef"}], " ", 
        "/.", " ", 
        RowBox[{"\[CapitalOmega]", " ", "\[Rule]", " ", 
         RowBox[{"2", " ", "\[Pi]", " ", "f", " ", 
          SuperscriptBox["10", "3"]}]}]}], " ", "/.", " ", "Rdef"}], " ", "/.",
       " ", "\[Epsilon]def"}], " ", "/.", " ", "constants"}], " ", "/.", " ", 
    "setup"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.704434493573867*^9, 3.7044345368821974`*^9}, {
  3.7044345709406033`*^9, 3.7044346207475834`*^9}, {3.70443530938244*^9, 
  3.7044353183873405`*^9}, {3.7044355725627556`*^9, 3.7044356752750254`*^9}, {
  3.7107721864277525`*^9, 3.7107721990630164`*^9}, {3.7107727584319477`*^9, 
  3.7107727589830027`*^9}, {3.7107729083019333`*^9, 3.7107729409511976`*^9}, {
  3.7107731975868587`*^9, 3.7107731988829885`*^9}}],

Cell[BoxData[
 RowBox[{"16626.85312355012`", " ", 
  SqrtBox[
   FractionBox["1", "f"]]}]], "Output",
 CellChangeTimes->{
  3.7044345377062798`*^9, {3.7044345854440536`*^9, 3.7044346220787163`*^9}, 
   3.70443521367087*^9, 3.7044352531238146`*^9, {3.704435312217724*^9, 
   3.7044353188433857`*^9}, 3.7044355564011393`*^9, {3.7044356210085993`*^9, 
   3.704435629965495*^9}, {3.7044356660150995`*^9, 3.7044356760451026`*^9}, {
   3.7107721791500254`*^9, 3.71077220020013*^9}, {3.710772532377344*^9, 
   3.7107725602611322`*^9}, 3.7107727596670713`*^9, {3.710772867637867*^9, 
   3.710772877247828*^9}, {3.710772926821785*^9, 3.7107729529043927`*^9}, 
   3.710773201920292*^9, 3.7113794413362637`*^9, 3.716552738900428*^9, 
   3.7165539141845894`*^9}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
    1.], LineBox[CompressedData["
1:eJwVjHsw1AkAx5FISactkUOJSqntlOby2i91XBml8shNv7X2wVqvXY9F2F8n
bU0YV+N1Hsmj89Yl1O1RqW2jIXJKopU88ryQXGHPuT++85nPzGe+W5khpzgq
SkpKLsv7n23P5rWUHjLx9sFdlY0qAXDVmgwIecxEslG5as4SD+0n+5rkMiay
LL1qtil46Hj9OL6hlYlc7RJ9yy88vBpOmjvXw8Q6YZAy428e5CpG8s9zTDQ3
GA+9fMPDhNXhyvE9LJg3lHyi1fCgUZ7o3JXNwoC4emGRy4PYrCnE/AobxXFk
7mKrP9IjLT3ruBzof06MjXH0Rxi1+N57B1/MLFZ38pq5SL0oVU6m+kE/TSC4
cZQLp/L1WoGaXIzxrb+hdPvBLkRTpXmBC//ruzzuc/ygkrua3zTsj+unBPE3
531xJutQ/mIjD3XtpS2N2cu/lhskVbcC8FfmVbX+Q74wzDdKT0sOhKMjqdr9
ngNdIXXC0C8IFEubxmNXOXAfHTPbfjoYLq4qb2ptODAx79rFpIbATiviW4tp
NrLFdzW01vHhvkrS8qyAjTUVK61tEvhgpQYZU7zYOHJoojVhmo/LARdmV21i
Iy+txE2TK8D+mDlT8w4WHnspbKpeCWAWLlR3T2VBY3KHXsrxUMQrqZe1nWbB
stbNwl4aiqGBQlqnDgu7h/Qq11qEoUhhMjbRx4TDYI2+XmkYEsZe1PJ/Y8LY
eWTcTjccSQkFwamhTIwOG3y1vBgOX3rC2jP2THScNJsPWAhHp1O5Q8FaJhJM
Ws/W+0fgiE6u9pDcB2dkjnec+yPw5McSx+eVPqDkPnKs8BAiij3uZEj6IKPn
lfUOqRBjVJ2gbjcf2I4+NOm3ikTP9gYDj50+qKAfDqktjcRgw74LX5YYUNZo
mvtJJwr5C0c0hd0MRMUbh9KSonD+u549bb8zcI+18YTdfBRybJmbhxMZ2LxB
bhQriMboYXdihs3AD+a0U53votF7vsf0kj0DntEFjQqXcxjaozRYYsRAYlqP
ia/0HNiunuq3/vHGZb3K0RGLGOT7KOnH1HmjONCtoKwsBi6lC4nJAm9UzCoy
bLfEYkmnqDCF6o2YQdrHseRYVGu0HxN8oiOg0NOqSzUOs5yn5tI7dJg+U//w
NiwOvxRrTldF0/HEVNJe+y4O/dKVwV/t6bjk6lDV4iGCdYpmc68aHesHmJMK
qQgGumrGI+0EpnxSPo/KRCh2q2j62kbg+bs/FS+bROih3by4ZtmvyDdoVbWI
INv/swO1lcCKN7K99E4RJAfPP41sJjDbvot/f0CEn49fW9B8RODl/ZkZkQqJ
ieDxT053CNTYGi3wVElM2x6kn60mcK3eeYWnGompOo6cf5vAcUkRhbqaxEZd
zpasWwRktR4H+rRJ9L4Wl02WE6irkETQtpJgNTM7M4sIpO7+ELd7GwkvZVZ2
VSGB0DKKeJMpCS2FdpS0gMDeksD0jztJZPQFh07dIFBcaHg3bx+Jitcy3tFc
AmJj5weJFiQot/vk3jkE2PmRTyMPkPgjL4krzCawJa+968T3JLKFafWFvxL4
10DRZ2213NePiSWZBHpzzEZ22JCgdch8X2QQkOh7TFHsSIj9t58dSSeQmRX/
ZYlGQm2/mt9SGoH/APfVQW4=
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{150., 115.},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None},
  PlotLabel->FormBox[
   "\"Axial trap frequency vs. Rabi frequency\"", TraditionalForm],
  PlotRange->{{150, 500}, {118.34371352773096`, 216.06506477249687`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.7044345377062798`*^9, {3.7044345854440536`*^9, 3.7044346220787163`*^9}, 
   3.70443521367087*^9, 3.7044352531238146`*^9, {3.704435312217724*^9, 
   3.7044353188433857`*^9}, 3.7044355564011393`*^9, {3.7044356210085993`*^9, 
   3.704435629965495*^9}, {3.7044356660150995`*^9, 3.7044356760451026`*^9}, {
   3.7107721791500254`*^9, 3.71077220020013*^9}, {3.710772532377344*^9, 
   3.7107725602611322`*^9}, 3.7107727596670713`*^9, {3.710772867637867*^9, 
   3.710772877247828*^9}, {3.710772926821785*^9, 3.7107729529043927`*^9}, 
   3.710773201920292*^9, 3.7113794413362637`*^9, 3.716552738900428*^9, 
   3.7165539142565966`*^9}],

Cell[BoxData[
 RowBox[{"12.792736693193971`", " ", 
  SqrtBox[
   RowBox[{"1", "-", 
    RowBox[{"0.0006378430309577926`", " ", "f"}]}]]}]], "Output",
 CellChangeTimes->{
  3.7044345377062798`*^9, {3.7044345854440536`*^9, 3.7044346220787163`*^9}, 
   3.70443521367087*^9, 3.7044352531238146`*^9, {3.704435312217724*^9, 
   3.7044353188433857`*^9}, 3.7044355564011393`*^9, {3.7044356210085993`*^9, 
   3.704435629965495*^9}, {3.7044356660150995`*^9, 3.7044356760451026`*^9}, {
   3.7107721791500254`*^9, 3.71077220020013*^9}, {3.710772532377344*^9, 
   3.7107725602611322`*^9}, 3.7107727596670713`*^9, {3.710772867637867*^9, 
   3.710772877247828*^9}, {3.710772926821785*^9, 3.7107729529043927`*^9}, 
   3.710773201920292*^9, 3.7113794413362637`*^9, 3.716552738900428*^9, 
   3.716553914258597*^9}]
}, Open  ]],

Cell["What is the variation in gravitational sag?", "Text",
 CellChangeTimes->{{3.7107722116292725`*^9, 3.710772224272537*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", "/", 
       SuperscriptBox["OmegaZ", "2"]}], "/.", " ", "constants"}], " ", ")"}], 
    " ", "/", 
    RowBox[{"(", 
     RowBox[{"6.45", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}], ")"}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"f", ",", " ", "200", ",", " ", "500"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.71077222720483*^9, 3.710772333477456*^9}, {
  3.7107723780949173`*^9, 3.7107724089840064`*^9}, {3.7107728157456784`*^9, 
  3.7107728345945635`*^9}, {3.710772962616364*^9, 3.7107729945775595`*^9}, {
  3.7107730492590275`*^9, 3.7107730637644777`*^9}, {3.7107756326773434`*^9, 
  3.710775633004376*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
     1.], LineBox[CompressedData["
1:eJwVy3k41HkAx/GZ+bHrUYQtbNKyeGhdk3Xk/H6yVpLEJhXPqofEFI0mjXHN
r03pdIRWtUVtjtjsk1UqPGE3WmerhELKyDWtmZhxN7b94/28/3oZhnJ/CGcx
GIytn/r/C9NdyxkMDq4vBIYUvZaQHrFT8wcWB38V+ThFDEpI5Zu8UyJlDkb8
3bXNhiWE17yf9WQZB1a3LNtL/pWQ8WvTM2k6HNQGKLmVLX7yHtoiPWsOJF09
6kFqUlKZteOhQwgHmuzUib3mUhJj1RnOreHAb/BN2aEIKfHR7N/74PQB3Ofc
TSoYkxLuyc+q4jYdhHuIxN8x7AMZGs2ziWdFocc//peDrz6Quhn3rQFtUdgd
aWj3IHiSiHI/byw8G415MftFWOckiRZ1v/ln5yGkZIU0rNs5RTav1dFzM+RC
d0PvurTuKRI1zq8w7Oei07s2Z9s2GZlnf+BzA2LAPVa/zaJDRkLtHL47UxED
WyNzzUhvOTlSbvvVY43DUGoQeW6slxMHakOr+Ohh1JyparV1nyb517bc8u08
jJzq2V2nqqZJtVr4jjwnHgI1dtjJXGYILbfTWpHPg/E+RqqiZoaMmOgoqhZ5
0DX5oj/CdpZQFoqq7aFHIFXxOCG+N0v+TJAXmdYfgXh33/p2qzlilz8ZNmoa
i6dtWdYt5XPE37mY3Xw+FnW4dCPcZp5oGERZjIzH4rmB8uo9pfMk5ZX9nNTv
KNqMMgd5Fgvkcr+m3O7OUYxmHy9/V7hAdu0qYFxV40ObeiyTr1kkLbdc+id4
fJhdNDptkLdI3m58N5rUwUdwzrhhqfZH8tud7IYZhzjwK58u8738kazNnSvP
vhqHX7upAxlfKohtI7ftwHwcJsLz260vKIiiWfzQaq8Ahjq7U8a1lkiUruCF
Za0ACXYJbkrnl0hKfzXDd008YtbJK39kMrBVoPwx6Kd4XNxcw2/cyEB18B6z
mwPx8DG4//B1MgN9K2uNe75PQJxKvbFSLQM3tK39vAoTYFus0Hq5wMCKzMBz
L1mJEDSEVSc5MMEeSMndGZkIS3n3OUsBE3J+/TONJ4mI66UH0u4yET2kNFBp
mQT2c/vgBTkT6U1L88lZSeB5r7rgYM/C9hlVz2PSJGwSmHob8VhomdcL5QYm
I+2+l/maChZGPF3LLt9LRkTZtYzHEhZuq2qrvNMSovHr1b87m1MwLpB9qy8Q
4lJJoaz2IAWkitIzu4RQDO97NFVMwdE73ce+Rwi2SD+DUULBRt1Rte+lEKED
XXvUSj/5n9NPmvYL8aTbi2l6m4JKkWPSI5EQaX9beATdodDRkMF5LxVCv1TW
VPeAQqiyi4fXMhqu0SdepDVRCG4aZk4sp8HluBZdaaYQkHahNludxvXwaX5x
CwXPVSNOA5o0lEMidevbKHxjkrWer0uj1dcnWNZBYdJjdG2BCY1g9sq3Qa8o
iFWy+zab0jhv0VYe0UthqNX1isSMRp1Z6vHYPgpdAdmrnC1oGBnOGqW/plC1
z235MxsaYs2+/fWDFCrMxpribGnoq190aBdRuP0++5S+PQ0/VV+V3iEKebFj
LI4jjT9YdSWyYQq5G3Lq1J1pDCkECcxRCpmLbsK7LjR0FtZvUR+jcLZuzDnI
jcaWmXE9vXEKKSdy5pYIjcSpm+9NxRT+A1FkQZI=
      "]]}}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{200., 0.9959289400647897},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{200, 500}, {0.9959289400647897, 2.4898222434553055`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.7107730641405153`*^9, 3.710773204778578*^9, 
  3.710775634177493*^9, 3.71137944161386*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Chemical Potential", "Section",
 CellChangeTimes->{{3.71652771655474*^9, 3.716527719624771*^9}, {
  3.716549532368402*^9, 3.716549533870418*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"setup", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Bgrad", " ", "\[Rule]", " ", 
      RowBox[{"82.50", " ", "0.01"}]}], ",", " ", 
     RowBox[{"\[Omega]", "\[Rule]", " ", 
      RowBox[{"2", " ", "\[Pi]", " ", "3", " ", 
       SuperscriptBox["10", "6"]}]}], " ", ",", " ", 
     RowBox[{"mF", " ", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"\[CapitalOmega]", "\[Rule]", " ", 
      RowBox[{"2", "\[Pi]", " ", "187", " ", 
       SuperscriptBox["10", "3"]}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]Gdef", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Omega]G", "\[Rule]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"\[Omega]r", " ", "\[Omega]r", " ", "\[Omega]z"}], ")"}], 
       RowBox[{"1", "/", "3"}]]}], " ", "//.", " ", 
     RowBox[{"Join", "[", 
      RowBox[{
      "\[Omega]rdef", ",", " ", "\[Omega]zdef", ",", " ", "constants", ",", 
       " ", "setup", ",", "Rdef", ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", "\[Rule]", " ", "0"}], "}"}]}], "]"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<Geometric mean trap frequency, f_g = \>\"", ",", " ", 
    RowBox[{"\[Omega]G", " ", "/", " ", 
     RowBox[{"(", 
      RowBox[{"2", "\[Pi]"}], ")"}]}], ",", " ", "\"\< Hz.\>\""}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Mu]def", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"\[Mu]", " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{
        SuperscriptBox["15", 
         RowBox[{"2", "/", "5"}]], "/", "2"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"N", " ", 
          RowBox[{"scatta", "/", "osca"}]}], ")"}], 
        RowBox[{"2", "/", "5"}]], " ", "hbar", " ", "\[Omega]G"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Scattering", " ", "length", " ", "a"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aDef", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"osca", " ", "\[Rule]", "  ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"hbar", " ", "/", " ", 
          RowBox[{"(", 
           RowBox[{"M", " ", "\[Omega]G"}], ")"}]}], ")"}], 
        RowBox[{"1", "/", "2"}]]}], ",", " ", 
      RowBox[{"scatta", " ", "\[Rule]", " ", 
       RowBox[{"100", " ", "bohrRad"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Chemical", " ", "Potential"}], " ", "-", " ", 
    RowBox[{"in", " ", "Hz"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chemPot", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", "\[Mu]", " ", ")"}], "//.", " ", 
    RowBox[{"Join", "[", 
     RowBox[{
     "\[Omega]Gdef", ",", " ", "\[Mu]def", ",", " ", "setup", ",", " ", 
      "constants", ",", " ", "aDef", ",", " ", 
      RowBox[{"{", 
       RowBox[{"N", " ", "\[Rule]", " ", 
        RowBox[{"4", " ", 
         SuperscriptBox["10", "5"]}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chemPot", " ", "/", " ", 
   RowBox[{"(", 
    RowBox[{"2", " ", "\[Pi]", " ", "hbar"}], ")"}]}], " ", "/.", " ", 
  "constants"}]}], "Input",
 CellChangeTimes->{{3.7165280332558746`*^9, 3.716528084129961*^9}, {
  3.7165281374042883`*^9, 3.7165284956041045`*^9}, {3.716528629401483*^9, 
  3.7165286406346064`*^9}, {3.7165288654640865`*^9, 3.7165290287644153`*^9}, {
  3.7165290820947475`*^9, 3.7165291159511333`*^9}, {3.7165291730508423`*^9, 
  3.7165292018837256`*^9}}],

Cell[BoxData[
 TemplateBox[{
  "\"Geometric mean trap frequency, f_g = \"",FractionBox["\[Omega]G", 
    RowBox[{"2", " ", "\[Pi]"}]],"\" Hz.\""},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.716528218872434*^9, 3.7165282694104877`*^9}, {
   3.7165283184563913`*^9, 3.716528327628309*^9}, {3.716528468326377*^9, 
   3.716528478983443*^9}, 3.716528945172057*^9, {3.7165289753820777`*^9, 
   3.716528985876127*^9}, {3.7165290879913373`*^9, 3.7165291165141897`*^9}, {
   3.71652918502704*^9, 3.716529202238761*^9}, 3.7165518852978315`*^9, 
   3.7165527412186594`*^9, 3.716553917277899*^9, 3.7165603988225155`*^9}],

Cell[BoxData["977.2187824765653`"], "Output",
 CellChangeTimes->{{3.716528218872434*^9, 3.7165282694104877`*^9}, {
   3.7165283184563913`*^9, 3.716528327628309*^9}, {3.716528468326377*^9, 
   3.716528478983443*^9}, 3.716528945172057*^9, {3.7165289753820777`*^9, 
   3.716528985876127*^9}, {3.7165290879913373`*^9, 3.7165291165141897`*^9}, {
   3.71652918502704*^9, 3.716529202238761*^9}, 3.7165518852978315`*^9, 
   3.7165527412186594`*^9, 3.716553917277899*^9, 3.7165603988255157`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Questions of lineshape", "Section",
 CellChangeTimes->{{3.716549537983492*^9, 3.7165495422285366`*^9}}],

Cell[TextData[{
 "Define two functions: U(z), the potential energy as a function of z, and \
S(z), the separation between ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["m", "F"], "~"], "=", "1"}], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["m", "F"], "~"], "=", "0"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ". The coordinate `z` here is taken such that z=0 corresponds to the \
resonance. Both are defined in terms of energy, ",
 StyleBox["so remember hbar when converting them to frequencies.",
  FontSlant->"Italic"],
 " "
}], "Text",
 CellChangeTimes->{{3.7165495974082646`*^9, 3.716549665146064*^9}, {
  3.7165496977844553`*^9, 3.7165497079736047`*^9}, {3.7165498200460153`*^9, 
  3.7165498317491603`*^9}, {3.7165533870622373`*^9, 3.7165534080633373`*^9}, {
  3.716553494851015*^9, 3.7165535313326626`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", "z_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"hbar", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[CapitalOmega]", "2"], "+", 
         SuperscriptBox["\[Delta]", "2"]}], ")"}], 
       RowBox[{"1", "/", "2"}]]}], ")"}], "/.", " ", 
    RowBox[{"{", 
     RowBox[{"\[Delta]", " ", "\[Rule]", " ", 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", " ", "Bgrad", " ", "z"}], ")"}], "/", " ", 
        RowBox[{"(", "hbar", ")"}]}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"U", "[", "z_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"S", "[", "z", "]"}], " ", "+", 
    RowBox[{"M", " ", "g", " ", "z"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"minZDef", " ", "=", " ", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"U", "[", "z", "]"}], ",", " ", "z"}], "]"}], " ", "\[Equal]",
       " ", "0"}], ",", " ", "z"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<Minimum located at: \>\"", ",", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["10", "6"], "z"}], "/.", "minZ"}], ")"}], " ", "//.", 
     " ", 
     RowBox[{"Join", "[", 
      RowBox[{"constants", ",", " ", "setup"}], "]"}]}], ",", " ", 
    "\"\< \[Mu]m.\>\""}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"z", "/.", "minZDef"}], "]"}], "/", 
   RowBox[{"(", 
    RowBox[{"2", " ", "\[Pi]", " ", "hbar"}], ")"}]}], " ", "//.", " ", 
  RowBox[{"Join", "[", 
   RowBox[{"constants", ",", " ", "setup"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"U", "[", 
      RowBox[{"z", " ", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", "\[Pi]", " ", "hbar"}], ")"}]}], " ", "//.", " ", 
    RowBox[{"Join", "[", 
     RowBox[{"constants", ",", " ", "setup"}], "]"}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"z", ",", " ", 
     RowBox[{"-", "20"}], ",", " ", "10"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]z", "/", " ", 
   RowBox[{"(", 
    RowBox[{"2", "\[Pi]"}], ")"}]}], " ", "//.", 
  RowBox[{"Join", "[", 
   RowBox[{
   "\[Omega]zdef", ",", " ", "constants", ",", " ", "setup", ",", " ", "Rdef",
     ",", " ", 
    RowBox[{"{", 
     RowBox[{"\[Epsilon]", "\[Rule]", " ", "0"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.716549709443622*^9, 3.7165498061868424`*^9}, {
   3.7165498385182443`*^9, 3.716549894898936*^9}, {3.71655052417894*^9, 
   3.716550536472087*^9}, {3.7165510495360937`*^9, 3.7165510595102067`*^9}, {
   3.7165512006311045`*^9, 3.716551201490115*^9}, {3.716551236497517*^9, 
   3.7165512743329425`*^9}, {3.7165513466267943`*^9, 3.716551347968808*^9}, {
   3.716551446843335*^9, 3.7165514834247856`*^9}, {3.716551535504431*^9, 
   3.7165515397084794`*^9}, 3.7165519911871176`*^9, {3.7165532028958225`*^9, 
   3.716553238753408*^9}, 3.71655374036821*^9, {3.7165578832805257`*^9, 
   3.716557918470044*^9}, {3.716558053928589*^9, 3.7165581125464497`*^9}, {
   3.7165582359567895`*^9, 3.7165582467168655`*^9}, {3.716558633259516*^9, 
   3.7165587773419228`*^9}, {3.716558976955882*^9, 3.716558983008487*^9}, {
   3.7165590212973156`*^9, 3.716559074636649*^9}, {3.71655911725191*^9, 
   3.7165592365338373`*^9}, {3.716559397682498*^9, 3.7165594262393293`*^9}, {
   3.716559475448763*^9, 3.7165595352365007`*^9}, {3.71656041986162*^9, 
   3.716560433211954*^9}, {3.716560464221055*^9, 3.71656050377601*^9}, {
   3.7165605457522073`*^9, 3.716560545927225*^9}, {3.716560676000231*^9, 
   3.7165608356551948`*^9}, {3.716561927093663*^9, 3.7165620636992846`*^9}, {
   3.716562135844451*^9, 3.7165621419486213`*^9}, {3.716562226351249*^9, 
   3.716562261559307*^9}, {3.716645351726153*^9, 3.7166453938811216`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"z", "\[Rule]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
     "\[ImaginaryI]", " ", "g", " ", "hbar", " ", "M", " ", 
      "\[CapitalOmega]"}], 
     RowBox[{"Bgrad", " ", "gF", " ", "uB", " ", 
      SqrtBox[
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["g", "2"], " ", 
         SuperscriptBox["M", "2"]}], "-", 
        RowBox[{"16", " ", 
         SuperscriptBox["Bgrad", "2"], " ", 
         SuperscriptBox["gF", "2"], " ", 
         SuperscriptBox["uB", "2"]}]}]]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7165587421144004`*^9, 3.7165587779399824`*^9}, {
   3.716558977792966*^9, 3.7165589836255493`*^9}, {3.716559059284114*^9, 
   3.7165590751447*^9}, {3.716559123214506*^9, 3.7165591281349983`*^9}, {
   3.716559163211506*^9, 3.716559236833867*^9}, {3.7165593730487823`*^9, 
   3.7165594267673383`*^9}, {3.7165594761967864`*^9, 3.7165595359455204`*^9}, 
   3.7165604212327566`*^9, 3.7165604530049334`*^9, {3.7165604890995426`*^9, 
   3.7165605043410664`*^9}, 3.7165605464392757`*^9, 3.716560636759307*^9, 
   3.716560767590389*^9, {3.716560803473977*^9, 3.7165608367513046`*^9}, 
   3.716561064521753*^9, {3.7165619277916827`*^9, 3.716561990161004*^9}, {
   3.7165620401815786`*^9, 3.7165620641513033`*^9}, {3.71656212681818*^9, 
   3.716562143111664*^9}, {3.7165622265822587`*^9, 3.7165622758557434`*^9}, {
   3.716645367576503*^9, 3.716645394476132*^9}}],

Cell[BoxData[
 TemplateBox[{"\"Minimum located at: \"",RowBox[{
     RowBox[{"-", "3.0535897037392625`"}], "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}],"\" \[Mu]m.\""},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.7165587421144004`*^9, 3.7165587779399824`*^9}, {
   3.716558977792966*^9, 3.7165589836255493`*^9}, {3.716559059284114*^9, 
   3.7165590751447*^9}, {3.716559123214506*^9, 3.7165591281349983`*^9}, {
   3.716559163211506*^9, 3.716559236833867*^9}, {3.7165593730487823`*^9, 
   3.7165594267673383`*^9}, {3.7165594761967864`*^9, 3.7165595359455204`*^9}, 
   3.7165604212327566`*^9, 3.7165604530049334`*^9, {3.7165604890995426`*^9, 
   3.7165605043410664`*^9}, 3.7165605464392757`*^9, 3.716560636759307*^9, 
   3.716560767590389*^9, {3.716560803473977*^9, 3.7165608367513046`*^9}, 
   3.716561064521753*^9, {3.7165619277916827`*^9, 3.716561990161004*^9}, {
   3.7165620401815786`*^9, 3.7165620641513033`*^9}, {3.71656212681818*^9, 
   3.716562143111664*^9}, {3.7165622265822587`*^9, 3.7165622758557434`*^9}, {
   3.716645367576503*^9, 3.716645394476132*^9}}],

Cell[BoxData["190294.93761748564`"], "Output",
 CellChangeTimes->{{3.7165587421144004`*^9, 3.7165587779399824`*^9}, {
   3.716558977792966*^9, 3.7165589836255493`*^9}, {3.716559059284114*^9, 
   3.7165590751447*^9}, {3.716559123214506*^9, 3.7165591281349983`*^9}, {
   3.716559163211506*^9, 3.716559236833867*^9}, {3.7165593730487823`*^9, 
   3.7165594267673383`*^9}, {3.7165594761967864`*^9, 3.7165595359455204`*^9}, 
   3.7165604212327566`*^9, 3.7165604530049334`*^9, {3.7165604890995426`*^9, 
   3.7165605043410664`*^9}, 3.7165605464392757`*^9, 3.716560636759307*^9, 
   3.716560767590389*^9, {3.716560803473977*^9, 3.7165608367513046`*^9}, 
   3.716561064521753*^9, {3.7165619277916827`*^9, 3.716561990161004*^9}, {
   3.7165620401815786`*^9, 3.7165620641513033`*^9}, {3.71656212681818*^9, 
   3.716562143111664*^9}, {3.7165622265822587`*^9, 3.7165622758557434`*^9}, {
   3.716645367576503*^9, 3.7166453944861317`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
    1.], LineBox[CompressedData["
1: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
d+I=
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 180000.},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None},
  PlotRange->{{-20, 10}, {183762.1174282317, 254362.65497126328`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.7165587421144004`*^9, 3.7165587779399824`*^9}, {
   3.716558977792966*^9, 3.7165589836255493`*^9}, {3.716559059284114*^9, 
   3.7165590751447*^9}, {3.716559123214506*^9, 3.7165591281349983`*^9}, {
   3.716559163211506*^9, 3.716559236833867*^9}, {3.7165593730487823`*^9, 
   3.7165594267673383`*^9}, {3.7165594761967864`*^9, 3.7165595359455204`*^9}, 
   3.7165604212327566`*^9, 3.7165604530049334`*^9, {3.7165604890995426`*^9, 
   3.7165605043410664`*^9}, 3.7165605464392757`*^9, 3.716560636759307*^9, 
   3.716560767590389*^9, {3.716560803473977*^9, 3.7165608367513046`*^9}, 
   3.716561064521753*^9, {3.7165619277916827`*^9, 3.716561990161004*^9}, {
   3.7165620401815786`*^9, 3.7165620641513033`*^9}, {3.71656212681818*^9, 
   3.716562143111664*^9}, {3.7165622265822587`*^9, 3.7165622758557434`*^9}, {
   3.716645367576503*^9, 3.716645394518132*^9}}],

Cell[BoxData["287.76774147066345`"], "Output",
 CellChangeTimes->{{3.7165587421144004`*^9, 3.7165587779399824`*^9}, {
   3.716558977792966*^9, 3.7165589836255493`*^9}, {3.716559059284114*^9, 
   3.7165590751447*^9}, {3.716559123214506*^9, 3.7165591281349983`*^9}, {
   3.716559163211506*^9, 3.716559236833867*^9}, {3.7165593730487823`*^9, 
   3.7165594267673383`*^9}, {3.7165594761967864`*^9, 3.7165595359455204`*^9}, 
   3.7165604212327566`*^9, 3.7165604530049334`*^9, {3.7165604890995426`*^9, 
   3.7165605043410664`*^9}, 3.7165605464392757`*^9, 3.716560636759307*^9, 
   3.716560767590389*^9, {3.716560803473977*^9, 3.7165608367513046`*^9}, 
   3.716561064521753*^9, {3.7165619277916827`*^9, 3.716561990161004*^9}, {
   3.7165620401815786`*^9, 3.7165620641513033`*^9}, {3.71656212681818*^9, 
   3.716562143111664*^9}, {3.7165622265822587`*^9, 3.7165622758557434`*^9}, {
   3.716645367576503*^9, 3.7166453945281324`*^9}}]
}, Open  ]],

Cell[TextData[{
 "Expand the potential function as a power series and solve to determine the \
two values of z for which N\[CloseCurlyQuote] = N/2, ie the FWHM of the rf \
resonance. These different Ns can be related through their chemical \
potentials, \[Mu] = ",
 Cell[BoxData[
  RowBox[{"\[Mu]0", " ", 
   SuperscriptBox["0.5", 
    RowBox[{"2", "/", "5"}]]}]]],
 "."
}], "Text",
 CellChangeTimes->{{3.71654990342404*^9, 3.7165499124911566`*^9}, {
  3.716549953522667*^9, 3.7165499543926797`*^9}, {3.7165501790352907`*^9, 
  3.7165501887394104`*^9}, {3.7165504392374783`*^9, 3.7165504718028755`*^9}, {
  3.7165507442330356`*^9, 3.716550758733214*^9}, {3.7165508134028873`*^9, 
  3.716550824526018*^9}, {3.7165515774309425`*^9, 3.7165515779509478`*^9}, {
  3.7165567545956683`*^9, 3.716556756418851*^9}, {3.7165571786030645`*^9, 
  3.7165571816183662`*^9}, {3.7165625204861894`*^9, 3.7165625213452115`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"s", " ", "=", " ", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"U", "[", "z", "]"}], "-", 
       RowBox[{"U", "[", 
        RowBox[{"z", "/.", "minZDef"}], "]"}]}], "\[Equal]", " ", 
      RowBox[{"\[Mu]0", " ", 
       SuperscriptBox[
        RowBox[{"(", "0.5", ")"}], 
        RowBox[{"2", "/", "5"}]]}]}], ",", " ", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zs", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"z", "/.", "s"}], ")"}], " ", "//.", " ", 
    RowBox[{"Join", "[", 
     RowBox[{"constants", ",", " ", "setup", ",", " ", 
      RowBox[{"{", 
       RowBox[{"\[Mu]0", "\[Rule]", " ", 
        RowBox[{
         SuperscriptBox["10", "3"], " ", "2", " ", "\[Pi]", " ", "hbar"}]}], 
       "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<Resonant positions at \>\"", ",", " ", 
    RowBox[{
     SuperscriptBox["10", "6"], " ", 
     RowBox[{"zs", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", "\"\<,\>\"", ",", 
    RowBox[{
     SuperscriptBox["10", "6"], " ", 
     RowBox[{"zs", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", "  ", "\"\< \[Mu]m.\>\""}], 
   "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.716536824947755*^9, 3.716536919141241*^9}, {
   3.7165505000246105`*^9, 3.7165505148518224`*^9}, {3.7165505629484215`*^9, 
   3.716550592361782*^9}, {3.716550676649995*^9, 3.7165507328358564`*^9}, {
   3.716550798992714*^9, 3.716550808900828*^9}, {3.7165508864251146`*^9, 
   3.7165508867061176`*^9}, 3.7165509843813114`*^9, {3.716551501476018*^9, 
   3.7165515272953324`*^9}, {3.71655156969385*^9, 3.7165515884350634`*^9}, {
   3.7165528009496317`*^9, 3.7165528501665535`*^9}, {3.7165529114356794`*^9, 
   3.716552912802816*^9}, 3.716553069112446*^9, {3.7165531279473286`*^9, 
   3.7165531699555287`*^9}, {3.716553875507722*^9, 3.7165538847476463`*^9}, {
   3.716557624172617*^9, 3.716557731261325*^9}, {3.716562280801888*^9, 
   3.7165622901321692`*^9}, {3.716562348926008*^9, 3.7165623864421415`*^9}, {
   3.716562430847503*^9, 3.716562475623843*^9}, {3.7165626916546617`*^9, 
   3.7165626918796697`*^9}, {3.7166426499330254`*^9, 
   3.7166426500710344`*^9}, {3.7166426914728355`*^9, 3.716642691614837*^9}, {
   3.716642723406492*^9, 3.716642755216096*^9}, 3.716642799777131*^9, {
   3.716642849339507*^9, 3.71664284954751*^9}}],

Cell[BoxData[
 TemplateBox[{"\"Resonant positions at \"",RowBox[{
     RowBox[{"-", "4.564494724185725`"}], "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}],"\",\"",RowBox[{
     RowBox[{"-", "1.5678714663744642`"}], "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}],"\" \[Mu]m.\""},
  "RowDefault"]], "Output",
 CellChangeTimes->{
  3.716642620345394*^9, 3.716642651592066*^9, {3.7166427173343735`*^9, 
   3.716642724975521*^9}, {3.7166427615062037`*^9, 3.716642765096303*^9}, {
   3.7166428477894793`*^9, 3.716642851356547*^9}}]
}, Open  ]],

Cell["\<\
Once we have calculated these positions, we can determine the difference in \
splittings between them. Note that the below is simplified because both \
positions corresponding to the new chemical potential \
\[Mu]\[CloseCurlyQuote]s edges are below the z=0 point.\
\>", "Text",
 CellChangeTimes->{{3.716562524533309*^9, 3.7165626645234685`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", "zs", "]"}], " ", "/", 
   RowBox[{"(", 
    RowBox[{"2", " ", "\[Pi]", " ", "hbar"}], ")"}]}], " ", "//.", " ", 
  RowBox[{"Join", "[", 
   RowBox[{"constants", ",", " ", "setup"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"N", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"zs", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", 
      RowBox[{"S", "[", 
       RowBox[{"zs", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "/", 
   RowBox[{"(", 
    RowBox[{"2", " ", "\[Pi]", " ", "hbar"}], ")"}]}], " ", "//.", 
  RowBox[{"Join", "[", 
   RowBox[{"constants", ",", " ", "setup"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.716562704347335*^9, 3.7165627240344276`*^9}, {
  3.716642988165697*^9, 3.7166430521189823`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"194285.21319267523`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"187874.26299734175`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7165515016590195`*^9, 3.71655158889207*^9}, 
   3.7165519940361505`*^9, 3.7165521856158667`*^9, {3.7165526764951878`*^9, 
   3.7165526819757357`*^9}, 3.7165527443319707`*^9, {3.716552794856023*^9, 
   3.7165528507176085`*^9}, 3.7165529386454*^9, 3.716553038736408*^9, 
   3.7165530698145156`*^9, {3.7165531560761414`*^9, 3.7165531706666*^9}, 
   3.716553206398173*^9, 3.7165532407196045`*^9, 3.716553349163448*^9, 
   3.7165537426294355`*^9, 3.716553885277699*^9, 3.716553920743245*^9, 
   3.7165542738686204`*^9, 3.716556420820294*^9, 3.716556643357546*^9, 
   3.7165576269468946`*^9, 3.716557689377137*^9, {3.716557721703369*^9, 
   3.716557731779377*^9}, 3.7165577857037687`*^9, 3.716557914367634*^9, 
   3.7165603539250264`*^9, 3.7165620769146814`*^9, 3.716562292032226*^9, 
   3.716562357243253*^9, 3.7165623922873125`*^9, 3.716562436377674*^9, {
   3.7165627117650695`*^9, 3.71656272460745*^9}, {3.716643018987319*^9, 
   3.7166430527079964`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "6410.950195333492`"}], "+", 
  RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{{3.7165515016590195`*^9, 3.71655158889207*^9}, 
   3.7165519940361505`*^9, 3.7165521856158667`*^9, {3.7165526764951878`*^9, 
   3.7165526819757357`*^9}, 3.7165527443319707`*^9, {3.716552794856023*^9, 
   3.7165528507176085`*^9}, 3.7165529386454*^9, 3.716553038736408*^9, 
   3.7165530698145156`*^9, {3.7165531560761414`*^9, 3.7165531706666*^9}, 
   3.716553206398173*^9, 3.7165532407196045`*^9, 3.716553349163448*^9, 
   3.7165537426294355`*^9, 3.716553885277699*^9, 3.716553920743245*^9, 
   3.7165542738686204`*^9, 3.716556420820294*^9, 3.716556643357546*^9, 
   3.7165576269468946`*^9, 3.716557689377137*^9, {3.716557721703369*^9, 
   3.716557731779377*^9}, 3.7165577857037687`*^9, 3.716557914367634*^9, 
   3.7165603539250264`*^9, 3.7165620769146814`*^9, 3.716562292032226*^9, 
   3.716562357243253*^9, 3.7165623922873125`*^9, 3.716562436377674*^9, {
   3.7165627117650695`*^9, 3.71656272460745*^9}, {3.716643018987319*^9, 
   3.7166430527179966`*^9}}]
}, Open  ]],

Cell["\<\
Now use the solutions in z to determine the FWHM of the rf probe resonance. \
Convert the FWHM points from z coordinates to rf detunings.\
\>", "Text",
 CellChangeTimes->{{3.7165509905223866`*^9, 3.7165510096146145`*^9}, {
  3.716551102647955*^9, 3.716551109366039*^9}, {3.7165529677633114`*^9, 
  3.716552973171852*^9}, {3.716553959205091*^9, 3.7165539803832083`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]RF", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Delta]", " ", "/.", " ", "\[Delta]def"}], ")"}], " ", "/", 
      " ", "z"}], ")"}], " ", "zs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", "\[Delta]RF", ")"}], "//.", " ", 
  RowBox[{"Join", "[", 
   RowBox[{"constants", ",", " ", "setup"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.716551111320059*^9, 3.7165512161362867`*^9}, {
   3.7165512782169857`*^9, 3.7165512919301653`*^9}, {3.7165514912598896`*^9, 
   3.7165514925339074`*^9}, {3.716551612509353*^9, 3.7165516379736643`*^9}, {
   3.716551773801441*^9, 3.716551838819266*^9}, {3.7165519576017013`*^9, 
   3.716551984214019*^9}, {3.7165520231254916`*^9, 3.716552026297529*^9}, {
   3.716552063665968*^9, 3.7165520689690266`*^9}, {3.71655211441757*^9, 
   3.716552127694725*^9}, {3.7165523276146727`*^9, 3.7165523656221066`*^9}, {
   3.7165524216987786`*^9, 3.716552484519554*^9}, {3.7165525433052235`*^9, 
   3.716552573791582*^9}, {3.7165526937049084`*^9, 3.7165527038649244`*^9}, 
   3.7165527517457123`*^9, {3.716552863352872*^9, 3.716552865704107*^9}, {
   3.716552924721008*^9, 3.7165529457331085`*^9}, {3.716552980277563*^9, 
   3.7165529809246273`*^9}, {3.7165530185513897`*^9, 3.716553040823617*^9}, {
   3.716553259682501*^9, 3.7165532696965017`*^9}, {3.716553414559987*^9, 
   3.716553422119743*^9}, {3.7165539574709177`*^9, 3.7165541093731065`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"25661.564980318406`", ",", "4.8549805560945936`*^7"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.716552128036729*^9, 3.716552187507889*^9, {3.7165523287106905`*^9, 
   3.716552366160113*^9}, {3.7165524453550715`*^9, 3.7165524530311747`*^9}, 
   3.71655248508956*^9, {3.716552544679238*^9, 3.716552580673662*^9}, {
   3.7165526901225505`*^9, 3.7165527114656844`*^9}, {3.716552746272165*^9, 
   3.716552752148752*^9}, 3.716552866309167*^9, {3.716553026634198*^9, 
   3.716553042047739*^9}, 3.716553095622096*^9, {3.71655324987352*^9, 
   3.716553284149947*^9}, 3.716553352144746*^9, 3.716553422617792*^9, 
   3.7165537458497577`*^9, {3.716553892501421*^9, 3.7165539232164927`*^9}, {
   3.716554071528322*^9, 3.7165541096721363`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Same approach, but approximating the potential as harmonic", \
"Subsection",
 CellChangeTimes->{{3.716705466832841*^9, 3.716705472655899*^9}, {
  3.7167062179845505`*^9, 3.716706219564566*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Uh", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{"U", "[", "z", "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"z", ",", " ", "0", ",", " ", "2"}], "}"}]}], "]"}], "]"}], 
    ",", " ", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", " ", "\[Element]", " ", "Reals"}], ",", " ", 
       RowBox[{"\[CapitalOmega]", " ", ">", " ", "0."}]}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"minZDef", " ", "=", " ", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"Uh", ",", " ", "z"}], "]"}], " ", "\[Equal]", " ", "0"}], ",",
      " ", "z"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zCut", " ", "=", " ", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Uh", " ", "-", " ", 
       RowBox[{"(", 
        RowBox[{"Uh", " ", "/.", " ", "minZDef"}], ")"}]}], " ", "\[Equal]", 
      " ", "\[Mu]"}], ",", "z"}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Determine", " ", "width", " ", "of", " ", "resonance", " ", "as", " ", 
    "rf", " ", "frequency"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"width", " ", "=", " ", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Differences", "[", 
     RowBox[{"S", "[", 
      RowBox[{"z", "/.", "zCut"}], "]"}], "]"}], "]"}], "/", 
   RowBox[{"(", 
    RowBox[{"2", " ", "\[Pi]", " ", "hbar"}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"width", " ", "//.", " ", 
  RowBox[{"Join", "[", 
   RowBox[{"constants", ",", " ", "setup", ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Mu]", "\[Rule]", " ", 
       RowBox[{"\[Mu]0", " ", 
        SuperscriptBox[
         RowBox[{"(", "0.5", ")"}], 
         RowBox[{"2", "/", "5"}]]}]}], ",", " ", 
      RowBox[{"\[Mu]0", " ", "\[Rule]", " ", 
       RowBox[{
        SuperscriptBox["10", "3"], " ", "2", " ", "\[Pi]", " ", "hbar"}]}]}], 
     "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7167054889270773`*^9, 3.7167055105873094`*^9}, {
  3.7167056447063556`*^9, 3.716705715570114*^9}, {3.7167057965429163`*^9, 
  3.7167058477144585`*^9}, {3.7167059219353323`*^9, 3.716705948428629*^9}, {
  3.7167059831490264`*^9, 3.7167061585948906`*^9}, {3.7167061999463463`*^9, 
  3.71670620368939*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", " ", "M", " ", "z"}], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["Bgrad", "2"], " ", 
    SuperscriptBox["gF", "2"], " ", 
    SuperscriptBox["uB", "2"], " ", 
    SuperscriptBox["z", "2"]}], 
   RowBox[{"hbar", " ", "\[CapitalOmega]"}]], "+", 
  RowBox[{"hbar", " ", "\[CapitalOmega]"}]}]], "Output",
 CellChangeTimes->{{3.716705503416231*^9, 3.7167055122603264`*^9}, 
   3.7167056618255453`*^9, {3.716705700503951*^9, 3.7167057165501237`*^9}, {
   3.7167057988439393`*^9, 3.716705848214463*^9}, 3.71670594958864*^9, {
   3.7167060159383764`*^9, 3.7167060448586817`*^9}, {3.7167060871801295`*^9, 
   3.716706159084896*^9}, 3.7167062041793947`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"z", "\[Rule]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"g", " ", "hbar", " ", "M", " ", "\[CapitalOmega]"}], 
     RowBox[{"4", " ", 
      SuperscriptBox["Bgrad", "2"], " ", 
      SuperscriptBox["gF", "2"], " ", 
      SuperscriptBox["uB", "2"]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.716705503416231*^9, 3.7167055122603264`*^9}, 
   3.7167056618255453`*^9, {3.716705700503951*^9, 3.7167057165501237`*^9}, {
   3.7167057988439393`*^9, 3.716705848214463*^9}, 3.71670594958864*^9, {
   3.7167060159383764`*^9, 3.7167060448586817`*^9}, {3.7167060871801295`*^9, 
   3.716706159084896*^9}, 3.7167062041793947`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"z", "\[Rule]", 
     FractionBox[
      RowBox[{"hbar", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "g"}], " ", "M"}], "-", 
         FractionBox[
          RowBox[{"2", " ", 
           SqrtBox["2"], " ", "Bgrad", " ", "gF", " ", "uB", " ", 
           SqrtBox["\[Mu]"]}], 
          RowBox[{
           SqrtBox["hbar"], " ", 
           SqrtBox["\[CapitalOmega]"]}]]}], ")"}], " ", "\[CapitalOmega]"}], 
      RowBox[{"4", " ", 
       SuperscriptBox["Bgrad", "2"], " ", 
       SuperscriptBox["gF", "2"], " ", 
       SuperscriptBox["uB", "2"]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", "\[Rule]", 
     FractionBox[
      RowBox[{"hbar", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "g"}], " ", "M"}], "+", 
         FractionBox[
          RowBox[{"2", " ", 
           SqrtBox["2"], " ", "Bgrad", " ", "gF", " ", "uB", " ", 
           SqrtBox["\[Mu]"]}], 
          RowBox[{
           SqrtBox["hbar"], " ", 
           SqrtBox["\[CapitalOmega]"]}]]}], ")"}], " ", "\[CapitalOmega]"}], 
      RowBox[{"4", " ", 
       SuperscriptBox["Bgrad", "2"], " ", 
       SuperscriptBox["gF", "2"], " ", 
       SuperscriptBox["uB", "2"]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.716705503416231*^9, 3.7167055122603264`*^9}, 
   3.7167056618255453`*^9, {3.716705700503951*^9, 3.7167057165501237`*^9}, {
   3.7167057988439393`*^9, 3.716705848214463*^9}, 3.71670594958864*^9, {
   3.7167060159383764`*^9, 3.7167060448586817`*^9}, {3.7167060871801295`*^9, 
   3.716706159084896*^9}, 3.7167062041793947`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"4", "+", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "M"}], "-", 
            FractionBox[
             RowBox[{"2", " ", 
              SqrtBox["2"], " ", "Bgrad", " ", "gF", " ", "uB", " ", 
              SqrtBox["\[Mu]"]}], 
             RowBox[{
              SqrtBox["hbar"], " ", 
              SqrtBox["\[CapitalOmega]"]}]]}], ")"}], "2"], 
         RowBox[{
          SuperscriptBox["Bgrad", "2"], " ", 
          SuperscriptBox["gF", "2"], " ", 
          SuperscriptBox["uB", "2"]}]]}], ")"}], " ", 
      SuperscriptBox["\[CapitalOmega]", "2"]}]], "-", 
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"4", "+", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "M"}], "+", 
            FractionBox[
             RowBox[{"2", " ", 
              SqrtBox["2"], " ", "Bgrad", " ", "gF", " ", "uB", " ", 
              SqrtBox["\[Mu]"]}], 
             RowBox[{
              SqrtBox["hbar"], " ", 
              SqrtBox["\[CapitalOmega]"]}]]}], ")"}], "2"], 
         RowBox[{
          SuperscriptBox["Bgrad", "2"], " ", 
          SuperscriptBox["gF", "2"], " ", 
          SuperscriptBox["uB", "2"]}]]}], ")"}], " ", 
      SuperscriptBox["\[CapitalOmega]", "2"]}]]}], 
   RowBox[{"4", " ", "\[Pi]"}]], "}"}]], "Output",
 CellChangeTimes->{{3.716705503416231*^9, 3.7167055122603264`*^9}, 
   3.7167056618255453`*^9, {3.716705700503951*^9, 3.7167057165501237`*^9}, {
   3.7167057988439393`*^9, 3.716705848214463*^9}, 3.71670594958864*^9, {
   3.7167060159383764`*^9, 3.7167060448586817`*^9}, {3.7167060871801295`*^9, 
   3.716706159084896*^9}, 3.7167062041793947`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", "6111.2168415564765`"}], "}"}]], "Output",
 CellChangeTimes->{{3.716705503416231*^9, 3.7167055122603264`*^9}, 
   3.7167056618255453`*^9, {3.716705700503951*^9, 3.7167057165501237`*^9}, {
   3.7167057988439393`*^9, 3.716705848214463*^9}, 3.71670594958864*^9, {
   3.7167060159383764`*^9, 3.7167060448586817`*^9}, {3.7167060871801295`*^9, 
   3.716706159084896*^9}, 3.716706204189395*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1068, 966},
WindowMargins->{{-1163, Automatic}, {-192, Automatic}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3846, 98, 141, "Input"],
Cell[4407, 120, 308, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[4740, 129, 2480, 60, 97, "Input"],
Cell[7223, 191, 967, 15, 31, "Output"],
Cell[8193, 208, 952, 14, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9182, 227, 184, 3, 31, "Input"],
Cell[9369, 232, 272, 4, 31, "Output"]
}, Open  ]],
Cell[9656, 239, 156, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[9837, 245, 1962, 48, 97, "Input"],
Cell[11802, 295, 750, 13, 56, "Output"],
Cell[12555, 310, 3351, 66, 258, "Output"],
Cell[15909, 378, 797, 14, 34, "Output"]
}, Open  ]],
Cell[16721, 395, 127, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[16873, 400, 752, 19, 33, "Input"],
Cell[17628, 421, 3264, 66, 236, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20929, 492, 151, 2, 70, "Section"],
Cell[CellGroupData[{
Cell[21105, 498, 3670, 96, 245, "Input"],
Cell[24778, 596, 615, 10, 47, "Output"],
Cell[25396, 608, 486, 6, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25931, 620, 109, 1, 70, "Section"],
Cell[26043, 623, 923, 24, 49, "Text"],
Cell[CellGroupData[{
Cell[26991, 651, 4139, 101, 162, "Input"],
Cell[31133, 754, 1440, 29, 59, "Output"],
Cell[32576, 785, 1077, 16, 31, "Output"],
Cell[33656, 803, 923, 12, 31, "Output"],
Cell[34582, 817, 7185, 127, 252, "Output"],
Cell[41770, 946, 923, 12, 31, "Output"]
}, Open  ]],
Cell[42708, 961, 909, 17, 50, "Text"],
Cell[CellGroupData[{
Cell[43642, 982, 2437, 54, 77, "Input"],
Cell[46082, 1038, 533, 10, 31, "Output"]
}, Open  ]],
Cell[46630, 1051, 355, 6, 49, "Text"],
Cell[CellGroupData[{
Cell[47010, 1061, 861, 24, 52, "Input"],
Cell[47874, 1087, 1251, 20, 31, "Output"],
Cell[49128, 1109, 1098, 17, 31, "Output"]
}, Open  ]],
Cell[50241, 1129, 379, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[50645, 1139, 1482, 26, 52, "Input"],
Cell[52130, 1167, 774, 13, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52941, 1185, 199, 3, 49, "Subsection"],
Cell[CellGroupData[{
Cell[53165, 1192, 2484, 66, 134, "Input"],
Cell[55652, 1260, 706, 15, 50, "Output"],
Cell[56361, 1277, 667, 14, 49, "Output"],
Cell[57031, 1293, 1674, 45, 70, "Output"],
Cell[58708, 1340, 1860, 51, 113, "Output"],
Cell[60571, 1393, 431, 7, 31, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

