(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     33720,        900]
NotebookOptionsPosition[     31629,        833]
NotebookOutlinePosition[     32006,        849]
CellTagsIndexPosition[     31963,        846]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["General Hamiltonian (F=1)", "Title",
 CellChangeTimes->{{3.6991184935927787`*^9, 3.699118502816848*^9}, {
  3.7106581116197977`*^9, 3.7106581122108564`*^9}, {3.7106649698332825`*^9, 
  3.710664971976497*^9}}],

Cell["\<\
Calculate the dressing RF Hamiltonian used for the shell trap when irradiated \
with RF of a general polarization. This is the most general case that we have \
to consider.\
\>", "Text",
 CellChangeTimes->{{3.699118514096655*^9, 3.6991185580514536`*^9}, {
  3.7106581307707124`*^9, 3.7106581474603815`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ex", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ey", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ez", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Brf", " ", "=", 
  RowBox[{
   RowBox[{"Bx", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Omega]", " ", "t"}], "]"}], "ex"}], " ", "+", " ", 
   RowBox[{"By", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"\[Omega]", " ", "t"}], " ", "+", " ", "\[Phi]y"}], "]"}], " ", 
    "ey"}], " ", "+", " ", 
   RowBox[{"Bz", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"\[Omega]", " ", "t"}], " ", "+", " ", "\[Phi]z"}], "]"}], " ", 
    "ez"}]}]}]}], "Input",
 CellChangeTimes->{{3.698142238961604*^9, 3.698142422777303*^9}, {
  3.698142561621646*^9, 3.6981425730231295`*^9}, {3.6991175048925743`*^9, 
  3.699117519514846*^9}, {3.699117621292633*^9, 3.6991176215528035`*^9}, {
  3.7106581030129366`*^9, 3.7106581084194775`*^9}, {3.710658160157651*^9, 
  3.7106581743350687`*^9}, {3.710658239250559*^9, 3.7106582687085047`*^9}}],

Cell["\<\
Transform the field in the lab frame to the local coordinate system.We first \
rotate through the y-axis by an angle \[Theta], then rotate through the x\
\[CloseCurlyQuote]-axis by angle \[Gamma].\
\>", "Text",
 CellChangeTimes->{{3.711867778771132*^9, 3.711867787612383*^9}, {
  3.7118735021868796`*^9, 3.711873506441*^9}, {3.711873553225787*^9, 
  3.711873554169812*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Ry", " ", "=", " ", 
   RowBox[{"RotationMatrix", "[", 
    RowBox[{"\[Theta]", ",", " ", "ey"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rz", " ", "=", " ", 
   RowBox[{"RotationMatrix", "[", 
    RowBox[{"\[Gamma]", ",", " ", "ex"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<Rotation Matrix=\>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Rz", ".", "Ry"}], "]"}]}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BrfLocal", " ", "=", " ", 
   RowBox[{"Rz", ".", "Ry", ".", "Brf"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<B field in local coordinates=\>\"", ",", " ", 
    RowBox[{"MatrixForm", "[", "BrfLocal", "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.698142238961604*^9, 3.698142422777303*^9}, {
   3.698142561621646*^9, 3.698142584071286*^9}, {3.698142741195299*^9, 
   3.6981428416753845`*^9}, 3.6981429801210375`*^9, {3.698143010639648*^9, 
   3.6981430293698688`*^9}, {3.6981438685991*^9, 3.698143869156577*^9}, {
   3.6981476644539127`*^9, 3.698147678319022*^9}, {3.6981479054251966`*^9, 
   3.698147910120343*^9}, {3.699117529814864*^9, 3.699117541877957*^9}, {
   3.6991932438423767`*^9, 3.6991932602784033`*^9}, {3.6991938415457377`*^9, 
   3.6991938770353007`*^9}, {3.6991939189979825`*^9, 
   3.6991939433775616`*^9}, {3.710690307708518*^9, 3.710690307875534*^9}, {
   3.710690472716302*^9, 3.710690483233353*^9}, {3.7118734979897614`*^9, 
   3.7118734981037655`*^9}, {3.711873557171897*^9, 3.7118735628240614`*^9}}],

Cell[TextData[{
 "Calculate the value of \[CapitalBeta] dot \[Mu] in the local frame. We \
rewrite the operators ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["F", "x"], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["F", "y"], TraditionalForm]]],
 " in terms of the raising and lowering operators."
}], "Text",
 CellChangeTimes->{{3.698143227304467*^9, 3.698143285869618*^9}, {
  3.6981433540989633`*^9, 3.6981433567237616`*^9}, {3.6981434423145895`*^9, 
  3.6981434550272245`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Fx", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Fp", " ", "+", " ", "Fm"}], ")"}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fy", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Fp", " ", "-", " ", "Fm"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", "\[ImaginaryI]"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fvec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"Fx", ",", " ", "Fy", ",", " ", "Fz"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FdotB", " ", "=", " ", 
  RowBox[{"gF", " ", "uB", " ", 
   RowBox[{"Dot", "[", 
    RowBox[{"Fvec", ",", " ", "BrfLocal"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.6981433578216143`*^9, 3.698143479034515*^9}, {
  3.6981435779123898`*^9, 3.6981435786483383`*^9}, {3.6981476927732215`*^9, 
  3.6981477201557407`*^9}, {3.698657076290013*^9, 3.698657089534926*^9}, {
  3.6986571407819834`*^9, 3.6986571426338816`*^9}, {3.6991176397972636`*^9, 
  3.699117662319462*^9}, {3.699117739433715*^9, 3.6991177401737156`*^9}, {
  3.6991204669787445`*^9, 3.699120468606891*^9}}],

Cell[TextData[{
 "Determine the coefficients for the coherence terms (which are proportional \
to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["F", "+"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["F", "-"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " respectively), for F=1 the Clebsch Gordon coefficients are all 1/sqrt(2)"
}], "Text",
 CellChangeTimes->{{3.6981436479970865`*^9, 3.698143751270294*^9}}],

Cell[TextData[{
 "\nExpress in matrix form. Create a functional form of the raising and \
lowering operators for the Hilbert space ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "F"], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "2"}], ",", 
      RowBox[{"-", "1"}], ",", "0", ",", "1", ",", "2"}], "}"}]}], 
   TraditionalForm]]],
 ". Note the expression from the Clebsch-Gordon coefficients."
}], "Text",
 CellChangeTimes->{{3.698144391048918*^9, 3.698144450597582*^9}, {
  3.712744108411418*^9, 3.7127441243490114`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ladderC", " ", "=", " ", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"F", ",", "m", ",", "pm"}], "}"}], ",", " ", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"F", 
        RowBox[{"(", 
         RowBox[{"F", "+", "1"}], ")"}]}], "-", " ", 
       RowBox[{"m", " ", 
        RowBox[{"(", 
         RowBox[{"m", " ", "+", 
          RowBox[{"pm", " ", "1"}]}], ")"}]}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CGc", " ", "=", " ", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"F", ",", "m", ",", "sign"}], "}"}], ",", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"F", 
          RowBox[{"(", 
           RowBox[{"F", "+", "1"}], ")"}]}], "-", 
         RowBox[{"m", 
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"sign", " ", "1"}]}], ")"}]}]}], ")"}], 
       RowBox[{"1", "/", "2"}]]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FpOp", " ", "=", " ", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"F", ",", "m"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"CGc", "[", 
           RowBox[{"2", ",", 
            RowBox[{"-", "2"}], ",", "1"}], "]"}], ",", "0", ",", "0", ",", 
          "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"CGc", "[", 
           RowBox[{"2", ",", 
            RowBox[{"-", "1"}], ",", "1"}], "]"}], ",", "0", ",", "0", ",", 
          "0"}], " ", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"CGc", "[", 
           RowBox[{"2", ",", "0", ",", "1"}], "]"}], ",", " ", "0", ",", 
          "0"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", 
          RowBox[{"CGc", "[", 
           RowBox[{"2", ",", "1", ",", "1"}], "]"}], ",", " ", "0"}], "}"}]}],
        "\[IndentingNewLine]", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FmOp", " ", "=", " ", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"F", ",", "m"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"CGc", "[", 
           RowBox[{"2", ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"CGc", "[", 
           RowBox[{"2", ",", "0", ",", 
            RowBox[{"-", "1"}]}], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", 
          RowBox[{"CGc", "[", 
           RowBox[{"2", ",", "1", ",", 
            RowBox[{"-", "1"}]}], "]"}], ",", "0"}], " ", "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", " ", "0", ",", 
          RowBox[{"CGc", "[", 
           RowBox[{"2", ",", "2", ",", 
            RowBox[{"-", "1"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", " ", "0"}], "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FzOp", " ", "=", " ", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "1", ",", "2"}], "}"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<\!\(\*SuperscriptBox[\(F\), \(+\)]\)=\>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FpOp", "[", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "]"}], "]"}], ",", " ", 
    "\"\<, \!\(\*SuperscriptBox[\(F\), \(-\)]\)=\>\"", ",", " ", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FmOp", "[", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "]"}], "]"}], ",", " ", 
    "\"\<, \!\(\*SubscriptBox[\(F\), \(z\)]\)=\>\"", " ", ",", " ", 
    RowBox[{"MatrixForm", "[", "FzOp", "]"}]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<\!\(\*SubscriptBox[\(H\), \(1\)]\)=\>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FdotB", " ", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Fp", "\[Rule]", " ", 
         RowBox[{"FpOp", "[", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "]"}]}], " ", ",", " ", 
        RowBox[{"Fm", " ", "\[Rule]", " ", 
         RowBox[{"FmOp", "[", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "]"}]}], " ", ",", " ", 
        RowBox[{"Fz", "\[Rule]", " ", "FzOp"}]}], "}"}]}], "]"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.69814464125541*^9, 3.6981446678982954`*^9}, {
   3.698144756330389*^9, 3.6981449255846677`*^9}, {3.6981449747427716`*^9, 
   3.698144989200238*^9}, {3.698145037224532*^9, 3.6981451014940715`*^9}, {
   3.6981451911529207`*^9, 3.6981451974322352`*^9}, {3.6981453113210554`*^9, 
   3.6981453828039045`*^9}, {3.698145413204487*^9, 3.698145750969122*^9}, {
   3.698145792811686*^9, 3.6981457952240243`*^9}, {3.6981458333118153`*^9, 
   3.698145836035222*^9}, {3.6981459131841755`*^9, 3.698146054485976*^9}, {
   3.6981460984630713`*^9, 3.6981461006382866`*^9}, {3.698146293398076*^9, 
   3.698146316269187*^9}, {3.698146539814201*^9, 3.6981465519785724`*^9}, {
   3.6981474267379937`*^9, 3.698147427454916*^9}, {3.698147571250761*^9, 
   3.6981475738730407`*^9}, {3.6981477137563467`*^9, 3.698147742756998*^9}, 
   3.6986571257518225`*^9, {3.699117765051417*^9, 3.699117775500968*^9}, {
   3.699117837423959*^9, 3.699117881412531*^9}, {3.699117918022357*^9, 
   3.699117956201132*^9}, {3.69911798778257*^9, 3.69911799149885*^9}, {
   3.699118027128964*^9, 3.6991181346587896`*^9}, {3.699118359267784*^9, 
   3.6991183719148054`*^9}, {3.699118403012973*^9, 3.6991184647094555`*^9}, {
   3.699194001249405*^9, 3.699194017535143*^9}, {3.699194056972752*^9, 
   3.6991940586679564`*^9}, {3.7106886160301466`*^9, 
   3.7106886166362076`*^9}, {3.7127440733409114`*^9, 3.712744076900267*^9}, {
   3.7127441340469813`*^9, 3.7127442698365593`*^9}, {3.712744307495324*^9, 
   3.7127443251430893`*^9}, {3.712744367080282*^9, 3.7127444144350176`*^9}, {
   3.7127444817817516`*^9, 3.712744562361809*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"H1", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{"FdotB", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Fp", "\[Rule]", " ", 
        RowBox[{"FpOp", "[", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "]"}]}], " ", ",", " ", 
       RowBox[{"Fm", " ", "\[Rule]", " ", 
        RowBox[{"FmOp", "[", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "]"}]}], " ", ",", " ", 
       RowBox[{"Fz", "\[Rule]", " ", "FzOp"}]}], "}"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H0", " ", "=", " ", 
   RowBox[{"(", " ", 
    RowBox[{"\[Omega]0", " ", "FzOp"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<H0=\>\"", ",", 
    RowBox[{"MatrixForm", "[", "H0", "]"}], " ", ",", "\"\<, H1=\>\"", ",", 
    RowBox[{"MatrixForm", "[", "H1", "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.698657444467405*^9, 3.6986574763473473`*^9}, {
  3.6991194363387094`*^9, 3.6991194366457424`*^9}, {3.699120371700287*^9, 
  3.6991203833369074`*^9}, {3.699161057850796*^9, 3.6991610584806004`*^9}, {
  3.6991610902445917`*^9, 3.6991612208778057`*^9}, {3.699165837790621*^9, 
  3.69916583986069*^9}, {3.7106611671058893`*^9, 3.7106611730872006`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"H1", "[", 
   RowBox[{"[", "2", "]"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1", "[", 
   RowBox[{"[", "2", "]"}], "]"}], "[", 
  RowBox[{"[", "3", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1", "[", 
   RowBox[{"[", "3", "]"}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"BrfLocal", " ", "/.", " ", 
   RowBox[{"{", " ", 
    RowBox[{"\[Theta]", "\[Rule]", " ", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.711866817893179*^9, 3.71186684149597*^9}, {
   3.7118668717387*^9, 3.7118668845895844`*^9}, {3.711867030121038*^9, 
   3.711867051161038*^9}, {3.711867275385213*^9, 3.711867292270664*^9}, 
   3.7118680309382935`*^9, {3.71186815033887*^9, 3.7118681838057604`*^9}, {
   3.712567616104842*^9, 3.71256762928798*^9}}],

Cell[CellGroupData[{

Cell["Circular Polarised RF", "Section",
 CellChangeTimes->{{3.699161029842953*^9, 3.6991610307231665`*^9}, {
  3.71065866259889*^9, 3.7106586734189715`*^9}}],

Cell["\<\
We compare the general (and cumbersome) formula to that of circular polarised \
RF in the following limiting case:\
\>", "Text",
 CellChangeTimes->{{3.710658676416271*^9, 3.7106587144130707`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"circularPolarised", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"By", " ", "\[Rule]", " ", "B"}], ",", " ", 
     RowBox[{"Bx", " ", "\[Rule]", " ", "B"}], ",", " ", 
     RowBox[{"Bz", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]z", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]y", " ", "\[Rule]", " ", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7106587156821976`*^9, 3.7106587704976788`*^9}}],

Cell["\<\
Applying this substituion we find that, at the bottom of the shell:\
\>", "Text",
 CellChangeTimes->{{3.710658781290758*^9, 3.710658798856514*^9}, {
  3.7106588325538836`*^9, 3.7106588458832164`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bottomOfShell", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Gamma]", " ", "\[Rule]", " ", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1Circ", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H1", "+", "H0"}], ")"}], "/.", "circularPolarised"}], " ", "/.",
      " ", "bottomOfShell"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"TrigToExp", "[", "H1Circ", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7106588056481934`*^9, 3.710658813399968*^9}, {
  3.710658851612789*^9, 3.710658856492277*^9}, {3.710658900960724*^9, 
  3.7106589723388605`*^9}, {3.7106591409447193`*^9, 3.710659167913416*^9}, {
  3.7106592984804716`*^9, 3.71065930536316*^9}, {3.710659752994845*^9, 
  3.710659800781623*^9}, {3.7106598379413385`*^9, 3.7106599854785585`*^9}, {
  3.7106601782938375`*^9, 3.7106601818541937`*^9}, {3.7106905959996285`*^9, 
  3.7106905961346416`*^9}, {3.7106910334734945`*^9, 3.7106910464577923`*^9}, {
  3.711878975279566*^9, 3.711878976091588*^9}, {3.712570037492241*^9, 
  3.712570037965288*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linear Polarised RF", "Section",
 CellChangeTimes->{{3.710659218686493*^9, 3.710659289142538*^9}, {
  3.710659989771988*^9, 3.7106600060926194`*^9}}],

Cell["\<\
Likewise, compare the results for linear polarised RF at a few key points.\
\>", "Text",
 CellChangeTimes->{{3.71066000800081*^9, 3.7106600522792377`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"linearPolarised", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"By", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"Bx", " ", "\[Rule]", " ", "B"}], ",", " ", 
     RowBox[{"Bz", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]z", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]y", " ", "\[Rule]", " ", "0"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7106600540464144`*^9, 3.710660078217831*^9}, {
  3.7106601170977187`*^9, 3.71066013141115*^9}}],

Cell["At the bottom of the shell:", "Text",
 CellChangeTimes->{{3.7106601411081195`*^9, 3.710660150331042*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"H1Lin", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H1", "+", "H0"}], ")"}], "/.", "linearPolarised"}], " ", "/.",
      "bottomOfShell"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "H1Lin", "]"}]}], "Input",
 CellChangeTimes->{{3.710660157555764*^9, 3.7106601642204304`*^9}, {
  3.710660214887497*^9, 3.710660262368244*^9}}],

Cell["\<\
Along the y-axis the interaction terms should equal the same as at the bottom \
of the shell, as the local field is perpendicular to the oscillating field in \
both.\
\>", "Text",
 CellChangeTimes->{{3.710664764699772*^9, 3.710664800138315*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"yaxisSide", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]", " ", "\[Rule]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"\[Gamma]", "\[Rule]", " ", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1Lin", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H1", "+", "H0"}], ")"}], "/.", "linearPolarised"}], " ", "/.",
      "yaxisSide"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "H1Lin", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<Local B field = \>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{
      RowBox[{"BrfLocal", "/.", "yaxisSide"}], "/.", "linearPolarised"}], 
     "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7106648070750084`*^9, 3.710664861005401*^9}, {
  3.710664913735674*^9, 3.7106649230886087`*^9}, {3.710690349463978*^9, 
  3.710690351420173*^9}, {3.710691081188265*^9, 3.710691107366883*^9}, {
  3.710691262965371*^9, 3.710691293726447*^9}, {3.7118667027531295`*^9, 
  3.7118667078220844`*^9}, {3.7118790360222993`*^9, 3.711879039447394*^9}}],

Cell["\<\
Along the x-axis we should see that the interaction terms vanish:\
\>", "Text",
 CellChangeTimes->{{3.7106602773347406`*^9, 3.710660322050212*^9}, {
  3.710664761264428*^9, 3.710664763936695*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sideOfShell", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]", "\[Rule]", " ", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", " ", 
     RowBox[{"\[Gamma]", "\[Rule]", " ", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1Lin", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H1", "+", "H0"}], ")"}], "/.", "linearPolarised"}], " ", "/.",
      "sideOfShell"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "H1Lin", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<Local B field = \>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{
      RowBox[{"BrfLocal", "/.", "sideOfShell"}], "/.", "linearPolarised"}], 
     "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.710660326555662*^9, 3.7106603938773937`*^9}, {
  3.71066074454712*^9, 3.7106607450201674`*^9}, {3.7106610490333357`*^9, 
  3.7106610491523476`*^9}, {3.7106611924391356`*^9, 3.7106612069275846`*^9}, {
  3.71069050820285*^9, 3.7106905422522545`*^9}, {3.710691126319778*^9, 
  3.7106911608971653`*^9}, {3.710691297829857*^9, 3.71069131036111*^9}, {
  3.7118790804251575`*^9, 3.7118790814911876`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Approximations", "Chapter",
 CellChangeTimes->{{3.710667728168255*^9, 3.710667729583397*^9}}],

Cell["\<\
Most of the time we are only interested in the potential for specific cases \
(circular, linear polarisation, points along z, etc). Which of these \
assumptions is the greatest simplification for computational speed?\
\>", "Text",
 CellChangeTimes->{{3.710667963853245*^9, 3.7106680253013887`*^9}}],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"H1", "+", "H0"}], ")"}], "/.", "bottomOfShell"}], "]"}]], "Input",
 CellChangeTimes->{{3.710668032043063*^9, 3.710668086969555*^9}}],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"H1", "+", "H0"}], ")"}], "/.", "linearPolarised"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.710668102990157*^9, 3.710668113971607*^9}}],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"H1", "+", "H0"}], ")"}], "/.", "circularPolarised"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7106681734053144`*^9, 3.710668175236497*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ellipticalPolarised", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Bz", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]y", " ", "\[Rule]", " ", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"H1", "+", "H0"}], ")"}], "/.", "ellipticalPolarised"}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7117758519351683`*^9, 3.7117758520851583`*^9}, {
  3.711775890449335*^9, 3.7117759668208027`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ellipticalPolarised", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Bz", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]y", " ", "\[Rule]", " ", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"H1", "+", "H0"}], ")"}], "/.", "ellipticalPolarised"}], " ", "/.",
     " ", "bottomOfShell"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7124846755077934`*^9, 3.7124846801254234`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.712636300743037*^9, 3.7126363049490376`*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Alternative approach: coefficients of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["F", "z"], ",", " ", 
    SubscriptBox["F", "\[PlusMinus]"]}], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Section",
 CellChangeTimes->{{3.7127449902125893`*^9, 3.7127450252590933`*^9}}],

Cell[TextData[{
 "Perhaps there is an easier way to write this out, in terms of the parallel \
and perpendicular terms of the B-field, and then multiply these by the matrix \
representations of Fz, F\[PlusMinus]. ",
 StyleBox["This also means the Hamiltonian can be more easily calculated for \
any general F, with clearer code.",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.712744727874358*^9, 3.712744766728243*^9}, {
  3.7127483955110855`*^9, 3.7127484139669304`*^9}}],

Cell[BoxData[{
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<\!\(\*SubscriptBox[\(H\), \(1\)]\)=\>\"", ",", "FdotB"}], " ",
    "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cFz", " ", "=", " ", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"FdotB", ",", " ", "Fz"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cFp", " ", "=", " ", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"FdotB", ",", " ", "Fp"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cFm", " ", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"FdotB", ",", " ", "Fm"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "\"\<Coefficients:\>\"", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(F\), \(z\)]\): \>\"", ",", " ", "cFz"}], "}"}],
     ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(F\), \(-\)]\): \>\"", ",", " ", "cFm"}], "}"}],
     ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(F\), \(+\)]\): \>\"", ",", " ", "cFp"}], 
     "}"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.712744788450415*^9, 3.7127449868182497`*^9}}],

Cell[CellGroupData[{

Cell["Approximations", "Subsection",
 CellChangeTimes->{{3.712745050397607*^9, 3.7127450543720045`*^9}, {
  3.7127450961851854`*^9, 3.7127451020387707`*^9}}],

Cell[BoxData[{
 RowBox[{"approx", " ", "=", " ", "bottomOfShell"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "\"\<Coefficients:\>\"", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<\!\(\*SubscriptBox[\(F\), \(z\)]\): \>\"", ",", " ", 
      RowBox[{"cFz", " ", "/.", " ", "approx"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<\!\(\*SubscriptBox[\(F\), \(-\)]\): \>\"", ",", " ", 
      RowBox[{"cFm", " ", "/.", " ", "approx"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<\!\(\*SubscriptBox[\(F\), \(+\)]\): \>\"", ",", " ", 
      RowBox[{"cFp", " ", "/.", " ", "approx"}]}], "}"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7127451284664135`*^9, 3.712745137960363*^9}, 
   3.712745199901556*^9}],

Cell[BoxData[{
 RowBox[{"approx", " ", "=", " ", 
  RowBox[{"Join", "[", 
   RowBox[{"bottomOfShell", ",", " ", "circularPolarised"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "\"\<Coefficients:\>\"", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<\!\(\*SubscriptBox[\(F\), \(z\)]\): \>\"", ",", " ", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"cFz", " ", "/.", " ", "approx"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<\!\(\*SubscriptBox[\(F\), \(-\)]\): \>\"", ",", " ", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"cFm", " ", "/.", " ", "approx"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<\!\(\*SubscriptBox[\(F\), \(+\)]\): \>\"", ",", " ", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"cFp", " ", "/.", " ", "approx"}], "]"}]}], "}"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7127451483384004`*^9, 3.7127452240859747`*^9}, {
  3.712745330801645*^9, 3.7127454014447083`*^9}}],

Cell[BoxData[{
 RowBox[{"approx", " ", "=", " ", "linearPolarised"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "\"\<Coefficients:\>\"", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<\!\(\*SubscriptBox[\(F\), \(z\)]\): \>\"", ",", " ", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"cFz", " ", "/.", " ", "approx"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<\!\(\*SubscriptBox[\(F\), \(-\)]\): \>\"", ",", " ", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"cFm", " ", "/.", " ", "approx"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<\!\(\*SubscriptBox[\(F\), \(+\)]\): \>\"", ",", " ", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"cFp", " ", "/.", " ", "approx"}], "]"}]}], "}"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7127454183654003`*^9, 3.7127454191584797`*^9}, {
  3.712745459056469*^9, 3.712745460255589*^9}}],

Cell[BoxData[{
 RowBox[{"approx", " ", "=", " ", 
  RowBox[{"Join", "[", 
   RowBox[{"bottomOfShell", ",", " ", "linearPolarised"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "\"\<Coefficients:\>\"", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<\!\(\*SubscriptBox[\(F\), \(z\)]\): \>\"", ",", " ", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"cFz", " ", "/.", " ", "approx"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<\!\(\*SubscriptBox[\(F\), \(-\)]\): \>\"", ",", " ", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"cFm", " ", "/.", " ", "approx"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<\!\(\*SubscriptBox[\(F\), \(+\)]\): \>\"", ",", " ", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"cFp", " ", "/.", " ", "approx"}], "]"}]}], "}"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.71274546296686*^9, 3.712745463613925*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 926},
WindowMargins->{{-1274, Automatic}, {-139, Automatic}},
Magnification:>0.9 Inherited,
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 214, 3, 91, "Title"],
Cell[797, 27, 317, 6, 28, "Text"],
Cell[1117, 35, 1287, 32, 90, "Input"],
Cell[2407, 69, 383, 7, 28, "Text"],
Cell[2793, 78, 1631, 33, 110, "Input"],
Cell[4427, 113, 507, 14, 31, "Text"],
Cell[4937, 129, 1151, 29, 90, "Input"],
Cell[6091, 160, 479, 14, 28, "Text"],
Cell[6573, 176, 552, 15, 47, "Text"],
Cell[7128, 193, 7027, 170, 516, "Input"],
Cell[14158, 365, 1280, 30, 70, "Input"],
Cell[15441, 397, 1067, 26, 110, "Input"],
Cell[CellGroupData[{
Cell[16533, 427, 158, 2, 61, "Section"],
Cell[16694, 431, 206, 4, 28, "Text"],
Cell[16903, 437, 518, 11, 29, "Input"],
Cell[17424, 450, 210, 4, 28, "Text"],
Cell[17637, 456, 1226, 26, 70, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18900, 487, 155, 2, 61, "Section"],
Cell[19058, 491, 165, 3, 28, "Text"],
Cell[19226, 496, 533, 11, 29, "Input"],
Cell[19762, 509, 111, 1, 28, "Text"],
Cell[19876, 512, 439, 11, 50, "Input"],
Cell[20318, 525, 255, 5, 28, "Text"],
Cell[20576, 532, 1223, 29, 90, "Input"],
Cell[21802, 563, 206, 4, 28, "Text"],
Cell[22011, 569, 1262, 30, 90, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23310, 604, 99, 1, 66, "Chapter"],
Cell[23412, 607, 308, 5, 47, "Text"],
Cell[23723, 614, 216, 5, 29, "Input"],
Cell[23942, 621, 221, 6, 29, "Input"],
Cell[24166, 629, 225, 6, 29, "Input"],
Cell[24394, 637, 591, 15, 50, "Input"],
Cell[24988, 654, 592, 15, 50, "Input"],
Cell[25583, 671, 94, 1, 29, "Input"],
Cell[CellGroupData[{
Cell[25702, 676, 313, 9, 61, "Section"],
Cell[26018, 687, 483, 9, 47, "Text"],
Cell[26504, 698, 1192, 33, 110, "Input"],
Cell[CellGroupData[{
Cell[27721, 735, 157, 2, 45, "Subsection"],
Cell[27881, 739, 777, 17, 50, "Input"],
Cell[28661, 758, 1016, 23, 50, "Input"],
Cell[29680, 783, 936, 20, 50, "Input"],
Cell[30619, 805, 958, 22, 50, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)
 3.6981434550272245`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Fx", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Fp", " ", "+", " ", "Fm"}], ")"}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fy", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Fp", " ", "-", " ", "Fm"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", "\[ImaginaryI]"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fvec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"Fx", ",", " ", "Fy", ",", " ", "Fz"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FdotB", " ", "=", " ", 
  RowBox[{"gF", " ", "uB", " ", 
   RowBox[{"Dot", "[", 
    RowBox[{"Fvec", ",", " ", "BrfLocal"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.6981433578216143`*^9, 3.698143479034515*^9}, {
  3.6981435779123898`*^9, 3.6981435786483383`*^9}, {3.6981476927732215`*^9, 
  3.6981477201557407`*^9}, {3.698657076290013*^9, 3.698657089534926*^9}, {
  3.6986571407819834`*^9, 3.6986571426338816`*^9}, {3.6991176397972636`*^9, 
  3.699117662319462*^9}, {3.699117739433715*^9, 3.6991177401737156`*^9}, {
  3.6991204669787445`*^9, 3.699120468606891*^9}}],

Cell[BoxData[
 RowBox[{"gF", " ", "uB", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Fz", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "Bx"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
       RowBox[{"Bz", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]z", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"Fm", "+", "Fp"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Bx", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
       RowBox[{"By", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]y", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
       RowBox[{"Bz", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]z", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "Fm"}], "+", "Fp"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Bx", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
       RowBox[{"By", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]y", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
       RowBox[{"Bz", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]z", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.698143481932017*^9, 3.6981435799247155`*^9, {3.6981438542340097`*^9, 
   3.6981438715050583`*^9}, 3.6981477451484475`*^9, {3.69865713529646*^9, 
   3.6986571431793933`*^9}, {3.699117646987262*^9, 3.6991176628394623`*^9}, 
   3.6991177474212103`*^9, 3.6991203915969114`*^9, {3.69912046949925*^9, 
   3.699120477255663*^9}, {3.699193953218419*^9, 3.6991939643803377`*^9}, 
   3.710657758341159*^9, 3.710658308694503*^9, 3.7106584025188847`*^9, 
   3.710661177972689*^9, 3.710664752938596*^9, 3.7106903663946705`*^9, {
   3.710690460550085*^9, 3.710690487459776*^9}}]
}, Open  ]],

Cell[TextData[{
 "Determine the coefficients for the coherence terms (which are proportional \
to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["F", "+"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["F", "-"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " respectively), for F=1 the Clebsch Gordon coefficients are all 1/sqrt(2)"
}], "Text",
 CellChangeTimes->{{3.6981436479970865`*^9, 3.698143751270294*^9}}],

Cell[TextData[{
 "\nExpress in matrix form. Create a functional form of the raising and \
lowering operators for the Hilbert space ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "F"], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "."
}], "Text",
 CellChangeTimes->{{3.698144391048918*^9, 3.698144450597582*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ladderC", " ", "=", " ", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"F", ",", "m", ",", "pm"}], "}"}], ",", " ", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"F", 
         RowBox[{"(", 
          RowBox[{"F", "+", "1"}], ")"}]}], "-", " ", 
        RowBox[{"m", " ", 
         RowBox[{"(", 
          RowBox[{"m", " ", "+", 
           RowBox[{"pm", " ", "1"}]}], ")"}]}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FpOp", " ", "=", " ", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"F", ",", "m"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Sqrt]", "2"}], ",", "0", ",", "0"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"\[Sqrt]", "2"}], ",", "0"}], " ", "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FmOp", " ", "=", " ", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"F", ",", "m"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"\[Sqrt]", "2"}], ",", "0"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"\[Sqrt]", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], " ", "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FzOp", " ", "=", " ", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<\!\(\*SuperscriptBox[\(F\), \(+\)]\)=\>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FpOp", "[", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "]"}], "]"}], ",", " ", 
    "\"\<, \!\(\*SuperscriptBox[\(F\), \(-\)]\)=\>\"", ",", " ", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FmOp", "[", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "]"}], "]"}], ",", " ", 
    "\"\<, \!\(\*SubscriptBox[\(F\), \(z\)]\)=\>\"", " ", ",", " ", 
    RowBox[{"MatrixForm", "[", "FzOp", "]"}]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<\!\(\*SubscriptBox[\(H\), \(1\)]\)=\>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FdotB", " ", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Fp", "\[Rule]", " ", 
         RowBox[{"FpOp", "[", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "]"}]}], " ", ",", " ", 
        RowBox[{"Fm", " ", "\[Rule]", " ", 
         RowBox[{"FmOp", "[", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "]"}]}], " ", ",", " ", 
        RowBox[{"Fz", "\[Rule]", " ", "FzOp"}]}], "}"}]}], "]"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.69814464125541*^9, 3.6981446678982954`*^9}, {
   3.698144756330389*^9, 3.6981449255846677`*^9}, {3.6981449747427716`*^9, 
   3.698144989200238*^9}, {3.698145037224532*^9, 3.6981451014940715`*^9}, {
   3.6981451911529207`*^9, 3.6981451974322352`*^9}, {3.6981453113210554`*^9, 
   3.6981453828039045`*^9}, {3.698145413204487*^9, 3.698145750969122*^9}, {
   3.698145792811686*^9, 3.6981457952240243`*^9}, {3.6981458333118153`*^9, 
   3.698145836035222*^9}, {3.6981459131841755`*^9, 3.698146054485976*^9}, {
   3.6981460984630713`*^9, 3.6981461006382866`*^9}, {3.698146293398076*^9, 
   3.698146316269187*^9}, {3.698146539814201*^9, 3.6981465519785724`*^9}, {
   3.6981474267379937`*^9, 3.698147427454916*^9}, {3.698147571250761*^9, 
   3.6981475738730407`*^9}, {3.6981477137563467`*^9, 3.698147742756998*^9}, 
   3.6986571257518225`*^9, {3.699117765051417*^9, 3.699117775500968*^9}, {
   3.699117837423959*^9, 3.699117881412531*^9}, {3.699117918022357*^9, 
   3.699117956201132*^9}, {3.69911798778257*^9, 3.69911799149885*^9}, {
   3.699118027128964*^9, 3.6991181346587896`*^9}, {3.699118359267784*^9, 
   3.6991183719148054`*^9}, {3.699118403012973*^9, 3.6991184647094555`*^9}, {
   3.699194001249405*^9, 3.699194017535143*^9}, {3.699194056972752*^9, 
   3.6991940586679564`*^9}, {3.7106886160301466`*^9, 3.7106886166362076`*^9}}],

Cell[BoxData[
 TemplateBox[{"\"\\!\\(\\*SuperscriptBox[\\(F\\), \\(+\\)]\\)=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{"0", "0", "0"}, {
         SqrtBox["2"], "0", "0"}, {"0", 
         SqrtBox["2"], "0"}}, RowSpacings -> 1, ColumnSpacings -> 1, 
       RowAlignments -> Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
      ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]],
   "\", \\!\\(\\*SuperscriptBox[\\(F\\), \\(-\\)]\\)=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{"0", 
         SqrtBox["2"], "0"}, {"0", "0", 
         SqrtBox["2"]}, {"0", "0", "0"}}, RowSpacings -> 1, ColumnSpacings -> 
       1, RowAlignments -> Baseline, ColumnAlignments -> Center], 
      "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]],
   "\", \\!\\(\\*SubscriptBox[\\(F\\), \\(z\\)]\\)=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{
         RowBox[{"-", "1"}], "0", "0"}, {"0", "0", "0"}, {"0", "0", "1"}}, 
       RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
       ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.6991184618700066`*^9, 3.699118465199197*^9}, 
   3.6991203916069117`*^9, 3.6991204772756653`*^9, {3.6991939563895607`*^9, 
   3.69919396439736*^9}, {3.6991940052976637`*^9, 3.6991940179191294`*^9}, 
   3.6991940592865973`*^9, 3.710657758380163*^9, 3.7106583213947725`*^9, 
   3.7106584025318856`*^9, 3.7106611779846907`*^9, 3.7106647529495964`*^9, 
   3.710690366409672*^9, {3.7106904605610857`*^9, 3.710690487475777*^9}}],

Cell[BoxData[
 TemplateBox[{"\"\\!\\(\\*SubscriptBox[\\(H\\), \\(1\\)]\\)=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               RowBox[{"Bx", " ", 
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
               RowBox[{"Bz", " ", 
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
                  RowBox[{"By", " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], "0"}, {
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
                  RowBox[{"By", " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], "0", 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
                  RowBox[{"By", " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}]}, {"0", 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
                  RowBox[{"By", " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               RowBox[{
                 RowBox[{"-", "Bx"}], " ", 
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
               RowBox[{"Bz", " ", 
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}]}}, 
       RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
       ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.6991184618700066`*^9, 3.699118465199197*^9}, 
   3.6991203916069117`*^9, 3.6991204772756653`*^9, {3.6991939563895607`*^9, 
   3.69919396439736*^9}, {3.6991940052976637`*^9, 3.6991940179191294`*^9}, 
   3.6991940592865973`*^9, 3.710657758380163*^9, 3.7106583213947725`*^9, 
   3.7106584025318856`*^9, 3.7106611779846907`*^9, 3.7106647529495964`*^9, 
   3.710690366409672*^9, {3.7106904605610857`*^9, 3.710690487481778*^9}}]
}, Open  ]],

Cell["\<\

At the bottom of the shell, where \[Theta] -> 0\
\>", "Text",
 CellChangeTimes->{{3.698147854596798*^9, 3.698147975435675*^9}, {
  3.6991203515266314`*^9, 3.6991203668144197`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"H1", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{"FdotB", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Fp", "\[Rule]", " ", 
        RowBox[{"FpOp", "[", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "]"}]}], " ", ",", " ", 
       RowBox[{"Fm", " ", "\[Rule]", " ", 
        RowBox[{"FmOp", "[", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "]"}]}], " ", ",", " ", 
       RowBox[{"Fz", "\[Rule]", " ", "FzOp"}]}], "}"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H0", " ", "=", " ", 
   RowBox[{"(", " ", 
    RowBox[{"\[Omega]0", " ", "FzOp"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<H0=\>\"", ",", 
    RowBox[{"MatrixForm", "[", "H0", "]"}], " ", ",", "\"\<, H1=\>\"", ",", 
    RowBox[{"MatrixForm", "[", "H1", "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.698657444467405*^9, 3.6986574763473473`*^9}, {
  3.6991194363387094`*^9, 3.6991194366457424`*^9}, {3.699120371700287*^9, 
  3.6991203833369074`*^9}, {3.699161057850796*^9, 3.6991610584806004`*^9}, {
  3.6991610902445917`*^9, 3.6991612208778057`*^9}, {3.699165837790621*^9, 
  3.69916583986069*^9}, {3.7106611671058893`*^9, 3.7106611730872006`*^9}}],

Cell[BoxData[
 TemplateBox[{"\"H0=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{
         RowBox[{"-", "\[Omega]0"}], "0", "0"}, {"0", "0", "0"}, {
        "0", "0", "\[Omega]0"}}, RowSpacings -> 1, ColumnSpacings -> 1, 
       RowAlignments -> Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
      ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]],"\", H1=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               RowBox[{"Bx", " ", 
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
               RowBox[{"Bz", " ", 
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
                  RowBox[{"By", " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], "0"}, {
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
                  RowBox[{"By", " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], "0", 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
                  RowBox[{"By", " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}]}, {"0", 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
                  RowBox[{"By", " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               RowBox[{
                 RowBox[{"-", "Bx"}], " ", 
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
               RowBox[{"Bz", " ", 
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}]}}, 
       RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
       ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.698657446089698*^9, 3.6986574768506784`*^9}, 
   3.6986575161888065`*^9, {3.69911942769867*^9, 3.699119437215463*^9}, {
   3.699120384066904*^9, 3.6991203916289597`*^9}, 3.699120477285664*^9, 
   3.6991610989343915`*^9, 3.699161221327633*^9, {3.6991658402604628`*^9, 
   3.6991658558308764`*^9}, {3.699193959145607*^9, 3.6991939644234324`*^9}, 
   3.710657758400165*^9, 3.7106583326408973`*^9, 3.710658402554888*^9, {
   3.710661173747267*^9, 3.7106611780066924`*^9}, 3.7106647529705987`*^9, 
   3.7106903664366746`*^9, {3.710690460589089*^9, 3.7106904874987793`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Circular Polarised RF", "Section",
 CellChangeTimes->{{3.699161029842953*^9, 3.6991610307231665`*^9}, {
  3.71065866259889*^9, 3.7106586734189715`*^9}}],

Cell["\<\
We compare the general (and cumbersome) formula to that of circular polarised \
RF in the following limiting case:\
\>", "Text",
 CellChangeTimes->{{3.710658676416271*^9, 3.7106587144130707`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"circularPolarised", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"By", " ", "\[Rule]", " ", "B"}], ",", " ", 
     RowBox[{"Bx", " ", "\[Rule]", " ", "B"}], ",", " ", 
     RowBox[{"Bz", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]z", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]y", " ", "\[Rule]", " ", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7106587156821976`*^9, 3.7106587704976788`*^9}}],

Cell["\<\
Applying this substituion we find that, at the bottom of the shell:\
\>", "Text",
 CellChangeTimes->{{3.710658781290758*^9, 3.710658798856514*^9}, {
  3.7106588325538836`*^9, 3.7106588458832164`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bottomOfShell", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]", "\[Rule]", " ", "\[Pi]"}], ",", " ", 
     RowBox[{"\[Phi]", " ", "\[Rule]", " ", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1Circ", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H1", "+", "H0"}], ")"}], "/.", "circularPolarised"}], " ", "/.",
      " ", "bottomOfShell"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"TrigToExp", "[", "H1Circ", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7106588056481934`*^9, 3.710658813399968*^9}, {
  3.710658851612789*^9, 3.710658856492277*^9}, {3.710658900960724*^9, 
  3.7106589723388605`*^9}, {3.7106591409447193`*^9, 3.710659167913416*^9}, {
  3.7106592984804716`*^9, 3.71065930536316*^9}, {3.710659752994845*^9, 
  3.710659800781623*^9}, {3.7106598379413385`*^9, 3.7106599854785585`*^9}, {
  3.7106601782938375`*^9, 3.7106601818541937`*^9}, {3.7106905959996285`*^9, 
  3.7106905961346416`*^9}, {3.7106910334734945`*^9, 3.7106910464577923`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "\[Omega]0"}], 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "B", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "t", " ", "\[Omega]"}]], " ", "gF", 
        " ", "uB"}], 
       SqrtBox["2"]], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "B", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "t", " ", "\[Omega]"}]], " ", 
         "gF", " ", "uB"}], 
        SqrtBox["2"]]}], "0", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "B", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "t", " ", "\[Omega]"}]], " ", "gF", 
        " ", "uB"}], 
       SqrtBox["2"]]},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "B", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "t", " ", "\[Omega]"}]], " ", 
         "gF", " ", "uB"}], 
        SqrtBox["2"]]}], "\[Omega]0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.710658814225051*^9, {3.710658917275355*^9, 3.7106589728039074`*^9}, 
   3.710659168586484*^9, 3.710659801930738*^9, 3.7106598644689913`*^9, {
   3.710659959613426*^9, 3.710659986273638*^9}, 3.710660182509259*^9, 
   3.710661178156708*^9, 3.7106647529946012`*^9, 3.7106903664636774`*^9, {
   3.7106904013791685`*^9, 3.7106904070097313`*^9}, {3.7106904606150913`*^9, 
   3.7106904875257826`*^9}, 3.7106905968497133`*^9, {3.7106910383459816`*^9, 
   3.7106910570208488`*^9}},
 FontSize->18]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linear Polarised RF", "Section",
 CellChangeTimes->{{3.710659218686493*^9, 3.710659289142538*^9}, {
  3.710659989771988*^9, 3.7106600060926194`*^9}}],

Cell["\<\
Likewise, compare the results for linear polarised RF at a few key points.\
\>", "Text",
 CellChangeTimes->{{3.71066000800081*^9, 3.7106600522792377`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"linearPolarised", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"By", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"Bx", " ", "\[Rule]", " ", "B"}], ",", " ", 
     RowBox[{"Bz", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]z", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]y", " ", "\[Rule]", " ", "0"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7106600540464144`*^9, 3.710660078217831*^9}, {
  3.7106601170977187`*^9, 3.71066013141115*^9}}],

Cell["At the bottom of the shell:", "Text",
 CellChangeTimes->{{3.7106601411081195`*^9, 3.710660150331042*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"H1Lin", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H1", "+", "H0"}], ")"}], "/.", "linearPolarised"}], " ", "/.",
      "bottomOfShell"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "H1Lin", "]"}]}], "Input",
 CellChangeTimes->{{3.710660157555764*^9, 3.7106601642204304`*^9}, {
  3.710660214887497*^9, 3.710660262368244*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "\[Omega]0"}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B", " ", "gF", " ", "uB", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
        SqrtBox["2"]]}], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B", " ", "gF", " ", "uB", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
        SqrtBox["2"]]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B", " ", "gF", " ", "uB", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
        SqrtBox["2"]]}]},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B", " ", "gF", " ", "uB", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
        SqrtBox["2"]]}], "\[Omega]0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7106602458435917`*^9, 3.7106602628182898`*^9}, 
   3.7106611781827097`*^9, 3.7106647530096025`*^9, 3.7106903664896803`*^9, {
   3.7106904606390944`*^9, 3.7106904875477843`*^9}, 3.710690641339162*^9, 
   3.7106910595721035`*^9},
 FontSize->18]
}, Open  ]],

Cell["\<\
Along the y-axis the interaction terms should equal the same as at the bottom \
of the shell, as the local field is perpendicular to the oscillating field in \
both.\
\>", "Text",
 CellChangeTimes->{{3.710664764699772*^9, 3.710664800138315*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"yaxisSide", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]", " ", "\[Rule]", "0"}], ",", " ", 
     RowBox[{"\[Phi]", "\[Rule]", " ", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1Lin", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H1", "+", "H0"}], ")"}], "/.", "linearPolarised"}], " ", "/.",
      "yaxisSide"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "H1Lin", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<Local B field = \>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{
      RowBox[{"BrfLocal", "/.", "yaxisSide"}], "/.", "linearPolarised"}], 
     "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7106648070750084`*^9, 3.710664861005401*^9}, {
  3.710664913735674*^9, 3.7106649230886087`*^9}, {3.710690349463978*^9, 
  3.710690351420173*^9}, {3.710691081188265*^9, 3.710691107366883*^9}, {
  3.710691262965371*^9, 3.710691293726447*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "\[Omega]0"}], 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
       SqrtBox["2"]], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "B", " ", "gF", " ", "uB", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
        SqrtBox["2"]]}], "0", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
       SqrtBox["2"]]},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "B", " ", "gF", " ", "uB", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
        SqrtBox["2"]]}], "\[Omega]0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.710664923538654*^9, 3.710690366517683*^9, {3.7106904606560955`*^9, 
   3.7106904875707865`*^9}, {3.710691065344681*^9, 3.710691108222968*^9}, {
   3.7106912634604206`*^9, 3.7106913006751413`*^9}},
 FontSize->16],

Cell[BoxData[
 TemplateBox[{"\"Local B field = \"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      TagBox[
       GridBox[{{"0"}, {
          RowBox[{"B", " ", 
            RowBox[{"Sin", "[", 
              RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}, {"0"}}, RowSpacings -> 
        1, ColumnAlignments -> Center, ColumnAlignments -> Left], Column], 
      "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]},
  "RowDefault"]], "Output",
 CellChangeTimes->{
  3.710664923538654*^9, 3.710690366517683*^9, {3.7106904606560955`*^9, 
   3.7106904875707865`*^9}, {3.710691065344681*^9, 3.710691108222968*^9}, {
   3.7106912634604206`*^9, 3.7106913006811423`*^9}},
 FontSize->16]
}, Open  ]],

Cell["\<\
Along the x-axis we should see that the interaction terms vanish:\
\>", "Text",
 CellChangeTimes->{{3.7106602773347406`*^9, 3.710660322050212*^9}, {
  3.710664761264428*^9, 3.710664763936695*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sideOfShell", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]", "\[Rule]", " ", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", " ", 
     RowBox[{"\[Phi]", "\[Rule]", " ", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1Lin", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H1", "+", "H0"}], ")"}], "/.", "linearPolarised"}], " ", "/.",
      "sideOfShell"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "H1Lin", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<Local B field = \>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{
      RowBox[{"BrfLocal", "/.", "sideOfShell"}], "/.", "linearPolarised"}], 
     "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.710660326555662*^9, 3.7106603938773937`*^9}, {
  3.71066074454712*^9, 3.7106607450201674`*^9}, {3.7106610490333357`*^9, 
  3.7106610491523476`*^9}, {3.7106611924391356`*^9, 3.7106612069275846`*^9}, {
  3.71069050820285*^9, 3.7106905422522545`*^9}, {3.710691126319778*^9, 
  3.7106911608971653`*^9}, {3.710691297829857*^9, 3.71069131036111*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "\[Omega]0"}], "+", 
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], "0", "0"},
     {"0", "0", "0"},
     {"0", "0", 
      RowBox[{"\[Omega]0", "-", 
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7106603943804445`*^9, 3.7106607114468107`*^9, 3.7106607453952045`*^9, 
   3.7106610496263947`*^9, {3.710661178194711*^9, 3.7106612075116425`*^9}, 
   3.7106647530166035`*^9, 3.7106903665336847`*^9, {3.7106904606710973`*^9, 
   3.7106905515131807`*^9}, 3.7106911620272784`*^9, {3.710691302791353*^9, 
   3.710691310897164*^9}},
 FontSize->14],

Cell[BoxData[
 TemplateBox[{"\"Local B field = \"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      TagBox[
       GridBox[{{"0"}, {"0"}, {
          RowBox[{
            RowBox[{"-", "B"}], " ", 
            RowBox[{"Sin", "[", 
              RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}}, RowSpacings -> 1, 
        ColumnAlignments -> Center, ColumnAlignments -> Left], Column], 
      "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]},
  "RowDefault"]], "Output",
 CellChangeTimes->{
  3.7106603943804445`*^9, 3.7106607114468107`*^9, 3.7106607453952045`*^9, 
   3.7106610496263947`*^9, {3.710661178194711*^9, 3.7106612075116425`*^9}, 
   3.7106647530166035`*^9, 3.7106903665336847`*^9, {3.7106904606710973`*^9, 
   3.7106905515131807`*^9}, 3.7106911620272784`*^9, {3.710691302791353*^9, 
   3.7106913109031644`*^9}},
 FontSize->14]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Approximations", "Chapter",
 CellChangeTimes->{{3.710667728168255*^9, 3.710667729583397*^9}}],

Cell["\<\
Most of the time we are only interested in the potential for specific cases \
(circular, linear polarisation, points along z, etc). Which of these \
assumptions is the greatest simplification for computational speed?\
\>", "Text",
 CellChangeTimes->{{3.710667963853245*^9, 3.7106680253013887`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"H1", "+", "H0"}], ")"}], "/.", "bottomOfShell"}], "]"}]], "Input",
 CellChangeTimes->{{3.710668032043063*^9, 3.710668086969555*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "\[Omega]0"}], "+", 
       RowBox[{"Bz", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]z", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"Bx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
           SqrtBox["2"]]}], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "By", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]y", "+", 
             RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], "0"},
     {
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"Bx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
           SqrtBox["2"]]}], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "By", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]y", "+", 
             RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], "0", 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"Bx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
           SqrtBox["2"]]}], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "By", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]y", "+", 
             RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}]},
     {"0", 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"Bx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
           SqrtBox["2"]]}], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "By", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]y", "+", 
             RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], 
      RowBox[{"\[Omega]0", "-", 
       RowBox[{"Bz", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]z", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.710668087904649*^9, 3.710690366550686*^9, {3.7106904606870985`*^9, 
   3.7106904876037903`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"H1", "+", "H0"}], ")"}], "/.", "linearPolarised"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.710668102990157*^9, 3.710668113971607*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "\[Omega]0"}], "+", 
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], "0"},
     {
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], "0", 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}]},
     {"0", 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], 
      RowBox[{"\[Omega]0", "-", 
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7106681155786295`*^9, 3.7106903665676875`*^9, {3.7106904607051*^9, 
   3.7106904876237917`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"H1", "+", "H0"}], ")"}], "/.", "circularPolarised"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7106681734053144`*^9, 3.710668175236497*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "\[Omega]0"}], "+", 
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", "B"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
           RowBox[{"B", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], 
          SqrtBox["2"]], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"B", " ", 
              RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
             RowBox[{"B", " ", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], ")"}]}], 
          SqrtBox["2"]]}], ")"}]}], "0"},
     {
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", "B"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
           RowBox[{"B", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], 
          SqrtBox["2"]], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"B", " ", 
              RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
             RowBox[{"B", " ", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], ")"}]}], 
          SqrtBox["2"]]}], ")"}]}], "0", 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", "B"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
           RowBox[{"B", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], 
          SqrtBox["2"]], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"B", " ", 
              RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
             RowBox[{"B", " ", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], ")"}]}], 
          SqrtBox["2"]]}], ")"}]}]},
     {"0", 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", "B"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
           RowBox[{"B", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], 
          SqrtBox["2"]], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"B", " ", 
              RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
             RowBox[{"B", " ", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], ")"}]}], 
          SqrtBox["2"]]}], ")"}]}], 
      RowBox[{"\[Omega]0", "-", 
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.710668175724546*^9, 3.710690366580689*^9, {3.7106904607231026`*^9, 
   3.710690487641794*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1618, 833},
WindowMargins->{{53, Automatic}, {134, Automatic}},
Magnification:>0.9 Inherited,
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 214, 3, 91, "Title"],
Cell[797, 27, 317, 6, 28, "Text"],
Cell[CellGroupData[{
Cell[1139, 37, 1287, 32, 90, "Input"],
Cell[2429, 71, 866, 20, 28, "Output"]
}, Open  ]],
Cell[3310, 94, 465, 8, 28, "Text"],
Cell[CellGroupData[{
Cell[3800, 106, 1524, 31, 110, "Input"],
Cell[5327, 139, 1516, 32, 55, "Output"],
Cell[6846, 173, 2817, 60, 55, "Output"]
}, Open  ]],
Cell[9678, 236, 507, 14, 31, "Text"],
Cell[CellGroupData[{
Cell[10210, 254, 1151, 29, 90, "Input"],
Cell[11364, 285, 2839, 71, 79, "Output"]
}, Open  ]],
Cell[14218, 359, 479, 14, 28, "Text"],
Cell[14700, 375, 430, 13, 47, "Text"],
Cell[CellGroupData[{
Cell[15155, 392, 4811, 115, 437, "Input"],
Cell[19969, 509, 1655, 33, 67, "Output"],
Cell[21627, 544, 10203, 211, 91, "Output"]
}, Open  ]],
Cell[31845, 758, 191, 5, 47, "Text"],
Cell[CellGroupData[{
Cell[32061, 767, 1280, 30, 70, "Input"],
Cell[33344, 799, 10666, 221, 91, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44047, 1025, 158, 2, 61, "Section"],
Cell[44208, 1029, 206, 4, 28, "Text"],
Cell[44417, 1035, 518, 11, 29, "Input"],
Cell[44938, 1048, 210, 4, 28, "Text"],
Cell[CellGroupData[{
Cell[45173, 1056, 1130, 24, 70, "Input"],
Cell[46306, 1082, 2181, 56, 132, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[48536, 1144, 155, 2, 61, "Section"],
Cell[48694, 1148, 165, 3, 28, "Text"],
Cell[48862, 1153, 533, 11, 29, "Input"],
Cell[49398, 1166, 111, 1, 28, "Text"],
Cell[CellGroupData[{
Cell[49534, 1171, 439, 11, 50, "Input"],
Cell[49976, 1184, 1688, 48, 123, "Output"]
}, Open  ]],
Cell[51679, 1235, 255, 5, 28, "Text"],
Cell[CellGroupData[{
Cell[51959, 1244, 1094, 27, 90, "Input"],
Cell[53056, 1273, 1693, 46, 114, "Output"],
Cell[54752, 1321, 697, 17, 64, "Output"]
}, Open  ]],
Cell[55464, 1341, 206, 4, 28, "Text"],
Cell[CellGroupData[{
Cell[55695, 1349, 1207, 29, 90, "Input"],
Cell[56905, 1380, 1322, 34, 67, "Output"],
Cell[58230, 1416, 857, 20, 55, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[59136, 1442, 99, 1, 66, "Chapter"],
Cell[59238, 1445, 308, 5, 28, "Text"],
Cell[CellGroupData[{
Cell[59571, 1454, 216, 5, 29, "Input"],
Cell[59790, 1461, 3177, 92, 103, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63004, 1558, 221, 6, 29, "Input"],
Cell[63228, 1566, 3799, 100, 103, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67064, 1671, 225, 6, 29, "Input"],
Cell[67292, 1679, 5833, 152, 103, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)
)"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fvec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"Fx", ",", " ", "Fy", ",", " ", "Fz"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FdotB", " ", "=", " ", 
  RowBox[{"gF", " ", "uB", " ", 
   RowBox[{"Dot", "[", 
    RowBox[{"Fvec", ",", " ", "BrfLocal"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.6981433578216143`*^9, 3.698143479034515*^9}, {
  3.6981435779123898`*^9, 3.6981435786483383`*^9}, {3.6981476927732215`*^9, 
  3.6981477201557407`*^9}, {3.698657076290013*^9, 3.698657089534926*^9}, {
  3.6986571407819834`*^9, 3.6986571426338816`*^9}, {3.6991176397972636`*^9, 
  3.699117662319462*^9}, {3.699117739433715*^9, 3.6991177401737156`*^9}, {
  3.6991204669787445`*^9, 3.699120468606891*^9}}],

Cell[BoxData[
 RowBox[{"gF", " ", "uB", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Fz", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "Bx"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
       RowBox[{"By", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]y", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
       RowBox[{"Bz", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]z", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"Fm", "+", "Fp"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Bx", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
       RowBox[{"Bz", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]z", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "Fm"}], "+", "Fp"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Bx", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
       RowBox[{"By", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]y", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "-", 
       RowBox[{"Bz", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]z", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.698143481932017*^9, 3.6981435799247155`*^9, {3.6981438542340097`*^9, 
   3.6981438715050583`*^9}, 3.6981477451484475`*^9, {3.69865713529646*^9, 
   3.6986571431793933`*^9}, {3.699117646987262*^9, 3.6991176628394623`*^9}, 
   3.6991177474212103`*^9, 3.6991203915969114`*^9, {3.69912046949925*^9, 
   3.699120477255663*^9}, {3.699193953218419*^9, 3.6991939643803377`*^9}, 
   3.710657758341159*^9, 3.710658308694503*^9, 3.7106584025188847`*^9, 
   3.710661177972689*^9, 3.710664752938596*^9}]
}, Open  ]],

Cell[TextData[{
 "Determine the coefficients for the coherence terms (which are proportional \
to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["F", "+"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["F", "-"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " respectively), for F=1 the Clebsch Gordon coefficients are all 1/sqrt(2)"
}], "Text",
 CellChangeTimes->{{3.6981436479970865`*^9, 3.698143751270294*^9}}],

Cell[TextData[{
 "\nExpress in matrix form. Create a functional form of the raising and \
lowering operators for the Hilbert space ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "F"], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "."
}], "Text",
 CellChangeTimes->{{3.698144391048918*^9, 3.698144450597582*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ladderC", " ", "=", " ", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"F", ",", "m", ",", "pm"}], "}"}], ",", " ", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"F", 
         RowBox[{"(", 
          RowBox[{"F", "+", "1"}], ")"}]}], "-", " ", 
        RowBox[{"m", " ", 
         RowBox[{"(", 
          RowBox[{"m", " ", "+", 
           RowBox[{"pm", " ", "1"}]}], ")"}]}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FpOp", " ", "=", " ", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"F", ",", "m"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Sqrt]", "2"}], ",", "0", ",", "0"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"\[Sqrt]", "2"}], ",", "0"}], " ", "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FmOp", " ", "=", " ", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"F", ",", "m"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"\[Sqrt]", "2"}], ",", "0"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"\[Sqrt]", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], " ", "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FzOp", " ", "=", " ", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<\!\(\*SuperscriptBox[\(F\), \(+\)]\)=\>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FpOp", "[", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "]"}], "]"}], ",", " ", 
    "\"\<, \!\(\*SuperscriptBox[\(F\), \(-\)]\)=\>\"", ",", " ", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FmOp", "[", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "]"}], "]"}], ",", " ", 
    "\"\<, \!\(\*SubscriptBox[\(F\), \(z\)]\)=\>\"", " ", ",", " ", 
    RowBox[{"MatrixForm", "[", "FzOp", "]"}]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<\!\(\*SubscriptBox[\(H\), \(1\)]\)=\>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FdotB", " ", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Fp", "\[Rule]", " ", 
         RowBox[{"FpOp", "[", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "]"}]}], " ", ",", " ", 
        RowBox[{"Fm", " ", "\[Rule]", " ", 
         RowBox[{"FmOp", "[", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "]"}]}], " ", ",", " ", 
        RowBox[{"Fz", "\[Rule]", " ", "FzOp"}]}], "}"}]}], "]"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.69814464125541*^9, 3.6981446678982954`*^9}, {
   3.698144756330389*^9, 3.6981449255846677`*^9}, {3.6981449747427716`*^9, 
   3.698144989200238*^9}, {3.698145037224532*^9, 3.6981451014940715`*^9}, {
   3.6981451911529207`*^9, 3.6981451974322352`*^9}, {3.6981453113210554`*^9, 
   3.6981453828039045`*^9}, {3.698145413204487*^9, 3.698145750969122*^9}, {
   3.698145792811686*^9, 3.6981457952240243`*^9}, {3.6981458333118153`*^9, 
   3.698145836035222*^9}, {3.6981459131841755`*^9, 3.698146054485976*^9}, {
   3.6981460984630713`*^9, 3.6981461006382866`*^9}, {3.698146293398076*^9, 
   3.698146316269187*^9}, {3.698146539814201*^9, 3.6981465519785724`*^9}, {
   3.6981474267379937`*^9, 3.698147427454916*^9}, {3.698147571250761*^9, 
   3.6981475738730407`*^9}, {3.6981477137563467`*^9, 3.698147742756998*^9}, 
   3.6986571257518225`*^9, {3.699117765051417*^9, 3.699117775500968*^9}, {
   3.699117837423959*^9, 3.699117881412531*^9}, {3.699117918022357*^9, 
   3.699117956201132*^9}, {3.69911798778257*^9, 3.69911799149885*^9}, {
   3.699118027128964*^9, 3.6991181346587896`*^9}, {3.699118359267784*^9, 
   3.6991183719148054`*^9}, {3.699118403012973*^9, 3.6991184647094555`*^9}, {
   3.699194001249405*^9, 3.699194017535143*^9}, {3.699194056972752*^9, 
   3.6991940586679564`*^9}}],

Cell[BoxData[
 TemplateBox[{"\"\\!\\(\\*SuperscriptBox[\\(F\\), \\(+\\)]\\)=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{"0", "0", "0"}, {
         SqrtBox["2"], "0", "0"}, {"0", 
         SqrtBox["2"], "0"}}, RowSpacings -> 1, ColumnSpacings -> 1, 
       RowAlignments -> Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
      ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]],
   "\", \\!\\(\\*SuperscriptBox[\\(F\\), \\(-\\)]\\)=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{"0", 
         SqrtBox["2"], "0"}, {"0", "0", 
         SqrtBox["2"]}, {"0", "0", "0"}}, RowSpacings -> 1, ColumnSpacings -> 
       1, RowAlignments -> Baseline, ColumnAlignments -> Center], 
      "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]],
   "\", \\!\\(\\*SubscriptBox[\\(F\\), \\(z\\)]\\)=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{
         RowBox[{"-", "1"}], "0", "0"}, {"0", "0", "0"}, {"0", "0", "1"}}, 
       RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
       ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.6991184618700066`*^9, 3.699118465199197*^9}, 
   3.6991203916069117`*^9, 3.6991204772756653`*^9, {3.6991939563895607`*^9, 
   3.69919396439736*^9}, {3.6991940052976637`*^9, 3.6991940179191294`*^9}, 
   3.6991940592865973`*^9, 3.710657758380163*^9, 3.7106583213947725`*^9, 
   3.7106584025318856`*^9, 3.7106611779846907`*^9, 3.7106647529495964`*^9}],

Cell[BoxData[
 TemplateBox[{"\"\\!\\(\\*SubscriptBox[\\(H\\), \\(1\\)]\\)=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               RowBox[{"Bx", " ", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
               RowBox[{"By", " ", 
                 RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "-", 
               RowBox[{"Bz", " ", 
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "-", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], "0"}, {
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "-", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], "0", 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "-", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}]}, {"0", 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "-", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               RowBox[{
                 RowBox[{"-", "Bx"}], " ", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
               RowBox[{"By", " ", 
                 RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
               RowBox[{"Bz", " ", 
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}]}}, 
       RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
       ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.6991184618700066`*^9, 3.699118465199197*^9}, 
   3.6991203916069117`*^9, 3.6991204772756653`*^9, {3.6991939563895607`*^9, 
   3.69919396439736*^9}, {3.6991940052976637`*^9, 3.6991940179191294`*^9}, 
   3.6991940592865973`*^9, 3.710657758380163*^9, 3.7106583213947725`*^9, 
   3.7106584025318856`*^9, 3.7106611779846907`*^9, 3.7106647529575977`*^9}]
}, Open  ]],

Cell["\<\

At the bottom of the shell, where \[Theta] -> 0\
\>", "Text",
 CellChangeTimes->{{3.698147854596798*^9, 3.698147975435675*^9}, {
  3.6991203515266314`*^9, 3.6991203668144197`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"H1", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{"FdotB", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Fp", "\[Rule]", " ", 
        RowBox[{"FpOp", "[", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "]"}]}], " ", ",", " ", 
       RowBox[{"Fm", " ", "\[Rule]", " ", 
        RowBox[{"FmOp", "[", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "]"}]}], " ", ",", " ", 
       RowBox[{"Fz", "\[Rule]", " ", "FzOp"}]}], "}"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H0", " ", "=", " ", 
   RowBox[{"(", " ", 
    RowBox[{"\[Omega]0", " ", "FzOp"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<H0=\>\"", ",", 
    RowBox[{"MatrixForm", "[", "H0", "]"}], " ", ",", "\"\<, H1=\>\"", ",", 
    RowBox[{"MatrixForm", "[", "H1", "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.698657444467405*^9, 3.6986574763473473`*^9}, {
  3.6991194363387094`*^9, 3.6991194366457424`*^9}, {3.699120371700287*^9, 
  3.6991203833369074`*^9}, {3.699161057850796*^9, 3.6991610584806004`*^9}, {
  3.6991610902445917`*^9, 3.6991612208778057`*^9}, {3.699165837790621*^9, 
  3.69916583986069*^9}, {3.7106611671058893`*^9, 3.7106611730872006`*^9}}],

Cell[BoxData[
 TemplateBox[{"\"H0=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{
         RowBox[{"-", "\[Omega]0"}], "0", "0"}, {"0", "0", "0"}, {
        "0", "0", "\[Omega]0"}}, RowSpacings -> 1, ColumnSpacings -> 1, 
       RowAlignments -> Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
      ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]],"\", H1=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               RowBox[{"Bx", " ", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
               RowBox[{"By", " ", 
                 RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "-", 
               RowBox[{"Bz", " ", 
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "-", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], "0"}, {
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "-", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], "0", 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "-", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}]}, {"0", 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "-", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               RowBox[{
                 RowBox[{"-", "Bx"}], " ", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
               RowBox[{"By", " ", 
                 RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
               RowBox[{"Bz", " ", 
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}]}}, 
       RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
       ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.698657446089698*^9, 3.6986574768506784`*^9}, 
   3.6986575161888065`*^9, {3.69911942769867*^9, 3.699119437215463*^9}, {
   3.699120384066904*^9, 3.6991203916289597`*^9}, 3.699120477285664*^9, 
   3.6991610989343915`*^9, 3.699161221327633*^9, {3.6991658402604628`*^9, 
   3.6991658558308764`*^9}, {3.699193959145607*^9, 3.6991939644234324`*^9}, 
   3.710657758400165*^9, 3.7106583326408973`*^9, 3.710658402554888*^9, {
   3.710661173747267*^9, 3.7106611780066924`*^9}, 3.7106647529705987`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Circular Polarised RF", "Section",
 CellChangeTimes->{{3.699161029842953*^9, 3.6991610307231665`*^9}, {
  3.71065866259889*^9, 3.7106586734189715`*^9}}],

Cell["\<\
We compare the general (and cumbersome) formula to that of circular polarised \
RF in the following limiting case:\
\>", "Text",
 CellChangeTimes->{{3.710658676416271*^9, 3.7106587144130707`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"circularPolarised", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"By", " ", "\[Rule]", " ", "B"}], ",", " ", 
     RowBox[{"Bx", " ", "\[Rule]", " ", "B"}], ",", " ", 
     RowBox[{"Bz", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]z", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]y", " ", "\[Rule]", " ", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7106587156821976`*^9, 3.7106587704976788`*^9}}],

Cell["\<\
Applying this substituion we find that, at the bottom of the shell:\
\>", "Text",
 CellChangeTimes->{{3.710658781290758*^9, 3.710658798856514*^9}, {
  3.7106588325538836`*^9, 3.7106588458832164`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bottomOfShell", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]", "\[Rule]", " ", "\[Pi]"}], ",", 
     RowBox[{"\[Phi]", "\[Rule]", " ", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1Circ", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H1", "+", "H0"}], ")"}], "/.", "circularPolarised"}], " ", "/.",
      " ", "bottomOfShell"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"TrigToExp", "[", "H1Circ", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7106588056481934`*^9, 3.710658813399968*^9}, {
  3.710658851612789*^9, 3.710658856492277*^9}, {3.710658900960724*^9, 
  3.7106589723388605`*^9}, {3.7106591409447193`*^9, 3.710659167913416*^9}, {
  3.7106592984804716`*^9, 3.71065930536316*^9}, {3.710659752994845*^9, 
  3.710659800781623*^9}, {3.7106598379413385`*^9, 3.7106599854785585`*^9}, {
  3.7106601782938375`*^9, 3.7106601818541937`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "\[Omega]0"}], 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "B", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "t", " ", "\[Omega]"}]], " ", "gF", 
        " ", "uB"}], 
       SqrtBox["2"]], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "B", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "t", " ", "\[Omega]"}]], " ", 
         "gF", " ", "uB"}], 
        SqrtBox["2"]]}], "0", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "B", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "t", " ", "\[Omega]"}]], " ", "gF", 
        " ", "uB"}], 
       SqrtBox["2"]]},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "B", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "t", " ", "\[Omega]"}]], " ", 
         "gF", " ", "uB"}], 
        SqrtBox["2"]]}], "\[Omega]0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.710658814225051*^9, {3.710658917275355*^9, 3.7106589728039074`*^9}, 
   3.710659168586484*^9, 3.710659801930738*^9, 3.7106598644689913`*^9, {
   3.710659959613426*^9, 3.710659986273638*^9}, 3.710660182509259*^9, 
   3.710661178156708*^9, 3.7106647529946012`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linear Polarised RF", "Section",
 CellChangeTimes->{{3.710659218686493*^9, 3.710659289142538*^9}, {
  3.710659989771988*^9, 3.7106600060926194`*^9}}],

Cell["\<\
Likewise, compare the results for linear polarised RF at a few key points.\
\>", "Text",
 CellChangeTimes->{{3.71066000800081*^9, 3.7106600522792377`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"linearPolarised", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"By", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"Bx", " ", "\[Rule]", " ", "B"}], ",", " ", 
     RowBox[{"Bz", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]z", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]y", " ", "\[Rule]", " ", "0"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7106600540464144`*^9, 3.710660078217831*^9}, {
  3.7106601170977187`*^9, 3.71066013141115*^9}}],

Cell["At the bottom of the shell:", "Text",
 CellChangeTimes->{{3.7106601411081195`*^9, 3.710660150331042*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"H1Lin", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H1", "+", "H0"}], ")"}], "/.", "linearPolarised"}], " ", "/.",
      "bottomOfShell"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "H1Lin", "]"}]}], "Input",
 CellChangeTimes->{{3.710660157555764*^9, 3.7106601642204304`*^9}, {
  3.710660214887497*^9, 3.710660262368244*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "\[Omega]0"}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B", " ", "gF", " ", "uB", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
        SqrtBox["2"]]}], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B", " ", "gF", " ", "uB", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
        SqrtBox["2"]]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B", " ", "gF", " ", "uB", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
        SqrtBox["2"]]}]},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B", " ", "gF", " ", "uB", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
        SqrtBox["2"]]}], "\[Omega]0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7106602458435917`*^9, 3.7106602628182898`*^9}, 
   3.7106611781827097`*^9, 3.7106647530096025`*^9}]
}, Open  ]],

Cell["\<\
Along the y-axis the interaction terms should equal the same as at the bottom \
of the shell, as the local field is perpendicular to the oscillating field in \
both.\
\>", "Text",
 CellChangeTimes->{{3.710664764699772*^9, 3.710664800138315*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"yaxisSide", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]", "\[Rule]", " ", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1Lin", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H1", "+", "H0"}], ")"}], "/.", "linearPolarised"}], " ", "/.",
      "yaxisSide"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "H1Lin", "]"}]}], "Input",
 CellChangeTimes->{{3.7106648070750084`*^9, 3.710664861005401*^9}, {
  3.710664913735674*^9, 3.7106649230886087`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "\[Omega]0"}], 
      FractionBox[
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
       SqrtBox["2"]], "0"},
     {
      FractionBox[
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
       SqrtBox["2"]], "0", 
      FractionBox[
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
       SqrtBox["2"]]},
     {"0", 
      FractionBox[
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
       SqrtBox["2"]], "\[Omega]0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.710664923538654*^9}]
}, Open  ]],

Cell["\<\
Along the x-axis we should see that the interaction terms vanish:\
\>", "Text",
 CellChangeTimes->{{3.7106602773347406`*^9, 3.710660322050212*^9}, {
  3.710664761264428*^9, 3.710664763936695*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sideOfShell", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]", "\[Rule]", " ", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", " ", 
     RowBox[{"\[Phi]", "\[Rule]", " ", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1Lin", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H1", "+", "H0"}], ")"}], "/.", "linearPolarised"}], " ", "/.",
      "sideOfShell"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "H1Lin", "]"}]}], "Input",
 CellChangeTimes->{{3.710660326555662*^9, 3.7106603938773937`*^9}, {
  3.71066074454712*^9, 3.7106607450201674`*^9}, {3.7106610490333357`*^9, 
  3.7106610491523476`*^9}, {3.7106611924391356`*^9, 3.7106612069275846`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "\[Omega]0"}], "+", 
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], "0", "0"},
     {"0", "0", "0"},
     {"0", "0", 
      RowBox[{"\[Omega]0", "-", 
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7106603943804445`*^9, 3.7106607114468107`*^9, 3.7106607453952045`*^9, 
   3.7106610496263947`*^9, {3.710661178194711*^9, 3.7106612075116425`*^9}, 
   3.7106647530166035`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Approximations", "Chapter",
 CellChangeTimes->{{3.710667728168255*^9, 3.710667729583397*^9}}],

Cell["\<\
Most of the time we are only interested in the potential for specific cases \
(circular, linear polarisation, points along z, etc). Which of these \
assumptions is the greatest simplification for computational speed?\
\>", "Text",
 CellChangeTimes->{{3.710667963853245*^9, 3.7106680253013887`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"H1", "+", "H0"}], ")"}], "/.", "bottomOfShell"}], "]"}]], "Input",
 CellChangeTimes->{{3.710668032043063*^9, 3.710668086969555*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "\[Omega]0"}], "+", 
       RowBox[{"Bz", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]z", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"Bx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
           SqrtBox["2"]]}], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "By", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]y", "+", 
             RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], "0"},
     {
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"Bx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
           SqrtBox["2"]]}], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "By", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]y", "+", 
             RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], "0", 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"Bx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
           SqrtBox["2"]]}], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "By", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]y", "+", 
             RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}]},
     {"0", 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"Bx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
           SqrtBox["2"]]}], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "By", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]y", "+", 
             RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], 
      RowBox[{"\[Omega]0", "-", 
       RowBox[{"Bz", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]z", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.710668087904649*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"H1", "+", "H0"}], ")"}], "/.", "linearPolarised"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.710668102990157*^9, 3.710668113971607*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "\[Omega]0"}], "+", 
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "B", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], "0"},
     {
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "B", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], "0", 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "B", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}]},
     {"0", 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "B", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], 
      RowBox[{"\[Omega]0", "-", 
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7106681155786295`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1618, 833},
WindowMargins->{{Automatic, 137}, {Automatic, 134}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 214, 3, 101, "Title"],
Cell[797, 27, 317, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[1139, 37, 1287, 32, 92, "Input"],
Cell[2429, 71, 790, 19, 31, "Output"]
}, Open  ]],
Cell[3234, 93, 414, 7, 30, "Text"],
Cell[CellGroupData[{
Cell[3673, 104, 1424, 29, 112, "Input"],
Cell[5100, 135, 1446, 31, 57, "Output"],
Cell[6549, 168, 2747, 59, 57, "Output"]
}, Open  ]],
Cell[9311, 230, 573, 16, 33, "Text"],
Cell[CellGroupData[{
Cell[9909, 250, 1151, 29, 92, "Input"],
Cell[11063, 281, 2765, 70, 82, "Output"]
}, Open  ]],
Cell[13843, 354, 479, 14, 30, "Text"],
Cell[14325, 370, 430, 13, 49, "Text"],
Cell[CellGroupData[{
Cell[14780, 387, 4761, 115, 439, "Input"],
Cell[19544, 504, 1581, 32, 69, "Output"],
Cell[21128, 538, 9333, 196, 123, "Output"]
}, Open  ]],
Cell[30476, 737, 191, 5, 49, "Text"],
Cell[CellGroupData[{
Cell[30692, 746, 1280, 30, 72, "Input"],
Cell[31975, 778, 9794, 206, 123, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41806, 989, 158, 2, 70, "Section"],
Cell[41967, 993, 206, 4, 30, "Text"],
Cell[42176, 999, 518, 11, 31, "Input"],
Cell[42697, 1012, 210, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[42932, 1020, 1017, 23, 72, "Input"],
Cell[43952, 1045, 1956, 52, 131, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[45957, 1103, 155, 2, 70, "Section"],
Cell[46115, 1107, 165, 3, 30, "Text"],
Cell[46283, 1112, 533, 11, 31, "Input"],
Cell[46819, 1125, 111, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[46955, 1130, 439, 11, 52, "Input"],
Cell[47397, 1143, 1545, 45, 119, "Output"]
}, Open  ]],
Cell[48957, 1191, 255, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[49237, 1200, 699, 18, 72, "Input"],
Cell[49939, 1220, 1357, 40, 119, "Output"]
}, Open  ]],
Cell[51311, 1263, 206, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[51542, 1271, 803, 20, 72, "Input"],
Cell[52348, 1293, 1155, 31, 71, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[53552, 1330, 99, 1, 72, "Chapter"],
Cell[53654, 1333, 308, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[53987, 1342, 216, 5, 31, "Input"],
Cell[54206, 1349, 3098, 90, 137, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57341, 1444, 221, 6, 31, "Input"],
Cell[57565, 1452, 3608, 96, 137, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)
