(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     26752,        697]
NotebookOptionsPosition[     25293,        646]
NotebookOutlinePosition[     25668,        662]
CellTagsIndexPosition[     25625,        659]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Checking parallel and perpendicular components", "Title",
 CellChangeTimes->{{3.6991184935927787`*^9, 3.699118502816848*^9}, {
  3.7106581116197977`*^9, 3.7106581122108564`*^9}, {3.7106649698332825`*^9, 
  3.710664971976497*^9}, {3.7126646356585493`*^9, 3.7126646401619997`*^9}}],

Cell["\<\
Hi Ben, I\[CloseCurlyQuote]m just checking that eqs (4) and (5) in the paper \
are correct - these correspond to the parallel and perpendicular components \
of the field. I start by writing out the classical RF field:\
\>", "Text",
 CellChangeTimes->{{3.699118514096655*^9, 3.6991185580514536`*^9}, {
  3.7106581307707124`*^9, 3.7106581474603815`*^9}, {3.712664642754259*^9, 
  3.712664692828266*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ex", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ey", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ez", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Brf", " ", "=", 
  RowBox[{
   RowBox[{"B", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"\[Omega]", " ", "t"}], "]"}], "ex"}], " ", "-", " ", 
   RowBox[{"\[Kappa]", " ", "B", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Omega]", " ", "t"}], "]"}], " ", "ey"}]}]}]}], "Input",
 CellChangeTimes->{{3.698142238961604*^9, 3.698142422777303*^9}, {
  3.698142561621646*^9, 3.6981425730231295`*^9}, {3.6991175048925743`*^9, 
  3.699117519514846*^9}, {3.699117621292633*^9, 3.6991176215528035`*^9}, {
  3.7106581030129366`*^9, 3.7106581084194775`*^9}, {3.710658160157651*^9, 
  3.7106581743350687`*^9}, {3.710658239250559*^9, 3.7106582687085047`*^9}, {
  3.7126646987988625`*^9, 3.7126647273427167`*^9}, {3.712665108663845*^9, 
  3.712665110623041*^9}}],

Cell[CellGroupData[{

Cell["Defining the transformation between frames", "Section",
 CellChangeTimes->{{3.713185607216979*^9, 3.7131856264819055`*^9}}],

Cell["\<\
Now transform the field in the lab frame to the local coordinate system.We \
first rotate through the y-axis by an angle \[Theta], then rotate through the \
x\[CloseCurlyQuote]-axis by angle \[Gamma].\
\>", "Text",
 CellChangeTimes->{{3.711867778771132*^9, 3.711867787612383*^9}, {
  3.7118735021868796`*^9, 3.711873506441*^9}, {3.711873553225787*^9, 
  3.711873554169812*^9}, {3.712664731687151*^9, 3.7126647327432566`*^9}, {
  3.712666380799046*^9, 3.7126663814551115`*^9}, {3.7131721027026625`*^9, 
  3.713172105206913*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"R1", " ", "=", " ", 
    RowBox[{"RotationMatrix", "[", 
     RowBox[{
      RowBox[{"-", "\[Theta]"}], ",", " ", "ey"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"R2", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"RotationMatrix", "[", 
        RowBox[{"\[Gamma]", ",", " ", 
         RowBox[{"R1", ".", "ex"}]}], "]"}], ",", " ", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", " ", "\[Element]", " ", "Reals"}], "}"}]}]}], 
      "]"}]}], ";"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"R2", " ", "=", "  ", 
  RowBox[{"RotationMatrix", "[", 
   RowBox[{"\[Phi]", ",", " ", "ex"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"transformM", " ", "=", " ", 
   RowBox[{"R2", ".", "R1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<Rotation Matrix=\>\"", ",", 
    RowBox[{"MatrixForm", "[", "transformM", "]"}]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BrfLocal", " ", "=", " ", 
   RowBox[{"transformM", ".", "Brf"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<B field in local coordinates=\>\"", ",", " ", 
    RowBox[{"MatrixForm", "[", "BrfLocal", "]"}]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
   "\"\<In frame X': \!\(\*SubscriptBox[\(e\), \(x\)]\)=\>\"", ",", " ", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"transformM", ".", "ex"}], "]"}], ",", 
    "\"\<, \!\(\*SubscriptBox[\(e\), \(y\)]\)=\>\"", ",", " ", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"transformM", ".", "ey"}], "]"}], ",", 
    "\"\<, \!\(\*SubscriptBox[\(e\), \(z\)]\)=\>\"", ",", " ", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"transformM", ".", "ez"}], "]"}]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
   "\"\<In frame X: \!\(\*SubscriptBox[\(e\), \(x\)]\)'=\>\"", ",", " ", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"Inverse", "[", "transformM", "]"}], ".", "ex"}], "]"}], "]"}],
     ",", "\"\<, \!\(\*SubscriptBox[\(e\), \(y\)]\)'=\>\"", ",", " ", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"Inverse", "[", "transformM", "]"}], ".", "ey"}], "]"}], "]"}],
     ",", "\"\<, \!\(\*SubscriptBox[\(e\), \(z\)]\)'=\>\"", ",", " ", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"Inverse", "[", "transformM", "]"}], ".", "ez"}], "]"}], 
     "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.698142238961604*^9, 3.698142422777303*^9}, {
   3.698142561621646*^9, 3.698142584071286*^9}, {3.698142741195299*^9, 
   3.6981428416753845`*^9}, 3.6981429801210375`*^9, {3.698143010639648*^9, 
   3.6981430293698688`*^9}, {3.6981438685991*^9, 3.698143869156577*^9}, {
   3.6981476644539127`*^9, 3.698147678319022*^9}, {3.6981479054251966`*^9, 
   3.698147910120343*^9}, {3.699117529814864*^9, 3.699117541877957*^9}, {
   3.6991932438423767`*^9, 3.6991932602784033`*^9}, {3.6991938415457377`*^9, 
   3.6991938770353007`*^9}, {3.6991939189979825`*^9, 
   3.6991939433775616`*^9}, {3.710690307708518*^9, 3.710690307875534*^9}, {
   3.710690472716302*^9, 3.710690483233353*^9}, {3.7118734979897614`*^9, 
   3.7118734981037655`*^9}, {3.711873557171897*^9, 3.7118735628240614`*^9}, {
   3.713171903364731*^9, 3.71317198676007*^9}, {3.713172234436835*^9, 
   3.713172243052696*^9}, {3.713172322704661*^9, 3.713172359011291*^9}, {
   3.7131724089472837`*^9, 3.7131725074001284`*^9}, {3.7131727342908154`*^9, 
   3.713172735325919*^9}, {3.7131727699243784`*^9, 3.7131727791412997`*^9}, {
   3.713172836559041*^9, 3.7131728464960346`*^9}, 3.7131820699062834`*^9, {
   3.713182511045393*^9, 3.713182513468635*^9}, {3.713182675316818*^9, 
   3.713182676411928*^9}, {3.713183651774454*^9, 3.713183654142691*^9}, {
   3.7131843587901487`*^9, 3.71318441850412*^9}, {3.7131844611543846`*^9, 
   3.7131844961128798`*^9}, {3.7131852757898397`*^9, 3.713185313118572*^9}, {
   3.713186296154866*^9, 3.713186324872738*^9}, {3.713186409359185*^9, 
   3.713186441481397*^9}, {3.713186517254974*^9, 3.7131865467259207`*^9}, {
   3.713187565889827*^9, 3.713187594778715*^9}, {3.7131876292021575`*^9, 
   3.713187633659603*^9}, {3.7131880195901923`*^9, 3.71318806637287*^9}, {
   3.7131881084660788`*^9, 3.71318811347258*^9}, {3.7131882210513363`*^9, 
   3.7131882235425854`*^9}, {3.7131882664088717`*^9, 3.7131882775359845`*^9}, 
   3.7131885667739053`*^9, {3.713188597502978*^9, 3.7131886090641336`*^9}, 
   3.7131886454647737`*^9}],

Cell[CellGroupData[{

Cell["\<\

Check the quantisation axis is correct\
\>", "Subsection",
 CellChangeTimes->{{3.7131853283570957`*^9, 3.713185342406501*^9}}],

Cell[TextData[{
 "Let' s check that the transformation uses the same definition of \[Theta] \
and \[Phi] as in the paper. It should follow that applying the inverse \
transformation to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "z"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " will give us a vector equal to the quantisation axis in the lab frame.\n\n\
We define the quadrupole field, and then a vector corresponding to the \
quantisation axis. We apply the inverse of the transformation matrix, to map \
the quantisation axis (z axis) in the transformed frame back to the lab \
frame. This vector should be the same as the quantisation axis vector in the \
lab frame."
}], "Text",
 CellChangeTimes->{{3.7131843536266327`*^9, 3.7131843542346935`*^9}, {
  3.7131846132705946`*^9, 3.713184709555222*^9}, {3.7131848216644316`*^9, 
  3.713184842233488*^9}, {3.713185231058367*^9, 3.7131852693481956`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BQuadField", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BQuad", " ", "x"}], ",", " ", 
     RowBox[{"BQuad", " ", "y"}], ",", " ", 
     RowBox[{
      RowBox[{"-", " ", "2"}], " ", "BQuad", " ", "z"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"QuantisationAxisVector", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"BQuadField", " ", "/", " ", 
     RowBox[{"Norm", "[", "BQuadField", "]"}]}], ",", " ", 
    RowBox[{"Assumptions", " ", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Bquad", " ", "\[Element]", " ", "Reals"}], ",", " ", 
       RowBox[{"x", "\[Element]", " ", "Reals"}], ",", " ", 
       RowBox[{"y", " ", "\[Element]", " ", "Reals"}], ",", " ", 
       RowBox[{"z", " ", "\[Element]", " ", "Reals"}], ",", " ", 
       RowBox[{"BQuad", " ", ">", " ", "0"}]}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ThetaDefinition", " ", "=", " ", 
   RowBox[{"\[Theta]", " ", "\[Rule]", " ", 
    RowBox[{"ArcCos", "[", 
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      RowBox[{"z", " ", "/", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["z", "2"]}]}], ")"}], 
        RowBox[{"1", "/", "2"}]]}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PhiDefinition", " ", "=", " ", 
   RowBox[{"\[Phi]", "\[Rule]", " ", 
    RowBox[{"ArcCos", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         RowBox[{"4", 
          SuperscriptBox["z", "2"]}]}], ")"}], 
       RowBox[{"1", "/", "2"}]], " ", "/", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["z", "2"]}]}], ")"}], 
       RowBox[{"1", "/", "2"}]]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Inverse", "[", "transformM", "]"}], ".", "ez"}], "/.", 
    RowBox[{"{", 
     RowBox[{"ThetaDefinition", ",", " ", "PhiDefinition"}], "}"}]}], ",", 
   " ", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", ">", "0"}], ",", " ", 
      RowBox[{"y", ">", "0"}], ",", " ", 
      RowBox[{"z", ">", "0"}], ",", " ", 
      RowBox[{"x", "\[Element]", "Reals"}], ",", " ", 
      RowBox[{"y", "\[Element]", "Reals"}], ",", " ", 
      RowBox[{"z", "\[Element]", "Reals"}]}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7131847347217383`*^9, 3.713184928804145*^9}, {
   3.713184961094373*^9, 3.71318521708897*^9}, {3.7131857638346395`*^9, 
   3.7131857994281983`*^9}, {3.713185965642818*^9, 3.713185993675621*^9}, {
   3.7131877123594723`*^9, 3.7131877138226185`*^9}, {3.71318778924216*^9, 
   3.7131877911783533`*^9}, {3.713187871312366*^9, 3.7131878719164267`*^9}, {
   3.713187944472681*^9, 3.7131879662828617`*^9}, {3.7131886174389715`*^9, 
   3.7131886180230293`*^9}, 3.7131886503122582`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Determining the interaction", "Section",
 CellChangeTimes->{{3.713188300828313*^9, 3.713188304357666*^9}}],

Cell[TextData[{
 "Calculate the value of \[CapitalBeta] dot \[Mu] in the local frame. We \
rewrite the operators ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["F", "x"], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["F", "y"], TraditionalForm]]],
 " in terms of the raising and lowering operators."
}], "Text",
 CellChangeTimes->{{3.698143227304467*^9, 3.698143285869618*^9}, {
  3.6981433540989633`*^9, 3.6981433567237616`*^9}, {3.6981434423145895`*^9, 
  3.6981434550272245`*^9}, {3.7126647594639287`*^9, 3.7126647603450165`*^9}, {
  3.713188296224853*^9, 3.713188298729103*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Fx", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Fp", " ", "+", " ", "Fm"}], ")"}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fy", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Fp", " ", "-", " ", "Fm"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", "\[ImaginaryI]"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fvec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"Fx", ",", " ", "Fy", ",", " ", "Fz"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FdotB", " ", "=", " ", 
  RowBox[{"gF", " ", "uB", " ", 
   RowBox[{"Dot", "[", 
    RowBox[{"Fvec", ",", " ", "BrfLocal"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.6981433578216143`*^9, 3.698143479034515*^9}, {
  3.6981435779123898`*^9, 3.6981435786483383`*^9}, {3.6981476927732215`*^9, 
  3.6981477201557407`*^9}, {3.698657076290013*^9, 3.698657089534926*^9}, {
  3.6986571407819834`*^9, 3.6986571426338816`*^9}, {3.6991176397972636`*^9, 
  3.699117662319462*^9}, {3.699117739433715*^9, 3.6991177401737156`*^9}, {
  3.6991204669787445`*^9, 3.699120468606891*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extract \[Alpha] and \[Beta] as coefficients of Exp[\[ImaginaryI] \
\[Omega] t]", "Section",
 CellChangeTimes->{{3.713188726227849*^9, 3.713188761069333*^9}, {
  3.7131905926524725`*^9, 3.7131906005572634`*^9}}],

Cell[TextData[{
 "Take the coefficient of Exp[i \[Omega] t], as per the definition of \
\[Alpha] and \[Beta] according to eq (6). From this it follows that the \
coefficient in front of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["F", "-"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " should correspond to \[Alpha], the coefficient in front of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["F", "+"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " to \[Beta]. "
}], "Text",
 CellChangeTimes->{{3.713181943387633*^9, 3.713181979523246*^9}, {
  3.71318210077637*^9, 3.713182116706963*^9}, {3.71318872303653*^9, 
  3.713188725203747*^9}, {3.7131906257517824`*^9, 3.713190687223929*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cFz", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"ExpToTrig", "[", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{
         RowBox[{"TrigToExp", "[", 
          RowBox[{"Dot", "[", 
           RowBox[{"Fvec", ",", " ", "BrfLocal"}], "]"}], "]"}], ",", 
         RowBox[{"Exp", "[", 
          RowBox[{"\[ImaginaryI]", " ", "\[Omega]", " ", "t"}], "]"}]}], 
        "]"}], ",", "Fz"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<\[Zeta] = \>\"", ",", " ", "cFz"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cFm", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"ExpToTrig", "[", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{
         RowBox[{"TrigToExp", "[", 
          RowBox[{"Dot", "[", 
           RowBox[{"Fvec", ",", " ", "BrfLocal"}], "]"}], "]"}], ",", 
         RowBox[{"Exp", "[", 
          RowBox[{"\[ImaginaryI]", " ", "\[Omega]", " ", "t"}], "]"}]}], 
        "]"}], ",", "Fm"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<\[Alpha] = \>\"", ",", " ", "cFm"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cFp", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"ExpToTrig", "[", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{
         RowBox[{"TrigToExp", "[", 
          RowBox[{"Dot", "[", 
           RowBox[{"Fvec", ",", " ", "BrfLocal"}], "]"}], "]"}], ",", 
         RowBox[{"Exp", "[", 
          RowBox[{"\[ImaginaryI]", " ", "\[Omega]", " ", "t"}], "]"}]}], 
        "]"}], ",", "Fp"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<\[Beta] = \>\"", ",", " ", "cFp"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.71317332189857*^9, 3.713173330467427*^9}, {
  3.7131827882471104`*^9, 3.713182840386324*^9}, {3.713182905445829*^9, 
  3.713182957911075*^9}, {3.713183001795463*^9, 3.713183025258809*^9}, {
  3.713183215219803*^9, 3.7131832424915304`*^9}, {3.7131888705952845`*^9, 
  3.713188889394164*^9}, {3.713188930406265*^9, 3.713188932251449*^9}, {
  3.713189585081726*^9, 3.713189599244142*^9}, {3.7131907008582926`*^9, 
  3.713190706656872*^9}}],

Cell[CellGroupData[{

Cell["Test : Do we get correct coherence terms?", "Subsection",
 CellChangeTimes->{{3.713190710404247*^9, 3.7131907257237787`*^9}}],

Cell["Take the bottom of the shell, circular polarised", "Text",
 CellChangeTimes->{{3.7131907281350193`*^9, 3.7131907480750136`*^9}, {
  3.713190857670972*^9, 3.713190865158721*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"circBottomOfShell", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Phi]", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Theta]", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Kappa]", "\[Rule]", " ", "1"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7131907489471006`*^9, 3.7131907596511707`*^9}, {
   3.713190869632168*^9, 3.713190879840189*^9}, 3.713191530109209*^9}],

Cell["In this limit we get definitions of \[Alpha], \[Beta] of", "Text",
 CellChangeTimes->{{3.7131907666138673`*^9, 3.7131907822844343`*^9}}],

Cell[BoxData[{
 RowBox[{"\[Alpha]Def", " ", "=", " ", 
  RowBox[{"cFm", "/.", "circBottomOfShell"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Beta]Def", " ", "=", " ", 
  RowBox[{"cFp", "/.", "circBottomOfShell"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Zeta]Def", " ", "=", " ", 
  RowBox[{"cFz", "/.", "circBottomOfShell"}]}]}], "Input",
 CellChangeTimes->{{3.71319078384459*^9, 3.713190874815686*^9}, {
  3.713191626562854*^9, 3.713191638015999*^9}}],

Cell[TextData[{
 "Check to see if this gives coherence terms that are correct. We use the \
basis ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["m", "F"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "={-1,0,1}. The Sqrt[2] comes from the Clebsch-Gordon factors for an F=1 \
system."
}], "Text",
 CellChangeTimes->{{3.713190885431748*^9, 3.7131909027514796`*^9}, {
  3.713191726915888*^9, 3.7131917423094273`*^9}, {3.7131918519613914`*^9, 
  3.7131918680339985`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FzMatrix", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<\!\(\*SubscriptBox[\(F\), \(z\)]\)=\>\"", ",", " ", 
    RowBox[{"MatrixForm", "[", "FzMatrix", "]"}]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FpMatrix", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "0", ",", " ", "1"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], " ", 
    RowBox[{"Sqrt", "[", "2", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<\!\(\*SubscriptBox[\(F\), \(-\)]\)=\>\"", ",", " ", 
    RowBox[{"MatrixForm", "[", "FpMatrix", "]"}]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FmMatrix", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], " ", 
    RowBox[{"Sqrt", "[", "2", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<\!\(\*SubscriptBox[\(F\), \(+\)]\)=\>\"", ",", " ", 
    RowBox[{"MatrixForm", "[", "FmMatrix", "]"}]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hint", " ", "=", " ", 
   RowBox[{
    RowBox[{"\[Mu]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]Def", " ", "FmMatrix"}], "+", 
       RowBox[{"\[Beta]Def", " ", "FpMatrix"}], " ", "+", " ", 
       RowBox[{"\[Zeta]Def", " ", "FzMatrix"}]}], ")"}], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{"\[ImaginaryI]", " ", "\[Omega]", " ", "t"}], "]"}]}], " ", "+",
     " ", 
    RowBox[{"\[Mu]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Conjugate", "@", "\[Alpha]Def"}], " ", "FpMatrix"}], "+", 
       RowBox[{
        RowBox[{"Conjugate", "@", "\[Beta]Def"}], " ", "FmMatrix"}], "+", " ", 
       RowBox[{
        RowBox[{"Conjugate", "@", "\[Zeta]Def"}], " ", "FzMatrix"}]}], ")"}], 
     " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]", " ", "t"}], 
      "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hint", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Hint", ",", " ", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"B", "\[Element]", "Reals"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hatom", " ", "=", " ", 
   RowBox[{"FzMatrix", " ", "\[Omega]0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<\!\(\*SubscriptBox[\(H\), \(int\)]\)=\>\"", ",", " ", 
    RowBox[{"MatrixForm", "[", "Hint", "]"}], ",", " ", "\"\<; H=\>\"", ",", 
    " ", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Hatom", " ", "+", " ", "Hint"}], "]"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7131909091511197`*^9, 3.713191045927796*^9}, {
   3.713191091426345*^9, 3.713191140715274*^9}, {3.7131915472049184`*^9, 
   3.7131916133605337`*^9}, {3.71319164512971*^9, 3.713191707283925*^9}, {
   3.71319175783998*^9, 3.7131918397451696`*^9}, 3.7131918851277075`*^9, {
   3.7131919214623404`*^9, 3.7131919761448083`*^9}}],

Cell["\<\
Transform into rotating frame, take rotating wave approximation and solve for \
eigenvalues.\
\>", "Text",
 CellChangeTimes->{{3.7131919102732215`*^9, 3.7131919179809923`*^9}, {
  3.713191983503544*^9, 3.713192009521146*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"trans", " ", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Exp", "[", 
     RowBox[{"\[ImaginaryI]", " ", "\[Omega]", " ", 
      RowBox[{"Diagonal", "[", "FzMatrix", "]"}], "t"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<Transformation matrix to rotating frame: \>\"", ",", "  ", 
    RowBox[{"MatrixForm", "[", "trans", "]"}]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hrot", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"trans", ".", 
      RowBox[{"(", 
       RowBox[{"Hatom", "+", "Hint"}], ")"}], ".", 
      RowBox[{"Inverse", "[", "trans", "]"}]}], ",", " ", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t", " ", "\[Element]", "Reals"}], ",", " ", 
        RowBox[{"\[Omega]", " ", "\[Element]", " ", "Reals"}]}], "}"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
   "\"\<Hamiltonian in Rotating wave approximation, \!\(\*SubscriptBox[\(H\), \
\(rot\)]\)=\>\"", ",", " ", 
    RowBox[{"MatrixForm", "[", "Hrot", "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7131909803602395`*^9, 3.713190982004404*^9}, {
  3.713192056802873*^9, 3.7131922393961306`*^9}, {3.7131922713883295`*^9, 
  3.7131924989590845`*^9}, {3.713192791835369*^9, 3.7131930084700303`*^9}, {
  3.713193075048688*^9, 3.713193142137396*^9}}],

Cell["\<\
Last, but by no means least, extract the eigenvalues of the rotating wave \
approximation\
\>", "Text",
 CellChangeTimes->{{3.713193144888671*^9, 3.713193163922574*^9}}],

Cell[BoxData[
 RowBox[{"Eigenvalues", "[", "Hrot", "]"}]], "Input",
 CellChangeTimes->{{3.7131931671658983`*^9, 3.713193173612543*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{980, 919},
WindowMargins->{{-996, Automatic}, {-165, Automatic}},
Magnification:>0.9 Inherited,
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 285, 3, 91, "Title"],
Cell[868, 27, 411, 7, 47, "Text"],
Cell[1282, 36, 1187, 27, 90, "Input"],
Cell[CellGroupData[{
Cell[2494, 67, 129, 1, 61, "Section"],
Cell[2626, 70, 537, 9, 47, "Text"],
Cell[3166, 81, 4764, 98, 230, "Input"],
Cell[CellGroupData[{
Cell[7955, 183, 137, 4, 73, "Subsection"],
Cell[8095, 189, 921, 17, 122, "Text"],
Cell[9019, 208, 3181, 81, 157, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12249, 295, 112, 1, 61, "Section"],
Cell[12364, 298, 606, 15, 31, "Text"],
Cell[12973, 315, 1151, 29, 90, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14161, 349, 217, 3, 61, "Section"],
Cell[14381, 354, 704, 17, 47, "Text"],
Cell[15088, 373, 2459, 63, 130, "Input"],
Cell[CellGroupData[{
Cell[17572, 440, 131, 1, 45, "Subsection"],
Cell[17706, 443, 183, 2, 28, "Text"],
Cell[17892, 447, 434, 9, 29, "Input"],
Cell[18329, 458, 142, 1, 28, "Text"],
Cell[18474, 461, 449, 8, 70, "Input"],
Cell[18926, 471, 475, 12, 47, "Text"],
Cell[19404, 485, 3796, 101, 230, "Input"],
Cell[23203, 588, 235, 5, 28, "Text"],
Cell[23441, 595, 1492, 36, 90, "Input"],
Cell[24936, 633, 179, 4, 28, "Text"],
Cell[25118, 639, 135, 2, 29, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)
 3.6981434550272245`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Fx", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Fp", " ", "+", " ", "Fm"}], ")"}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fy", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Fp", " ", "-", " ", "Fm"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", "\[ImaginaryI]"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fvec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"Fx", ",", " ", "Fy", ",", " ", "Fz"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FdotB", " ", "=", " ", 
  RowBox[{"gF", " ", "uB", " ", 
   RowBox[{"Dot", "[", 
    RowBox[{"Fvec", ",", " ", "BrfLocal"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.6981433578216143`*^9, 3.698143479034515*^9}, {
  3.6981435779123898`*^9, 3.6981435786483383`*^9}, {3.6981476927732215`*^9, 
  3.6981477201557407`*^9}, {3.698657076290013*^9, 3.698657089534926*^9}, {
  3.6986571407819834`*^9, 3.6986571426338816`*^9}, {3.6991176397972636`*^9, 
  3.699117662319462*^9}, {3.699117739433715*^9, 3.6991177401737156`*^9}, {
  3.6991204669787445`*^9, 3.699120468606891*^9}}],

Cell[BoxData[
 RowBox[{"gF", " ", "uB", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Fz", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "Bx"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
       RowBox[{"Bz", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]z", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"Fm", "+", "Fp"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Bx", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
       RowBox[{"By", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]y", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
       RowBox[{"Bz", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]z", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "Fm"}], "+", "Fp"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Bx", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
       RowBox[{"By", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]y", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
       RowBox[{"Bz", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]z", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.698143481932017*^9, 3.6981435799247155`*^9, {3.6981438542340097`*^9, 
   3.6981438715050583`*^9}, 3.6981477451484475`*^9, {3.69865713529646*^9, 
   3.6986571431793933`*^9}, {3.699117646987262*^9, 3.6991176628394623`*^9}, 
   3.6991177474212103`*^9, 3.6991203915969114`*^9, {3.69912046949925*^9, 
   3.699120477255663*^9}, {3.699193953218419*^9, 3.6991939643803377`*^9}, 
   3.710657758341159*^9, 3.710658308694503*^9, 3.7106584025188847`*^9, 
   3.710661177972689*^9, 3.710664752938596*^9, 3.7106903663946705`*^9, {
   3.710690460550085*^9, 3.710690487459776*^9}}]
}, Open  ]],

Cell[TextData[{
 "Determine the coefficients for the coherence terms (which are proportional \
to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["F", "+"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["F", "-"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " respectively), for F=1 the Clebsch Gordon coefficients are all 1/sqrt(2)"
}], "Text",
 CellChangeTimes->{{3.6981436479970865`*^9, 3.698143751270294*^9}}],

Cell[TextData[{
 "\nExpress in matrix form. Create a functional form of the raising and \
lowering operators for the Hilbert space ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "F"], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "."
}], "Text",
 CellChangeTimes->{{3.698144391048918*^9, 3.698144450597582*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ladderC", " ", "=", " ", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"F", ",", "m", ",", "pm"}], "}"}], ",", " ", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"F", 
         RowBox[{"(", 
          RowBox[{"F", "+", "1"}], ")"}]}], "-", " ", 
        RowBox[{"m", " ", 
         RowBox[{"(", 
          RowBox[{"m", " ", "+", 
           RowBox[{"pm", " ", "1"}]}], ")"}]}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FpOp", " ", "=", " ", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"F", ",", "m"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Sqrt]", "2"}], ",", "0", ",", "0"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"\[Sqrt]", "2"}], ",", "0"}], " ", "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FmOp", " ", "=", " ", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"F", ",", "m"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"\[Sqrt]", "2"}], ",", "0"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"\[Sqrt]", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], " ", "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FzOp", " ", "=", " ", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<\!\(\*SuperscriptBox[\(F\), \(+\)]\)=\>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FpOp", "[", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "]"}], "]"}], ",", " ", 
    "\"\<, \!\(\*SuperscriptBox[\(F\), \(-\)]\)=\>\"", ",", " ", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FmOp", "[", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "]"}], "]"}], ",", " ", 
    "\"\<, \!\(\*SubscriptBox[\(F\), \(z\)]\)=\>\"", " ", ",", " ", 
    RowBox[{"MatrixForm", "[", "FzOp", "]"}]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<\!\(\*SubscriptBox[\(H\), \(1\)]\)=\>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FdotB", " ", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Fp", "\[Rule]", " ", 
         RowBox[{"FpOp", "[", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "]"}]}], " ", ",", " ", 
        RowBox[{"Fm", " ", "\[Rule]", " ", 
         RowBox[{"FmOp", "[", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "]"}]}], " ", ",", " ", 
        RowBox[{"Fz", "\[Rule]", " ", "FzOp"}]}], "}"}]}], "]"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.69814464125541*^9, 3.6981446678982954`*^9}, {
   3.698144756330389*^9, 3.6981449255846677`*^9}, {3.6981449747427716`*^9, 
   3.698144989200238*^9}, {3.698145037224532*^9, 3.6981451014940715`*^9}, {
   3.6981451911529207`*^9, 3.6981451974322352`*^9}, {3.6981453113210554`*^9, 
   3.6981453828039045`*^9}, {3.698145413204487*^9, 3.698145750969122*^9}, {
   3.698145792811686*^9, 3.6981457952240243`*^9}, {3.6981458333118153`*^9, 
   3.698145836035222*^9}, {3.6981459131841755`*^9, 3.698146054485976*^9}, {
   3.6981460984630713`*^9, 3.6981461006382866`*^9}, {3.698146293398076*^9, 
   3.698146316269187*^9}, {3.698146539814201*^9, 3.6981465519785724`*^9}, {
   3.6981474267379937`*^9, 3.698147427454916*^9}, {3.698147571250761*^9, 
   3.6981475738730407`*^9}, {3.6981477137563467`*^9, 3.698147742756998*^9}, 
   3.6986571257518225`*^9, {3.699117765051417*^9, 3.699117775500968*^9}, {
   3.699117837423959*^9, 3.699117881412531*^9}, {3.699117918022357*^9, 
   3.699117956201132*^9}, {3.69911798778257*^9, 3.69911799149885*^9}, {
   3.699118027128964*^9, 3.6991181346587896`*^9}, {3.699118359267784*^9, 
   3.6991183719148054`*^9}, {3.699118403012973*^9, 3.6991184647094555`*^9}, {
   3.699194001249405*^9, 3.699194017535143*^9}, {3.699194056972752*^9, 
   3.6991940586679564`*^9}, {3.7106886160301466`*^9, 3.7106886166362076`*^9}}],

Cell[BoxData[
 TemplateBox[{"\"\\!\\(\\*SuperscriptBox[\\(F\\), \\(+\\)]\\)=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{"0", "0", "0"}, {
         SqrtBox["2"], "0", "0"}, {"0", 
         SqrtBox["2"], "0"}}, RowSpacings -> 1, ColumnSpacings -> 1, 
       RowAlignments -> Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
      ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]],
   "\", \\!\\(\\*SuperscriptBox[\\(F\\), \\(-\\)]\\)=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{"0", 
         SqrtBox["2"], "0"}, {"0", "0", 
         SqrtBox["2"]}, {"0", "0", "0"}}, RowSpacings -> 1, ColumnSpacings -> 
       1, RowAlignments -> Baseline, ColumnAlignments -> Center], 
      "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]],
   "\", \\!\\(\\*SubscriptBox[\\(F\\), \\(z\\)]\\)=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{
         RowBox[{"-", "1"}], "0", "0"}, {"0", "0", "0"}, {"0", "0", "1"}}, 
       RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
       ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.6991184618700066`*^9, 3.699118465199197*^9}, 
   3.6991203916069117`*^9, 3.6991204772756653`*^9, {3.6991939563895607`*^9, 
   3.69919396439736*^9}, {3.6991940052976637`*^9, 3.6991940179191294`*^9}, 
   3.6991940592865973`*^9, 3.710657758380163*^9, 3.7106583213947725`*^9, 
   3.7106584025318856`*^9, 3.7106611779846907`*^9, 3.7106647529495964`*^9, 
   3.710690366409672*^9, {3.7106904605610857`*^9, 3.710690487475777*^9}}],

Cell[BoxData[
 TemplateBox[{"\"\\!\\(\\*SubscriptBox[\\(H\\), \\(1\\)]\\)=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               RowBox[{"Bx", " ", 
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
               RowBox[{"Bz", " ", 
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
                  RowBox[{"By", " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], "0"}, {
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
                  RowBox[{"By", " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], "0", 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
                  RowBox[{"By", " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}]}, {"0", 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
                  RowBox[{"By", " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               RowBox[{
                 RowBox[{"-", "Bx"}], " ", 
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
               RowBox[{"Bz", " ", 
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}]}}, 
       RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
       ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.6991184618700066`*^9, 3.699118465199197*^9}, 
   3.6991203916069117`*^9, 3.6991204772756653`*^9, {3.6991939563895607`*^9, 
   3.69919396439736*^9}, {3.6991940052976637`*^9, 3.6991940179191294`*^9}, 
   3.6991940592865973`*^9, 3.710657758380163*^9, 3.7106583213947725`*^9, 
   3.7106584025318856`*^9, 3.7106611779846907`*^9, 3.7106647529495964`*^9, 
   3.710690366409672*^9, {3.7106904605610857`*^9, 3.710690487481778*^9}}]
}, Open  ]],

Cell["\<\

At the bottom of the shell, where \[Theta] -> 0\
\>", "Text",
 CellChangeTimes->{{3.698147854596798*^9, 3.698147975435675*^9}, {
  3.6991203515266314`*^9, 3.6991203668144197`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"H1", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{"FdotB", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Fp", "\[Rule]", " ", 
        RowBox[{"FpOp", "[", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "]"}]}], " ", ",", " ", 
       RowBox[{"Fm", " ", "\[Rule]", " ", 
        RowBox[{"FmOp", "[", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "]"}]}], " ", ",", " ", 
       RowBox[{"Fz", "\[Rule]", " ", "FzOp"}]}], "}"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H0", " ", "=", " ", 
   RowBox[{"(", " ", 
    RowBox[{"\[Omega]0", " ", "FzOp"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<H0=\>\"", ",", 
    RowBox[{"MatrixForm", "[", "H0", "]"}], " ", ",", "\"\<, H1=\>\"", ",", 
    RowBox[{"MatrixForm", "[", "H1", "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.698657444467405*^9, 3.6986574763473473`*^9}, {
  3.6991194363387094`*^9, 3.6991194366457424`*^9}, {3.699120371700287*^9, 
  3.6991203833369074`*^9}, {3.699161057850796*^9, 3.6991610584806004`*^9}, {
  3.6991610902445917`*^9, 3.6991612208778057`*^9}, {3.699165837790621*^9, 
  3.69916583986069*^9}, {3.7106611671058893`*^9, 3.7106611730872006`*^9}}],

Cell[BoxData[
 TemplateBox[{"\"H0=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{
         RowBox[{"-", "\[Omega]0"}], "0", "0"}, {"0", "0", "0"}, {
        "0", "0", "\[Omega]0"}}, RowSpacings -> 1, ColumnSpacings -> 1, 
       RowAlignments -> Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
      ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]],"\", H1=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               RowBox[{"Bx", " ", 
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
               RowBox[{"Bz", " ", 
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
                  RowBox[{"By", " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], "0"}, {
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
                  RowBox[{"By", " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], "0", 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
                  RowBox[{"By", " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}]}, {"0", 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
                  RowBox[{"By", " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               RowBox[{
                 RowBox[{"-", "Bx"}], " ", 
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
               RowBox[{"Bz", " ", 
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}]}}, 
       RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
       ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.698657446089698*^9, 3.6986574768506784`*^9}, 
   3.6986575161888065`*^9, {3.69911942769867*^9, 3.699119437215463*^9}, {
   3.699120384066904*^9, 3.6991203916289597`*^9}, 3.699120477285664*^9, 
   3.6991610989343915`*^9, 3.699161221327633*^9, {3.6991658402604628`*^9, 
   3.6991658558308764`*^9}, {3.699193959145607*^9, 3.6991939644234324`*^9}, 
   3.710657758400165*^9, 3.7106583326408973`*^9, 3.710658402554888*^9, {
   3.710661173747267*^9, 3.7106611780066924`*^9}, 3.7106647529705987`*^9, 
   3.7106903664366746`*^9, {3.710690460589089*^9, 3.7106904874987793`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Circular Polarised RF", "Section",
 CellChangeTimes->{{3.699161029842953*^9, 3.6991610307231665`*^9}, {
  3.71065866259889*^9, 3.7106586734189715`*^9}}],

Cell["\<\
We compare the general (and cumbersome) formula to that of circular polarised \
RF in the following limiting case:\
\>", "Text",
 CellChangeTimes->{{3.710658676416271*^9, 3.7106587144130707`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"circularPolarised", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"By", " ", "\[Rule]", " ", "B"}], ",", " ", 
     RowBox[{"Bx", " ", "\[Rule]", " ", "B"}], ",", " ", 
     RowBox[{"Bz", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]z", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]y", " ", "\[Rule]", " ", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7106587156821976`*^9, 3.7106587704976788`*^9}}],

Cell["\<\
Applying this substituion we find that, at the bottom of the shell:\
\>", "Text",
 CellChangeTimes->{{3.710658781290758*^9, 3.710658798856514*^9}, {
  3.7106588325538836`*^9, 3.7106588458832164`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bottomOfShell", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]", "\[Rule]", " ", "\[Pi]"}], ",", " ", 
     RowBox[{"\[Phi]", " ", "\[Rule]", " ", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1Circ", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H1", "+", "H0"}], ")"}], "/.", "circularPolarised"}], " ", "/.",
      " ", "bottomOfShell"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"TrigToExp", "[", "H1Circ", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7106588056481934`*^9, 3.710658813399968*^9}, {
  3.710658851612789*^9, 3.710658856492277*^9}, {3.710658900960724*^9, 
  3.7106589723388605`*^9}, {3.7106591409447193`*^9, 3.710659167913416*^9}, {
  3.7106592984804716`*^9, 3.71065930536316*^9}, {3.710659752994845*^9, 
  3.710659800781623*^9}, {3.7106598379413385`*^9, 3.7106599854785585`*^9}, {
  3.7106601782938375`*^9, 3.7106601818541937`*^9}, {3.7106905959996285`*^9, 
  3.7106905961346416`*^9}, {3.7106910334734945`*^9, 3.7106910464577923`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "\[Omega]0"}], 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "B", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "t", " ", "\[Omega]"}]], " ", "gF", 
        " ", "uB"}], 
       SqrtBox["2"]], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "B", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "t", " ", "\[Omega]"}]], " ", 
         "gF", " ", "uB"}], 
        SqrtBox["2"]]}], "0", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "B", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "t", " ", "\[Omega]"}]], " ", "gF", 
        " ", "uB"}], 
       SqrtBox["2"]]},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "B", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "t", " ", "\[Omega]"}]], " ", 
         "gF", " ", "uB"}], 
        SqrtBox["2"]]}], "\[Omega]0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.710658814225051*^9, {3.710658917275355*^9, 3.7106589728039074`*^9}, 
   3.710659168586484*^9, 3.710659801930738*^9, 3.7106598644689913`*^9, {
   3.710659959613426*^9, 3.710659986273638*^9}, 3.710660182509259*^9, 
   3.710661178156708*^9, 3.7106647529946012`*^9, 3.7106903664636774`*^9, {
   3.7106904013791685`*^9, 3.7106904070097313`*^9}, {3.7106904606150913`*^9, 
   3.7106904875257826`*^9}, 3.7106905968497133`*^9, {3.7106910383459816`*^9, 
   3.7106910570208488`*^9}},
 FontSize->18]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linear Polarised RF", "Section",
 CellChangeTimes->{{3.710659218686493*^9, 3.710659289142538*^9}, {
  3.710659989771988*^9, 3.7106600060926194`*^9}}],

Cell["\<\
Likewise, compare the results for linear polarised RF at a few key points.\
\>", "Text",
 CellChangeTimes->{{3.71066000800081*^9, 3.7106600522792377`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"linearPolarised", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"By", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"Bx", " ", "\[Rule]", " ", "B"}], ",", " ", 
     RowBox[{"Bz", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]z", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]y", " ", "\[Rule]", " ", "0"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7106600540464144`*^9, 3.710660078217831*^9}, {
  3.7106601170977187`*^9, 3.71066013141115*^9}}],

Cell["At the bottom of the shell:", "Text",
 CellChangeTimes->{{3.7106601411081195`*^9, 3.710660150331042*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"H1Lin", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H1", "+", "H0"}], ")"}], "/.", "linearPolarised"}], " ", "/.",
      "bottomOfShell"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "H1Lin", "]"}]}], "Input",
 CellChangeTimes->{{3.710660157555764*^9, 3.7106601642204304`*^9}, {
  3.710660214887497*^9, 3.710660262368244*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "\[Omega]0"}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B", " ", "gF", " ", "uB", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
        SqrtBox["2"]]}], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B", " ", "gF", " ", "uB", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
        SqrtBox["2"]]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B", " ", "gF", " ", "uB", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
        SqrtBox["2"]]}]},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B", " ", "gF", " ", "uB", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
        SqrtBox["2"]]}], "\[Omega]0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7106602458435917`*^9, 3.7106602628182898`*^9}, 
   3.7106611781827097`*^9, 3.7106647530096025`*^9, 3.7106903664896803`*^9, {
   3.7106904606390944`*^9, 3.7106904875477843`*^9}, 3.710690641339162*^9, 
   3.7106910595721035`*^9},
 FontSize->18]
}, Open  ]],

Cell["\<\
Along the y-axis the interaction terms should equal the same as at the bottom \
of the shell, as the local field is perpendicular to the oscillating field in \
both.\
\>", "Text",
 CellChangeTimes->{{3.710664764699772*^9, 3.710664800138315*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"yaxisSide", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]", " ", "\[Rule]", "0"}], ",", " ", 
     RowBox[{"\[Phi]", "\[Rule]", " ", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1Lin", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H1", "+", "H0"}], ")"}], "/.", "linearPolarised"}], " ", "/.",
      "yaxisSide"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "H1Lin", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<Local B field = \>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{
      RowBox[{"BrfLocal", "/.", "yaxisSide"}], "/.", "linearPolarised"}], 
     "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7106648070750084`*^9, 3.710664861005401*^9}, {
  3.710664913735674*^9, 3.7106649230886087`*^9}, {3.710690349463978*^9, 
  3.710690351420173*^9}, {3.710691081188265*^9, 3.710691107366883*^9}, {
  3.710691262965371*^9, 3.710691293726447*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "\[Omega]0"}], 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
       SqrtBox["2"]], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "B", " ", "gF", " ", "uB", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
        SqrtBox["2"]]}], "0", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
       SqrtBox["2"]]},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "B", " ", "gF", " ", "uB", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
        SqrtBox["2"]]}], "\[Omega]0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.710664923538654*^9, 3.710690366517683*^9, {3.7106904606560955`*^9, 
   3.7106904875707865`*^9}, {3.710691065344681*^9, 3.710691108222968*^9}, {
   3.7106912634604206`*^9, 3.7106913006751413`*^9}},
 FontSize->16],

Cell[BoxData[
 TemplateBox[{"\"Local B field = \"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      TagBox[
       GridBox[{{"0"}, {
          RowBox[{"B", " ", 
            RowBox[{"Sin", "[", 
              RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}, {"0"}}, RowSpacings -> 
        1, ColumnAlignments -> Center, ColumnAlignments -> Left], Column], 
      "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]},
  "RowDefault"]], "Output",
 CellChangeTimes->{
  3.710664923538654*^9, 3.710690366517683*^9, {3.7106904606560955`*^9, 
   3.7106904875707865`*^9}, {3.710691065344681*^9, 3.710691108222968*^9}, {
   3.7106912634604206`*^9, 3.7106913006811423`*^9}},
 FontSize->16]
}, Open  ]],

Cell["\<\
Along the x-axis we should see that the interaction terms vanish:\
\>", "Text",
 CellChangeTimes->{{3.7106602773347406`*^9, 3.710660322050212*^9}, {
  3.710664761264428*^9, 3.710664763936695*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sideOfShell", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]", "\[Rule]", " ", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", " ", 
     RowBox[{"\[Phi]", "\[Rule]", " ", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1Lin", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H1", "+", "H0"}], ")"}], "/.", "linearPolarised"}], " ", "/.",
      "sideOfShell"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "H1Lin", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<Local B field = \>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{
      RowBox[{"BrfLocal", "/.", "sideOfShell"}], "/.", "linearPolarised"}], 
     "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.710660326555662*^9, 3.7106603938773937`*^9}, {
  3.71066074454712*^9, 3.7106607450201674`*^9}, {3.7106610490333357`*^9, 
  3.7106610491523476`*^9}, {3.7106611924391356`*^9, 3.7106612069275846`*^9}, {
  3.71069050820285*^9, 3.7106905422522545`*^9}, {3.710691126319778*^9, 
  3.7106911608971653`*^9}, {3.710691297829857*^9, 3.71069131036111*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "\[Omega]0"}], "+", 
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], "0", "0"},
     {"0", "0", "0"},
     {"0", "0", 
      RowBox[{"\[Omega]0", "-", 
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7106603943804445`*^9, 3.7106607114468107`*^9, 3.7106607453952045`*^9, 
   3.7106610496263947`*^9, {3.710661178194711*^9, 3.7106612075116425`*^9}, 
   3.7106647530166035`*^9, 3.7106903665336847`*^9, {3.7106904606710973`*^9, 
   3.7106905515131807`*^9}, 3.7106911620272784`*^9, {3.710691302791353*^9, 
   3.710691310897164*^9}},
 FontSize->14],

Cell[BoxData[
 TemplateBox[{"\"Local B field = \"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      TagBox[
       GridBox[{{"0"}, {"0"}, {
          RowBox[{
            RowBox[{"-", "B"}], " ", 
            RowBox[{"Sin", "[", 
              RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}}, RowSpacings -> 1, 
        ColumnAlignments -> Center, ColumnAlignments -> Left], Column], 
      "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]},
  "RowDefault"]], "Output",
 CellChangeTimes->{
  3.7106603943804445`*^9, 3.7106607114468107`*^9, 3.7106607453952045`*^9, 
   3.7106610496263947`*^9, {3.710661178194711*^9, 3.7106612075116425`*^9}, 
   3.7106647530166035`*^9, 3.7106903665336847`*^9, {3.7106904606710973`*^9, 
   3.7106905515131807`*^9}, 3.7106911620272784`*^9, {3.710691302791353*^9, 
   3.7106913109031644`*^9}},
 FontSize->14]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Approximations", "Chapter",
 CellChangeTimes->{{3.710667728168255*^9, 3.710667729583397*^9}}],

Cell["\<\
Most of the time we are only interested in the potential for specific cases \
(circular, linear polarisation, points along z, etc). Which of these \
assumptions is the greatest simplification for computational speed?\
\>", "Text",
 CellChangeTimes->{{3.710667963853245*^9, 3.7106680253013887`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"H1", "+", "H0"}], ")"}], "/.", "bottomOfShell"}], "]"}]], "Input",
 CellChangeTimes->{{3.710668032043063*^9, 3.710668086969555*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "\[Omega]0"}], "+", 
       RowBox[{"Bz", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]z", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"Bx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
           SqrtBox["2"]]}], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "By", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]y", "+", 
             RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], "0"},
     {
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"Bx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
           SqrtBox["2"]]}], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "By", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]y", "+", 
             RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], "0", 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"Bx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
           SqrtBox["2"]]}], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "By", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]y", "+", 
             RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}]},
     {"0", 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"Bx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
           SqrtBox["2"]]}], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "By", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]y", "+", 
             RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], 
      RowBox[{"\[Omega]0", "-", 
       RowBox[{"Bz", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]z", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.710668087904649*^9, 3.710690366550686*^9, {3.7106904606870985`*^9, 
   3.7106904876037903`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"H1", "+", "H0"}], ")"}], "/.", "linearPolarised"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.710668102990157*^9, 3.710668113971607*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "\[Omega]0"}], "+", 
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], "0"},
     {
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], "0", 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}]},
     {"0", 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], 
      RowBox[{"\[Omega]0", "-", 
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7106681155786295`*^9, 3.7106903665676875`*^9, {3.7106904607051*^9, 
   3.7106904876237917`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"H1", "+", "H0"}], ")"}], "/.", "circularPolarised"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7106681734053144`*^9, 3.710668175236497*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "\[Omega]0"}], "+", 
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", "B"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
           RowBox[{"B", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], 
          SqrtBox["2"]], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"B", " ", 
              RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
             RowBox[{"B", " ", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], ")"}]}], 
          SqrtBox["2"]]}], ")"}]}], "0"},
     {
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", "B"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
           RowBox[{"B", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], 
          SqrtBox["2"]], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"B", " ", 
              RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
             RowBox[{"B", " ", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], ")"}]}], 
          SqrtBox["2"]]}], ")"}]}], "0", 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", "B"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
           RowBox[{"B", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], 
          SqrtBox["2"]], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"B", " ", 
              RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
             RowBox[{"B", " ", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], ")"}]}], 
          SqrtBox["2"]]}], ")"}]}]},
     {"0", 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", "B"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
           RowBox[{"B", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], 
          SqrtBox["2"]], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"B", " ", 
              RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
             RowBox[{"B", " ", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], ")"}]}], 
          SqrtBox["2"]]}], ")"}]}], 
      RowBox[{"\[Omega]0", "-", 
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.710668175724546*^9, 3.710690366580689*^9, {3.7106904607231026`*^9, 
   3.710690487641794*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1618, 833},
WindowMargins->{{53, Automatic}, {134, Automatic}},
Magnification:>0.9 Inherited,
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 214, 3, 91, "Title"],
Cell[797, 27, 317, 6, 28, "Text"],
Cell[CellGroupData[{
Cell[1139, 37, 1287, 32, 90, "Input"],
Cell[2429, 71, 866, 20, 28, "Output"]
}, Open  ]],
Cell[3310, 94, 465, 8, 28, "Text"],
Cell[CellGroupData[{
Cell[3800, 106, 1524, 31, 110, "Input"],
Cell[5327, 139, 1516, 32, 55, "Output"],
Cell[6846, 173, 2817, 60, 55, "Output"]
}, Open  ]],
Cell[9678, 236, 507, 14, 31, "Text"],
Cell[CellGroupData[{
Cell[10210, 254, 1151, 29, 90, "Input"],
Cell[11364, 285, 2839, 71, 79, "Output"]
}, Open  ]],
Cell[14218, 359, 479, 14, 28, "Text"],
Cell[14700, 375, 430, 13, 47, "Text"],
Cell[CellGroupData[{
Cell[15155, 392, 4811, 115, 437, "Input"],
Cell[19969, 509, 1655, 33, 67, "Output"],
Cell[21627, 544, 10203, 211, 91, "Output"]
}, Open  ]],
Cell[31845, 758, 191, 5, 47, "Text"],
Cell[CellGroupData[{
Cell[32061, 767, 1280, 30, 70, "Input"],
Cell[33344, 799, 10666, 221, 91, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44047, 1025, 158, 2, 61, "Section"],
Cell[44208, 1029, 206, 4, 28, "Text"],
Cell[44417, 1035, 518, 11, 29, "Input"],
Cell[44938, 1048, 210, 4, 28, "Text"],
Cell[CellGroupData[{
Cell[45173, 1056, 1130, 24, 70, "Input"],
Cell[46306, 1082, 2181, 56, 132, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[48536, 1144, 155, 2, 61, "Section"],
Cell[48694, 1148, 165, 3, 28, "Text"],
Cell[48862, 1153, 533, 11, 29, "Input"],
Cell[49398, 1166, 111, 1, 28, "Text"],
Cell[CellGroupData[{
Cell[49534, 1171, 439, 11, 50, "Input"],
Cell[49976, 1184, 1688, 48, 123, "Output"]
}, Open  ]],
Cell[51679, 1235, 255, 5, 28, "Text"],
Cell[CellGroupData[{
Cell[51959, 1244, 1094, 27, 90, "Input"],
Cell[53056, 1273, 1693, 46, 114, "Output"],
Cell[54752, 1321, 697, 17, 64, "Output"]
}, Open  ]],
Cell[55464, 1341, 206, 4, 28, "Text"],
Cell[CellGroupData[{
Cell[55695, 1349, 1207, 29, 90, "Input"],
Cell[56905, 1380, 1322, 34, 67, "Output"],
Cell[58230, 1416, 857, 20, 55, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[59136, 1442, 99, 1, 66, "Chapter"],
Cell[59238, 1445, 308, 5, 28, "Text"],
Cell[CellGroupData[{
Cell[59571, 1454, 216, 5, 29, "Input"],
Cell[59790, 1461, 3177, 92, 103, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63004, 1558, 221, 6, 29, "Input"],
Cell[63228, 1566, 3799, 100, 103, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67064, 1671, 225, 6, 29, "Input"],
Cell[67292, 1679, 5833, 152, 103, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)
)"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fvec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"Fx", ",", " ", "Fy", ",", " ", "Fz"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FdotB", " ", "=", " ", 
  RowBox[{"gF", " ", "uB", " ", 
   RowBox[{"Dot", "[", 
    RowBox[{"Fvec", ",", " ", "BrfLocal"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.6981433578216143`*^9, 3.698143479034515*^9}, {
  3.6981435779123898`*^9, 3.6981435786483383`*^9}, {3.6981476927732215`*^9, 
  3.6981477201557407`*^9}, {3.698657076290013*^9, 3.698657089534926*^9}, {
  3.6986571407819834`*^9, 3.6986571426338816`*^9}, {3.6991176397972636`*^9, 
  3.699117662319462*^9}, {3.699117739433715*^9, 3.6991177401737156`*^9}, {
  3.6991204669787445`*^9, 3.699120468606891*^9}}],

Cell[BoxData[
 RowBox[{"gF", " ", "uB", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Fz", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "Bx"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
       RowBox[{"By", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]y", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
       RowBox[{"Bz", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]z", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"Fm", "+", "Fp"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Bx", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
       RowBox[{"Bz", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]z", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "Fm"}], "+", "Fp"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Bx", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
       RowBox[{"By", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]y", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "-", 
       RowBox[{"Bz", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]z", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.698143481932017*^9, 3.6981435799247155`*^9, {3.6981438542340097`*^9, 
   3.6981438715050583`*^9}, 3.6981477451484475`*^9, {3.69865713529646*^9, 
   3.6986571431793933`*^9}, {3.699117646987262*^9, 3.6991176628394623`*^9}, 
   3.6991177474212103`*^9, 3.6991203915969114`*^9, {3.69912046949925*^9, 
   3.699120477255663*^9}, {3.699193953218419*^9, 3.6991939643803377`*^9}, 
   3.710657758341159*^9, 3.710658308694503*^9, 3.7106584025188847`*^9, 
   3.710661177972689*^9, 3.710664752938596*^9}]
}, Open  ]],

Cell[TextData[{
 "Determine the coefficients for the coherence terms (which are proportional \
to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["F", "+"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["F", "-"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " respectively), for F=1 the Clebsch Gordon coefficients are all 1/sqrt(2)"
}], "Text",
 CellChangeTimes->{{3.6981436479970865`*^9, 3.698143751270294*^9}}],

Cell[TextData[{
 "\nExpress in matrix form. Create a functional form of the raising and \
lowering operators for the Hilbert space ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "F"], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "."
}], "Text",
 CellChangeTimes->{{3.698144391048918*^9, 3.698144450597582*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ladderC", " ", "=", " ", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"F", ",", "m", ",", "pm"}], "}"}], ",", " ", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"F", 
         RowBox[{"(", 
          RowBox[{"F", "+", "1"}], ")"}]}], "-", " ", 
        RowBox[{"m", " ", 
         RowBox[{"(", 
          RowBox[{"m", " ", "+", 
           RowBox[{"pm", " ", "1"}]}], ")"}]}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FpOp", " ", "=", " ", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"F", ",", "m"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Sqrt]", "2"}], ",", "0", ",", "0"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"\[Sqrt]", "2"}], ",", "0"}], " ", "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FmOp", " ", "=", " ", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"F", ",", "m"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"\[Sqrt]", "2"}], ",", "0"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"\[Sqrt]", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], " ", "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FzOp", " ", "=", " ", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<\!\(\*SuperscriptBox[\(F\), \(+\)]\)=\>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FpOp", "[", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "]"}], "]"}], ",", " ", 
    "\"\<, \!\(\*SuperscriptBox[\(F\), \(-\)]\)=\>\"", ",", " ", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FmOp", "[", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "]"}], "]"}], ",", " ", 
    "\"\<, \!\(\*SubscriptBox[\(F\), \(z\)]\)=\>\"", " ", ",", " ", 
    RowBox[{"MatrixForm", "[", "FzOp", "]"}]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<\!\(\*SubscriptBox[\(H\), \(1\)]\)=\>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FdotB", " ", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Fp", "\[Rule]", " ", 
         RowBox[{"FpOp", "[", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "]"}]}], " ", ",", " ", 
        RowBox[{"Fm", " ", "\[Rule]", " ", 
         RowBox[{"FmOp", "[", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "]"}]}], " ", ",", " ", 
        RowBox[{"Fz", "\[Rule]", " ", "FzOp"}]}], "}"}]}], "]"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.69814464125541*^9, 3.6981446678982954`*^9}, {
   3.698144756330389*^9, 3.6981449255846677`*^9}, {3.6981449747427716`*^9, 
   3.698144989200238*^9}, {3.698145037224532*^9, 3.6981451014940715`*^9}, {
   3.6981451911529207`*^9, 3.6981451974322352`*^9}, {3.6981453113210554`*^9, 
   3.6981453828039045`*^9}, {3.698145413204487*^9, 3.698145750969122*^9}, {
   3.698145792811686*^9, 3.6981457952240243`*^9}, {3.6981458333118153`*^9, 
   3.698145836035222*^9}, {3.6981459131841755`*^9, 3.698146054485976*^9}, {
   3.6981460984630713`*^9, 3.6981461006382866`*^9}, {3.698146293398076*^9, 
   3.698146316269187*^9}, {3.698146539814201*^9, 3.6981465519785724`*^9}, {
   3.6981474267379937`*^9, 3.698147427454916*^9}, {3.698147571250761*^9, 
   3.6981475738730407`*^9}, {3.6981477137563467`*^9, 3.698147742756998*^9}, 
   3.6986571257518225`*^9, {3.699117765051417*^9, 3.699117775500968*^9}, {
   3.699117837423959*^9, 3.699117881412531*^9}, {3.699117918022357*^9, 
   3.699117956201132*^9}, {3.69911798778257*^9, 3.69911799149885*^9}, {
   3.699118027128964*^9, 3.6991181346587896`*^9}, {3.699118359267784*^9, 
   3.6991183719148054`*^9}, {3.699118403012973*^9, 3.6991184647094555`*^9}, {
   3.699194001249405*^9, 3.699194017535143*^9}, {3.699194056972752*^9, 
   3.6991940586679564`*^9}}],

Cell[BoxData[
 TemplateBox[{"\"\\!\\(\\*SuperscriptBox[\\(F\\), \\(+\\)]\\)=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{"0", "0", "0"}, {
         SqrtBox["2"], "0", "0"}, {"0", 
         SqrtBox["2"], "0"}}, RowSpacings -> 1, ColumnSpacings -> 1, 
       RowAlignments -> Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
      ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]],
   "\", \\!\\(\\*SuperscriptBox[\\(F\\), \\(-\\)]\\)=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{"0", 
         SqrtBox["2"], "0"}, {"0", "0", 
         SqrtBox["2"]}, {"0", "0", "0"}}, RowSpacings -> 1, ColumnSpacings -> 
       1, RowAlignments -> Baseline, ColumnAlignments -> Center], 
      "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]],
   "\", \\!\\(\\*SubscriptBox[\\(F\\), \\(z\\)]\\)=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{
         RowBox[{"-", "1"}], "0", "0"}, {"0", "0", "0"}, {"0", "0", "1"}}, 
       RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
       ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.6991184618700066`*^9, 3.699118465199197*^9}, 
   3.6991203916069117`*^9, 3.6991204772756653`*^9, {3.6991939563895607`*^9, 
   3.69919396439736*^9}, {3.6991940052976637`*^9, 3.6991940179191294`*^9}, 
   3.6991940592865973`*^9, 3.710657758380163*^9, 3.7106583213947725`*^9, 
   3.7106584025318856`*^9, 3.7106611779846907`*^9, 3.7106647529495964`*^9}],

Cell[BoxData[
 TemplateBox[{"\"\\!\\(\\*SubscriptBox[\\(H\\), \\(1\\)]\\)=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               RowBox[{"Bx", " ", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
               RowBox[{"By", " ", 
                 RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "-", 
               RowBox[{"Bz", " ", 
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "-", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], "0"}, {
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "-", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], "0", 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "-", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}]}, {"0", 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "-", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               RowBox[{
                 RowBox[{"-", "Bx"}], " ", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
               RowBox[{"By", " ", 
                 RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
               RowBox[{"Bz", " ", 
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}]}}, 
       RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
       ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.6991184618700066`*^9, 3.699118465199197*^9}, 
   3.6991203916069117`*^9, 3.6991204772756653`*^9, {3.6991939563895607`*^9, 
   3.69919396439736*^9}, {3.6991940052976637`*^9, 3.6991940179191294`*^9}, 
   3.6991940592865973`*^9, 3.710657758380163*^9, 3.7106583213947725`*^9, 
   3.7106584025318856`*^9, 3.7106611779846907`*^9, 3.7106647529575977`*^9}]
}, Open  ]],

Cell["\<\

At the bottom of the shell, where \[Theta] -> 0\
\>", "Text",
 CellChangeTimes->{{3.698147854596798*^9, 3.698147975435675*^9}, {
  3.6991203515266314`*^9, 3.6991203668144197`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"H1", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{"FdotB", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Fp", "\[Rule]", " ", 
        RowBox[{"FpOp", "[", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "]"}]}], " ", ",", " ", 
       RowBox[{"Fm", " ", "\[Rule]", " ", 
        RowBox[{"FmOp", "[", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "]"}]}], " ", ",", " ", 
       RowBox[{"Fz", "\[Rule]", " ", "FzOp"}]}], "}"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H0", " ", "=", " ", 
   RowBox[{"(", " ", 
    RowBox[{"\[Omega]0", " ", "FzOp"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<H0=\>\"", ",", 
    RowBox[{"MatrixForm", "[", "H0", "]"}], " ", ",", "\"\<, H1=\>\"", ",", 
    RowBox[{"MatrixForm", "[", "H1", "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.698657444467405*^9, 3.6986574763473473`*^9}, {
  3.6991194363387094`*^9, 3.6991194366457424`*^9}, {3.699120371700287*^9, 
  3.6991203833369074`*^9}, {3.699161057850796*^9, 3.6991610584806004`*^9}, {
  3.6991610902445917`*^9, 3.6991612208778057`*^9}, {3.699165837790621*^9, 
  3.69916583986069*^9}, {3.7106611671058893`*^9, 3.7106611730872006`*^9}}],

Cell[BoxData[
 TemplateBox[{"\"H0=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{
         RowBox[{"-", "\[Omega]0"}], "0", "0"}, {"0", "0", "0"}, {
        "0", "0", "\[Omega]0"}}, RowSpacings -> 1, ColumnSpacings -> 1, 
       RowAlignments -> Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
      ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]],"\", H1=\"",TagBox[
    RowBox[{"(", "\[NoBreak]", 
      GridBox[{{
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               RowBox[{"Bx", " ", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "-", 
               RowBox[{"By", " ", 
                 RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "-", 
               RowBox[{"Bz", " ", 
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "-", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], "0"}, {
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "-", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], "0", 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "-", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}]}, {"0", 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  RowBox[{"Bx", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                  RowBox[{"Bz", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
                SqrtBox["2"]], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Bx", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
                    RowBox[{"By", " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "-", 
                    RowBox[{"Bz", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
                SqrtBox["2"]]}], ")"}]}], 
         RowBox[{"gF", " ", "uB", " ", 
           RowBox[{"(", 
             RowBox[{
               RowBox[{
                 RowBox[{"-", "Bx"}], " ", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"t", " ", "\[Omega]"}], "]"}]}], "+", 
               RowBox[{"By", " ", 
                 RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]y", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "+", 
               RowBox[{"Bz", " ", 
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]z", "+", 
                    RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}]}}, 
       RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
       ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.698657446089698*^9, 3.6986574768506784`*^9}, 
   3.6986575161888065`*^9, {3.69911942769867*^9, 3.699119437215463*^9}, {
   3.699120384066904*^9, 3.6991203916289597`*^9}, 3.699120477285664*^9, 
   3.6991610989343915`*^9, 3.699161221327633*^9, {3.6991658402604628`*^9, 
   3.6991658558308764`*^9}, {3.699193959145607*^9, 3.6991939644234324`*^9}, 
   3.710657758400165*^9, 3.7106583326408973`*^9, 3.710658402554888*^9, {
   3.710661173747267*^9, 3.7106611780066924`*^9}, 3.7106647529705987`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Circular Polarised RF", "Section",
 CellChangeTimes->{{3.699161029842953*^9, 3.6991610307231665`*^9}, {
  3.71065866259889*^9, 3.7106586734189715`*^9}}],

Cell["\<\
We compare the general (and cumbersome) formula to that of circular polarised \
RF in the following limiting case:\
\>", "Text",
 CellChangeTimes->{{3.710658676416271*^9, 3.7106587144130707`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"circularPolarised", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"By", " ", "\[Rule]", " ", "B"}], ",", " ", 
     RowBox[{"Bx", " ", "\[Rule]", " ", "B"}], ",", " ", 
     RowBox[{"Bz", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]z", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]y", " ", "\[Rule]", " ", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7106587156821976`*^9, 3.7106587704976788`*^9}}],

Cell["\<\
Applying this substituion we find that, at the bottom of the shell:\
\>", "Text",
 CellChangeTimes->{{3.710658781290758*^9, 3.710658798856514*^9}, {
  3.7106588325538836`*^9, 3.7106588458832164`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bottomOfShell", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]", "\[Rule]", " ", "\[Pi]"}], ",", 
     RowBox[{"\[Phi]", "\[Rule]", " ", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1Circ", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H1", "+", "H0"}], ")"}], "/.", "circularPolarised"}], " ", "/.",
      " ", "bottomOfShell"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"TrigToExp", "[", "H1Circ", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7106588056481934`*^9, 3.710658813399968*^9}, {
  3.710658851612789*^9, 3.710658856492277*^9}, {3.710658900960724*^9, 
  3.7106589723388605`*^9}, {3.7106591409447193`*^9, 3.710659167913416*^9}, {
  3.7106592984804716`*^9, 3.71065930536316*^9}, {3.710659752994845*^9, 
  3.710659800781623*^9}, {3.7106598379413385`*^9, 3.7106599854785585`*^9}, {
  3.7106601782938375`*^9, 3.7106601818541937`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "\[Omega]0"}], 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "B", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "t", " ", "\[Omega]"}]], " ", "gF", 
        " ", "uB"}], 
       SqrtBox["2"]], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "B", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "t", " ", "\[Omega]"}]], " ", 
         "gF", " ", "uB"}], 
        SqrtBox["2"]]}], "0", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "B", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "t", " ", "\[Omega]"}]], " ", "gF", 
        " ", "uB"}], 
       SqrtBox["2"]]},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "B", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "t", " ", "\[Omega]"}]], " ", 
         "gF", " ", "uB"}], 
        SqrtBox["2"]]}], "\[Omega]0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.710658814225051*^9, {3.710658917275355*^9, 3.7106589728039074`*^9}, 
   3.710659168586484*^9, 3.710659801930738*^9, 3.7106598644689913`*^9, {
   3.710659959613426*^9, 3.710659986273638*^9}, 3.710660182509259*^9, 
   3.710661178156708*^9, 3.7106647529946012`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linear Polarised RF", "Section",
 CellChangeTimes->{{3.710659218686493*^9, 3.710659289142538*^9}, {
  3.710659989771988*^9, 3.7106600060926194`*^9}}],

Cell["\<\
Likewise, compare the results for linear polarised RF at a few key points.\
\>", "Text",
 CellChangeTimes->{{3.71066000800081*^9, 3.7106600522792377`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"linearPolarised", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"By", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"Bx", " ", "\[Rule]", " ", "B"}], ",", " ", 
     RowBox[{"Bz", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]z", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]y", " ", "\[Rule]", " ", "0"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7106600540464144`*^9, 3.710660078217831*^9}, {
  3.7106601170977187`*^9, 3.71066013141115*^9}}],

Cell["At the bottom of the shell:", "Text",
 CellChangeTimes->{{3.7106601411081195`*^9, 3.710660150331042*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"H1Lin", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H1", "+", "H0"}], ")"}], "/.", "linearPolarised"}], " ", "/.",
      "bottomOfShell"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "H1Lin", "]"}]}], "Input",
 CellChangeTimes->{{3.710660157555764*^9, 3.7106601642204304`*^9}, {
  3.710660214887497*^9, 3.710660262368244*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "\[Omega]0"}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B", " ", "gF", " ", "uB", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
        SqrtBox["2"]]}], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B", " ", "gF", " ", "uB", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
        SqrtBox["2"]]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B", " ", "gF", " ", "uB", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
        SqrtBox["2"]]}]},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B", " ", "gF", " ", "uB", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
        SqrtBox["2"]]}], "\[Omega]0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7106602458435917`*^9, 3.7106602628182898`*^9}, 
   3.7106611781827097`*^9, 3.7106647530096025`*^9}]
}, Open  ]],

Cell["\<\
Along the y-axis the interaction terms should equal the same as at the bottom \
of the shell, as the local field is perpendicular to the oscillating field in \
both.\
\>", "Text",
 CellChangeTimes->{{3.710664764699772*^9, 3.710664800138315*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"yaxisSide", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"\[Phi]", "\[Rule]", " ", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1Lin", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H1", "+", "H0"}], ")"}], "/.", "linearPolarised"}], " ", "/.",
      "yaxisSide"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "H1Lin", "]"}]}], "Input",
 CellChangeTimes->{{3.7106648070750084`*^9, 3.710664861005401*^9}, {
  3.710664913735674*^9, 3.7106649230886087`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "\[Omega]0"}], 
      FractionBox[
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
       SqrtBox["2"]], "0"},
     {
      FractionBox[
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
       SqrtBox["2"]], "0", 
      FractionBox[
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
       SqrtBox["2"]]},
     {"0", 
      FractionBox[
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
       SqrtBox["2"]], "\[Omega]0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.710664923538654*^9}]
}, Open  ]],

Cell["\<\
Along the x-axis we should see that the interaction terms vanish:\
\>", "Text",
 CellChangeTimes->{{3.7106602773347406`*^9, 3.710660322050212*^9}, {
  3.710664761264428*^9, 3.710664763936695*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sideOfShell", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]", "\[Rule]", " ", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", " ", 
     RowBox[{"\[Phi]", "\[Rule]", " ", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1Lin", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H1", "+", "H0"}], ")"}], "/.", "linearPolarised"}], " ", "/.",
      "sideOfShell"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "H1Lin", "]"}]}], "Input",
 CellChangeTimes->{{3.710660326555662*^9, 3.7106603938773937`*^9}, {
  3.71066074454712*^9, 3.7106607450201674`*^9}, {3.7106610490333357`*^9, 
  3.7106610491523476`*^9}, {3.7106611924391356`*^9, 3.7106612069275846`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "\[Omega]0"}], "+", 
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], "0", "0"},
     {"0", "0", "0"},
     {"0", "0", 
      RowBox[{"\[Omega]0", "-", 
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7106603943804445`*^9, 3.7106607114468107`*^9, 3.7106607453952045`*^9, 
   3.7106610496263947`*^9, {3.710661178194711*^9, 3.7106612075116425`*^9}, 
   3.7106647530166035`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Approximations", "Chapter",
 CellChangeTimes->{{3.710667728168255*^9, 3.710667729583397*^9}}],

Cell["\<\
Most of the time we are only interested in the potential for specific cases \
(circular, linear polarisation, points along z, etc). Which of these \
assumptions is the greatest simplification for computational speed?\
\>", "Text",
 CellChangeTimes->{{3.710667963853245*^9, 3.7106680253013887`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"H1", "+", "H0"}], ")"}], "/.", "bottomOfShell"}], "]"}]], "Input",
 CellChangeTimes->{{3.710668032043063*^9, 3.710668086969555*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "\[Omega]0"}], "+", 
       RowBox[{"Bz", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]z", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}], 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"Bx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
           SqrtBox["2"]]}], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "By", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]y", "+", 
             RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], "0"},
     {
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"Bx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
           SqrtBox["2"]]}], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "By", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]y", "+", 
             RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], "0", 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"Bx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
           SqrtBox["2"]]}], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "By", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]y", "+", 
             RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}]},
     {"0", 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"Bx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
           SqrtBox["2"]]}], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "By", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]y", "+", 
             RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], 
      RowBox[{"\[Omega]0", "-", 
       RowBox[{"Bz", " ", "gF", " ", "uB", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]z", "+", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.710668087904649*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"H1", "+", "H0"}], ")"}], "/.", "linearPolarised"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.710668102990157*^9, 3.710668113971607*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "\[Omega]0"}], "+", 
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}], 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "B", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], "0"},
     {
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "B", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], "0", 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "B", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}]},
     {"0", 
      RowBox[{"gF", " ", "uB", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"B", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "B", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"t", " ", "\[Omega]"}], "]"}]}], 
          SqrtBox["2"]]}], ")"}]}], 
      RowBox[{"\[Omega]0", "-", 
       RowBox[{"B", " ", "gF", " ", "uB", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "\[Omega]"}], "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7106681155786295`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1618, 833},
WindowMargins->{{Automatic, 137}, {Automatic, 134}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 214, 3, 101, "Title"],
Cell[797, 27, 317, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[1139, 37, 1287, 32, 92, "Input"],
Cell[2429, 71, 790, 19, 31, "Output"]
}, Open  ]],
Cell[3234, 93, 414, 7, 30, "Text"],
Cell[CellGroupData[{
Cell[3673, 104, 1424, 29, 112, "Input"],
Cell[5100, 135, 1446, 31, 57, "Output"],
Cell[6549, 168, 2747, 59, 57, "Output"]
}, Open  ]],
Cell[9311, 230, 573, 16, 33, "Text"],
Cell[CellGroupData[{
Cell[9909, 250, 1151, 29, 92, "Input"],
Cell[11063, 281, 2765, 70, 82, "Output"]
}, Open  ]],
Cell[13843, 354, 479, 14, 30, "Text"],
Cell[14325, 370, 430, 13, 49, "Text"],
Cell[CellGroupData[{
Cell[14780, 387, 4761, 115, 439, "Input"],
Cell[19544, 504, 1581, 32, 69, "Output"],
Cell[21128, 538, 9333, 196, 123, "Output"]
}, Open  ]],
Cell[30476, 737, 191, 5, 49, "Text"],
Cell[CellGroupData[{
Cell[30692, 746, 1280, 30, 72, "Input"],
Cell[31975, 778, 9794, 206, 123, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41806, 989, 158, 2, 70, "Section"],
Cell[41967, 993, 206, 4, 30, "Text"],
Cell[42176, 999, 518, 11, 31, "Input"],
Cell[42697, 1012, 210, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[42932, 1020, 1017, 23, 72, "Input"],
Cell[43952, 1045, 1956, 52, 131, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[45957, 1103, 155, 2, 70, "Section"],
Cell[46115, 1107, 165, 3, 30, "Text"],
Cell[46283, 1112, 533, 11, 31, "Input"],
Cell[46819, 1125, 111, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[46955, 1130, 439, 11, 52, "Input"],
Cell[47397, 1143, 1545, 45, 119, "Output"]
}, Open  ]],
Cell[48957, 1191, 255, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[49237, 1200, 699, 18, 72, "Input"],
Cell[49939, 1220, 1357, 40, 119, "Output"]
}, Open  ]],
Cell[51311, 1263, 206, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[51542, 1271, 803, 20, 72, "Input"],
Cell[52348, 1293, 1155, 31, 71, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[53552, 1330, 99, 1, 72, "Chapter"],
Cell[53654, 1333, 308, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[53987, 1342, 216, 5, 31, "Input"],
Cell[54206, 1349, 3098, 90, 137, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57341, 1444, 221, 6, 31, "Input"],
Cell[57565, 1452, 3608, 96, 137, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)
